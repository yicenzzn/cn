# 安全组配置

本文将详细介绍合作安全组（下文简称“安全组”）的相关配置，具体包括如下操作：

- [创建安全组](security-group-configuration#user-content-1)
- [批量绑定资源](security-group-configuration#user-content-2)
- [解绑资源](security-group-configuration#user-content-3)
- [管理安全组规则](security-group-configuration#user-content-4)
- [删除安全组](security-group-configuration#user-content-6)

### 前提条件及限制

- 确保您已经[注册京东云账号](https://user.jdcloud.com/register?returnUrl=https%3A%2F%2Fwww.jdcloud.com%2F)，并实现[实名认证](https://docs.jdcloud.com/cn/real-name-verification/introduction)；
- 已创建好一个私有网络(VPC)，且私有网络下有足够安全组配额；
- 单个私有网络下最多可以创建50个安全组，若您有更多的需求，请[提交工单](https://ticket.jdcloud.com/applyorder/submit)申请；
- 每个安全组下最多可配置50条规则，若您有更多的需求，请[提交工单](https://ticket.jdcloud.com/applyorder/submit)申请；
- 每个资源最多支持同时绑定5个安全组。

<div id="user-content-1"> </div>

### 创建安全组

步骤1：登录[京东云控制台](https://login.jdcloud.com/?returnUrl=https%3A%2F%2Fwww.jdcloud.com%2F)，选择 合作云产品 ->【合作云主机】->【合作安全组】页面；

步骤2：点击【创建】按钮，弹出创建安全组弹框；

步骤3：首先选择安全组所在的地域和私有网络，安全组只能应用在同一个合作私有网络下的合作云主机实例。您可以为当前已创建的私有网络新建安全组，也可以点击“新建私有网络“按钮，跳转到新建私有网络页面，创建新的私有网络；

步骤4：输入安全组名称，建议您用安全组的使用场景或功能作为安全组的名称，如“Web服务器集群开放80端口”。

> 注：
> 1. 新建安全组为自定义安全组，自定义安全组默认拒绝所有入口、出口流量；
> 2. 随VPC创建的安全组为默认安全组，支持三类默认安全组：
> - Linux安全组开放22端口 ：仅暴露 SSH 登录的 TCP 22端口到公网，内网端口全通；
> - Windows 安全组开放3389端口：仅暴露 MSTSC 登录的TCP 3389端口到公网，内网端口全通；
> - 默认安全组开放全部端口：暴露全部端口到公网和内网，有一定安全风险，请慎重选择。

<div id="user-content-2"> </div>
### 绑定云资源

步骤1：登录[京东云控制台](https://login.jdcloud.com/?returnUrl=https%3A%2F%2Fwww.jdcloud.com%2F)，选择 合作云产品 ->【合作云主机】，进入控制台合作云主机列表页；

步骤2：定位需要绑定安全组的合作云主机，点击主机 ID 进入主机详情页，选择安全组TAB页，点击【绑定安全组】按钮，进入绑定安全组弹窗；
步骤3：在弹窗中，选择需要绑定的安全组；

步骤4：点击【确定】按钮，完成资源绑定安全组。

> 注：更改安全组出入方向规则后，立即生效，但不影响更改规则前已建立的连接，如需在已建立的连接上生效，需手动断开已建立连接。

<div id="user-content-3"> </div>

### 解绑云资源

步骤1：登录[京东云控制台](https://login.jdcloud.com/?returnUrl=https%3A%2F%2Fwww.jdcloud.com%2F)，选择 合作云产品 ->【合作云主机】，进入控制台合作云主机列表页；

步骤2：定位需要绑定安全组的合作云主机，点击主机 ID 进入主机详情页，选择安全组TAB页；

步骤3：定位需要解绑的安全组，点击操作列下的【解绑】按钮即可将对应的云资源从当前安全组中解绑。
> 注：当云资源仅绑定一个安全组时，不支持解绑，如需解绑当前安全组，需先绑定其他安全组。

### 管理安全组规则

#### 添加出/入站规则
出站规则用于过滤云主机访问互联网或其他云主机的网络流量，入站规则用于过滤互联网或其他云主机访问该云主机的网络流量，设置方式如下：

步骤1：登录[京东云控制台](https://login.jdcloud.com/?returnUrl=https%3A%2F%2Fwww.jdcloud.com%2F)，选择  合作云产品 ->【合作云主机】->【合作安全组】，进入控制台安全组列表页；

步骤2：在安全组列表页中，定位需要添加规则的安全组，点击安全组名称进入详情页；

步骤3：定位需要添加的规则类型，选择出站规则或入站规则，进入对应规则的`TAB`页，点击【编辑规则】按钮；
 
步骤4：点击【添加新规则】按钮添加规则，根据需求添加信息，相关配置项说明如下：

|属性|说明|示例|
|:-----------|:----------|:------------|
|类型|常用的协议类型，包括自定义TCP、自定义UDP、ICMP|自定义TCP、ICMP等|
|协议|根据应用类型选择，显示所属协议类型|ssh、TCP|
|目标端口|安全组作用的云主机端口或端口范围，取值1-65535|如“22”或端口范围如“20-22”|
|源IP|入站规则独有属性，允许访问的IP地址段(CIDR)，当协议类型仅支持IPv4地址（如ICMP协议）时，请输入对应正确格式的地址|10.0.0.1/32|
|目的IP|出站规则独有属性，允许被访问的IP地址(CIDR)|10.0.0.1/32|
|策略|允许或拒绝安全组规则，新增规则默认为“允许”，暂不支持新增“拒绝”策略的安全组规则|允许|
|备注|标识规则用途等|属于A业务|
|创建时间|创建安全组规则的时间|2021-11-22

> 注：配额不得超过安全组规则的总配额。

步骤6：点击【保存】，进入二次确认弹窗，如无问题点击【确认】按钮。


#### 修改安全组规则

步骤1：登录[京东云控制台](https://login.jdcloud.com/?returnUrl=https%3A%2F%2Fwww.jdcloud.com%2F)，选择 合作云产品 -> 【合作云主机】 -> 【合作安全组】页面，进入控制台安全组列表页；

步骤2：在安全组列表页中，定位需要修改规则的安全组，点击安全组名称进入详情页；

步骤3：定位需要修改的规则类型，点击对应的tab页，点击【编辑规则】按钮；

步骤4：定位需要修改的安全组规则，修改信息；

步骤5：完成规则修改后，点击页面上方的【保存】按钮后，进入二次确认弹窗，如无问题点击【确认】按钮。

> 注：
> 1. 更改安全组规则不影响已建立的连接，如删除的规则需要对已建立的连接生效，删除规则后，需手动断开连接，再次连接时安全组规则将会生效
> 2. 安全组是有状态的，如您配置了相应的规则，允许出方向规则，则无论入口安全组规则如何，都将允许该请求的响应流量流出。



### 删除安全组

步骤1：登录[京东云控制台](https://login.jdcloud.com/?returnUrl=https%3A%2F%2Fwww.jdcloud.com%2F)，选择 合作云产品 -> 【合作云主机】 -> 【合作安全组】 ，进入安全组列表页；

步骤2：定位需要删除的安全组，在操作列点击【更多】，选择【删除】，弹窗确认；

步骤3：点击【确认】按钮，完成删除安全组操作。

>  注：当安全组为绑定任一云资源时，支持删除安全组。


## 相关参考

- [安全组概述](../Introduction/Features/Security-Group-Features.md)
- [应用场景](../Introduction/Application-Scenarios/Basic-Business-Into-Cloud.md)
- [使用限制](../Introduction/Restrictions.md)
- [常见问题](../FAQ/FAQ.md)
