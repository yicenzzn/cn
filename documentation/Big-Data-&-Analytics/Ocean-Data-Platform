# 产品简介

## 产品概述

数据开发与管理平台开发套件主要提供数据规划、设计、开发、测试、部署、运维一体化的数据开发平台，面向离线、实时数据场景，为企业数据内容体系建设提供必备的基础工具体系，以开放的方式实现企业内部数据共享，充分发挥数据价值；其次，资产管理套件则可辅助企业科学规划和合理构建全域数据资产，提升数据资产管理水平，更高效的实现数据的资产化和数据业务化；最后，安全套件，面向企业级用户提供数据安全生命周期全过程的防护能力。

## 核心概念

了解深海数据平台时，通常会涉及到以下核心概念：

| <div style="width: 50pt">序号</div> | <div style="width: 80pt">概念</div> | 说明                                                         |
| ----------------------------------- | ----------------------------------- | ------------------------------------------------------------ |
| 1                                   | 项目空间                            | 项目空间是一组资源、成员的集合，同一组织下，对于不同的业务建议分别创建不同的项目。例如对于地产和金融两个业务，可分别新建estate、finance两个项目 |
| 2                                   | 项目成员角色                        | 项目管理员、项目成员、非项目成员                             |
| 3                                   | 集群                                | 集群是一组相互独立的、通过高速网络互联的计算机，它们构成了一个组，并以单一系统的模式加以管理。一般根据其具体提供的服务对集群进行命名，如Hadoop集群，Flink集群等。 |
| 4                                   | Yarn队列                            | Apache  Hadoop YARN （Yet Another Resource Negotiator，另一种资源协调者）是一种新的 Hadoop  资源管理器，它是一个通用资源管理系统，可为上层应用提供统一的资源管理和调度 |
| 5                                   | 缓冲层                              | 源业务系统的数据增量或快照，保持细节数据，按日存储为主主要用于数据库、日志、消息等基础数据的引入 |
| 6                                   | 贴源层                              | 用于合并、存储生产系统历史至今数据，按照业务归属组织数据，并进行脱敏及脏数据清洗处理 |
| 7                                   | 明细层                              | 按照业务过程整合明细数据，在保持原子粒度的基础上，完成名称及维度标准化、数据预关联，并以逆范式宽表落地 |
| 8                                   | 汇总层                              | 基于应用集市沉淀的通用类属性、指标而创建面向支持应用系统、数据分析与数据挖掘的公共数据层 |
| 9                                   | 维度层                              | 存放公共维度，个性维度由集市自行建设和维护                   |
| 10                                  | 临时层                              | 用于数据开发时，中间临时开发的临时表                         |
| 11                                  | 应用层                              | 面向特定部门或者用户需求，基于仓内指标汇总数据、整合明细数据等数据进行汇总、连接等整合加工，快速响应应用层需求 |
| 12                                  | 其它                                | 用于存放存量创建的系统默认层级及用户自定义的层级             |
| 13                                  | 任务                                | 任务也称为任务                                               |
| 14                                  | 实例                                | 任务每运行一次生成一个实例                                   |
| 15                                  | 命名空间                            | 一种抽象的组织机制，不同命名空间下的集群从逻辑上彼此隔离。在Hadoop中，每个命名空间保存了其下的目录树及每个目录/文件节点的属性。 |
| 16                                  | 数据库                              | 数据库是“按照数据结构来组织、存储和管理数据的仓库”。是一个长期存储在计算机内的、有组织的、可共享的、统一管理的大量数据的集合。 |
| 17                                  | 数据表                              | 是一个临时保存数据的网格虚拟表(表示内存中数据的一个表)。     |
| 18                                  | 数据元标准                          | 指保障数据的内外部使用和交换的一致性和准确性的规范性约束     |
| 19                                  | 标准词根                            | 行业术语或者专有名词，用于表和字段等标准化命名。             |
| 20                                  | 数据元属性                          | 定义为用一组属性描述定义、标识、表示和允许值的数据单元       |
| 21                                  | Web水印                             | 一种在Web页面最上层浮现的水印，可有效应对截图拍照等数据泄漏方式。 |
| 22                                  | 文本水印                            | 一种将标识信息潜入文本内容中的水印，在数据泄漏后，可实现数据溯源。 |
| 23                                  | 明水印                              | 一种水印的常见展示方式，将标识信息显性的展示在载体中，使用户可肉眼查看标识信息。 |
| 24                                  | 暗水印                              | 一种水印的常见展现方式，将标识信息隐藏在展示的载体中，肉眼无法识别，需要进行处理提取信息。 |
| 25                                  | 有效性                              | 有效性，描述数据遵循预定的语法规则的程度，是否符合其定义，比如数据的类型、格式、取值范围等 |
| 26                                  | 波动性                              | 波动性描述的是一段时间内的相对波动幅度                       |
| 27                                  | 唯一性                              | 数据表中数据重复情况                                         |
| 28                                  | 完整性                              | 完整性是指数据信息是否存在缺失的情况                         |
| 29                                  | 抽取-全量                           | 将源表的全量数据抽取作为当天分区的数据                       |
| 30                                  | 抽取-增量                           | 根据增量逻辑将源表的增量数据抽取作业当天分区的数据           |
| 31                                  | 存储-全量                           | 每天的数据都是全部最新数据，只存储一份数据，表中数据是截止到前一天的全部数据，全量表无分区 |
| 32                                  | 存储-增量                           | 每天一个分区，存放那一天产生的增量数据，即只存放增量数据     |
| 33                                  | 存储-快照                           | 按天分区，每天一个分区，每一天的数据都是截止到这一分区的全量数据 |
| 34                                  | 存储-拉链                           | 记录数据从开始到当前有状态变化的信息，只有一个分区，存储的是当前时间之前的所有历史记录的最后变化量（总量） |
| 35                                  | IDE                                 | 集成开发环境（IDE，Integrated  Development Environment ）是用于提供程序开发环境的应用程序，一般包括代码编辑器、编译器、调试器和图形用户界面等工具 |
| 36                                  | Docker容器                          | 可理解为虚拟linux系统环境，运行和隔离应用。镜像可以在容器里安装，构成一个虚拟的开发环境 |
| 37                                  | 镜像                                | 可理解为虚拟机的镜像，可以理解成ISO等压缩安装文件，可以在虚拟环境上安装你所需要的程序 |
| 38                                  | MR                                  | 即MapReduce，一种开源并行计算框架                            |
| 39                                  | Presto                              | 完全基于内存并行计算，分布式SQL交互查询引擎，查询速度比Hive快5-10倍 |
| 40                                  | Tez                                 | Tez是Apache构建在Hadoop之上的支持分布式DAG（Directed  Acyclic Graph）的计算框架，支持通过复杂的DAG描述并处理大数据任务 |
| 41                                  | 链路追溯                            | 展示表所关联任务的链路，方便用户快速了解表与任务的关联关系。 |
| 42                                  | 血缘关系                            | 展示表与表之间的关系、表间字段与字段的关系。                 |
| 43                                  | 数据流向                            | 展示表间的数据流转以及数据流转的方向，数据流向在本产品中表示通过数据集成入仓动作业务系统表采集到数仓的数据表关系以及数据流转方向。 |
| 44                                  | 维度                                | 维度是用于观察和分析业务数据的视角，支撑对数据汇聚、钻取、切片分析，用于SQL中的GROUP  BY条件，例如时间维度、地区维度、产品维度等。创建维度，即从顶层规范业务中实体（或称主数据）的存在性及唯一性 |
| 45                                  | 维度类型                            | -  普通维度：不具有枚举和层级的维度 - 枚举维度：基于码表创建的维度，字段信息、数据与码表保持一致，具备可枚举属性的维度，例如性别存在男，女 - 层级维度：具有层级结构的维度，例如地区-省-市 |
| 46                                  | 事实表                              | 归属于某个业务过程的事实逻辑表，可以丰富具体业务过程所对应事务的详细信息。例如下订单这一业务过程中，您可以创建下订单这一明细表，用于记录下单过程可能产生实际数据字段，例如订单ID、订单创建时间、商品ID、数量、金额等。后续您可将这些明细表部署到数仓中，通过ETL将真实的数据按照明细表的定义方式进行汇总存储，便于业务分析时取用 |

## 基础架构



## 产品优势

1、一站式服务：支持一站式的数据集成、设计、开发、管理、运维和服务

2、血缘关系：支持字段级血缘，支持数据全链路追踪分析

3、数据治理：支持自驱、专项多种手段高效进行企业存储与计算资源优化

4、自主研发：全产品自主研发，具备自主知识产权

5、专业交付：高质量售后服务能力，支持深度定制服务

6、国产适配：覆盖主流芯片、服务器操作系统、数据库、中间件

7、场景验证：历经京东内部真实海量数据及业务场景验证，提供高吞吐、高性能的产品及数据服务

## 产品功能

| <div style="width: 80pt">产品核心功能</div> | <div style="width: 80pt">功能描述</div>                      |
| ------------------------------------------- | ------------------------------------------------------------ |
| 一站式平台能力                              | 涵盖8大功能模块，与数据集成、数据开发等联动，可以一站式地完成大数据的开发和治理工作 |
| 数据规划                                    | 提供企业数据体系的顶层规划能力，覆盖项目管理、数据仓库规划、主题域定义、业务域定义等 |
| 数据集成                                    | 基于低代码的可视化数据集成平台，支持数据入仓(湖）、数据出仓（湖）及异构数据源间的数据同步，在各类复杂网络环境下完成离线、实时数据同步工作，并支持一键入仓、敏感数据处理等多种能力 |
| 数据标准                                    | 通过元标准定义、标准库、标准管理等功能，帮助企业快速实现数据标准规范的制定与发布，为数据质量稽核、规范建模、资产治理提供标准依据 |
| 规范建模                                    | 覆盖数据模型设计、研发、测试、部署及运营的一站式能力，打通数据标准实现前置数据治理，完成标准、规范的数据模型及统一指标构建 |
| 数据开发                                    | 涵盖大数据开发全栈，提供离线与实时数据的开发能力，支持交互式查询、多人协同开发、在线脚本等功能，并通过分布式调度引擎，为用户提供高效、稳定的调度与运维服务。 |
| 运维中心                                    | 面向线上各类生产任务，集群环境提供统一的监控、运维及管理能力，保障SLA服务时效达成 |
| 数据质量                                    | 提供图形化操作界面进行规则配置，全程零编码操作，从质量规则定义、质量监控、告警，问题工单管理，形成数据质量全闭环管控。 |
| 数据图谱                                    | 基于元数据构建的企业数据知识共享平台，通过对全域数据知识的多维度集成与整合，为用户提供可视化的血缘追溯及数据百科功能，彻底解决企业找数据难、理解数据难及共享数据难的问题 |

## 地域及可用区

京东云云主机机房分布在全球多个位置，这些位置称为地域。每个地域（region）都是一个独立的地理区域，每个地域都是完全独立的。

京东云支持您在不同地域部署云业务，同时为了避免单地域部署可能带来的单点风险，建议在部署方案设计阶段考虑多地域多可用区部署。实例创建后，不支持更换地域或更换可用区。

可用区（Availability Zone）是电力及网络之间互相独立的物理区域，相同可用区内的实例之间较之同地域不同可用区内实例之间的网络延时更小。同地域内不同可用区之间提供内网互通环境，可用区之间可做到故障隔离。

- 若您的业务要求有较高容灾能力，建议将实例部署在同一地域不同可用区内；
- 若您的业务要求有较低网络时延，建议将实例部署在同一可用区内。
- 实际可使用可用区请以控制台显示为准。

| 地域名称及编码       | 可用区名称及编码     | 所在城市            |      |
| :------------------- | :------------------- | :------------------ | ---- |
| 中国大陆地域         | 华北-北京 cn-north-1 | 可用区A cn-north-1a | 北京 |
| 可用区B cn-north-1b  | 北京                 |                     |      |
| 可用区C cn-north-1c  | 北京                 |                     |      |
| 华东-宿迁 cn-east-1  | 可用区A cn-east-1a   | 宿迁                |      |
| 华东-上海 cn-east-2  | 可用区A cn-east-2a   | 上海                |      |
| 可用区B cn-east-2b   | 上海                 |                     |      |
| 可用区C cn-east-2c   | 上海                 |                     |      |
| 华南-广州 cn-south-1 | 可用区A cn-south-1a  | 广州                |      |
| 可用区B cn-south-1b  | 广州                 |                     |      |
| 可用区C cn-south-1c  | 广州                 |                     |      |

## 使用限制

### 账号限制

- 您创建深海数据平台所使用京东云账号需进行实名认证，详细内容请参见[实名认证](https://docs.jdcloud.com/cn/real-name-verification/introduction)。
- 创建包年包月计费实例需预付产品费用。
- 独享资源需按配置计费，需要您的账户余额及可用代金券之和不低于消费门槛。

## 应用场景

![image-20230314142750760](/Users/wangyuxian10/Library/Application Support/typora-user-images/image-20230314142750760.png)

![image-20230314142821661](/Users/wangyuxian10/Library/Application Support/typora-user-images/image-20230314142821661.png)

# 产品定价

## 计费概述

您可以在下单界面查看提供的产品费用，服务搭建的资源费用按照您实际使用进行扣费，您可以通过查看所需资源列表，通过京东云提供的云主机、数据库价格计算器进行计算，也可以通过价格总览查阅用以估算投入成本。

请注意：价格总览中价格为统一官方标价，不包用户括折扣优惠，为了保证价格准确性，建议您登录后使用价格计算器或登录控制台创建页面查看配置价格。

## 计费规则

目前是深海数据平台产品支持包年包月计费，其背后使用的资源按照配置进行计费

### 包年包月计费

包年包月计费是指按指定时长方式购买资源，按您购买资源的配置及时长收费，采用先付费后使用的方式；

包年包月：一次性支付一个月、多个月或多年的资源费用，在购买的时长期间内，您可以一直使用该资源，且不需再支付费用，除非您需要对配置进行变更或到期后续费；

示例：

您在2018-8-2 10:00:00购买6个月的云资源，月单价为56元，则您需要支付的费用为336=6*56元，您可以使用该资源至2019-2-2 23:59:59；

适用场景：

当您具有较稳定的业务场景、且需要长期使用云资源时，推荐按包年包月方式购买资源，该模式可以极大的节约您的成本

### 按配置计费

按配置计费：按资源的配置及使用时长计费，时长精确到秒（按秒计费），按小时出账扣款。

示例： 您在2018-8-2 10:30:00购买了按小时计费的云主机，使用到2018-8-3 8:25:20删除，每小时单价为1元；

1、2018-8-2 10:00:00——11:00:00， 该时间段，您的使用时长为 10:30:00-11:00：00，即1800秒，则收取的费用=（1800秒/3600秒）*1元=0.5元

2、2018-8-2 11:00:00——2018-8-3 8:00:00，该时间段，每个小时的使用时长都为1小时，每小时的费用=1元；

3、2018-8-3 8:00:00——2018-8-3 8:25:23，该时间段，您的使用时长为8:00:00——8:25:20，即1520秒，则收取的费用=（1520/3600）*1元=0.42元；

## 价格总览

### 产品价格

| <div style="width: 80pt">版本</div> | 产品范围                                                     | 产品包月价格（元） | 产品包年价格（元） |
| ----------------------------------- | ------------------------------------------------------------ | ------------------ | ------------------ |
| 专业版                              | 用户中心 权限中心 流程中心 数据规划 数据集成 规范建模 数据开发 运维中心 数据标准 数据图谱 数据质量 资源管理 | ¥30,000.00         | ¥300,000.00        |

### 资源价格

| 版本 | 资源类型           | 资源规格                                            | 机器台数 | 资源报价（/小时/台） |
| ---- | ------------------ | --------------------------------------------------- | -------- | -------------------- |
| 低配 | 主机               | CPU:4核 ｜内存：8GB \| 硬盘：300G ｜数据盘： 0      | 14       | ¥0.76                |
|      |                    | CPU:4核 ｜内存：16GB \| 硬盘：500G ｜数据盘： 1000G | 2        | ¥1.81                |
|      |                    | CPU:8核 ｜内存：32GB \| 硬盘：500G ｜数据盘： 5000G | 3        | ¥5.19                |
|      |                    | CPU:16核 ｜内存：32GB \| 硬盘：500G ｜数据盘： 0    | 4        | ¥2.65                |
|      | Mysql 5.7          | 主备｜本地盘｜ CPU:4核 ｜内存：16GB｜400GB          | 1        | ¥4.08                |
|      | redis 集群模式 5.0 | 内存：16GB                                          | 1        | ¥3.00                |
|      | kafka（2.4）       | CPU:4核 ｜内存：16GB \| 硬盘：500G                  | 1        | ¥6.06                |
|      | ES 通用型6.8.13    | CPU:4核 ｜内存：16GB \| 硬盘：500G                  | 1        | ¥8.04                |



| 版本 | 资源类型           | 资源规格                                              | 机器台数 | 资源报价（/小时/台） |
| ---- | ------------------ | ----------------------------------------------------- | -------- | -------------------- |
| 中配 | 主机               | CPU:4核 ｜内存：8GB \| 硬盘：300G ｜数据盘： 0        | 28       | ¥0.76                |
|      |                    | CPU:16核 ｜内存：32GB \| 硬盘：500G ｜数据盘： 0      | 8        | ¥2.65                |
|      |                    | CPU:16核 ｜内存：64GB \| 硬盘：500G ｜数据盘： 1000G  | 2        | ¥4.45                |
|      |                    | CPU:16核 ｜内存：64GB \| 硬盘：500G ｜数据盘： 10000G | 3        | ¥10.08               |
|      | Mysql 5.7          | 主备｜本地盘｜ CPU:8核 ｜内存：32GB｜硬盘：600GB      | 1        | ¥2.13                |
|      | redis 集群模式 5.0 | 内存：32GB                                            | 1        | ¥6.00                |
|      | kafka（2.4）       | CPU:8核 ｜内存：32GB \| 硬盘：1000G                   | 1        | ¥12.09               |
|      | ES 通用型6.8.13    | CPU:8核 ｜内存：32GB \| 硬盘：1000G                   | 1        | ¥16.08               |



| 版本 | 资源类型           | 资源规格                                               | 机器台数 | 资源报价（/小时/台） |
| ---- | ------------------ | ------------------------------------------------------ | -------- | -------------------- |
| 高配 | 主机               | CPU:4核 ｜内存：16GB \| 硬盘：300G ｜数据盘： 0        | 28       | ¥1.06                |
|      |                    | CPU:16核 ｜内存：32GB \| 硬盘：500G ｜数据盘： 0       | 9        | ¥2.65                |
|      |                    | CPU:16核 ｜内存：64GB \| 硬盘：500G ｜数据盘： 1000G   | 2        | ¥4.45                |
|      |                    | CPU:32核 ｜内存：128GB \| 硬盘：500G ｜数据盘： 20000G | 3        | ¥19.85               |
|      | Mysql 5.7          | 主备｜本地盘｜ CPU:8核 ｜内存：32GB｜硬盘：600GB       | 1        | ¥2.13                |
|      | redis 集群模式 5.0 | 内存：32GB                                             | 1        | ¥6.00                |
|      | kafka（2.4）       | CPU:8核 ｜内存：32GB \| 硬盘：1000G                    | 1        | ¥12.09               |
|      | ES 通用型6.8.13    | CPU:8核 ｜内存：32GB \| 硬盘：1000G                    | 1        | ¥16.08               |

## 购买流程

### 账户准备

在开通深海数据平台之前，您需要先完成京东云账号的注册、实名认证并为购买资源做好支付准备。

### 账号注册

若您已有京东云账号，可跳过本步骤进行后续设置。 若您还未注册京东云账号，可在京东云官网进行注册，请参考[注册京东云](https://user.jdcloud.com/register)。

### 账号认证

实名认证是在深海数据平台购买并使用资源的前提，您可选择对账号进行个人实名认证或企业实名认证，详见[实名认证](https://docs.jdcloud.com/cn/real-name-verification/introduction)。

### 支付准备

因为深海数据平台采用按配置计费，由于采用后付费模式，为避免计费周期内账户余额不足导致资源扣款失败，进而影响服务正常使用，为保证您的正常使用，您的账户余额及可用代金券之和不低于消费门槛。

## 续费流程

针对不同计费类型实例，续费操作实现功能不同：

- 包年包月计费续费：延长包年包月产品的使用时长。续费时间段为1个月~9个月、1年、2年、3年。如您在产品到期前操作续费，则新订单的开始时间为原订单的到期时间；如您在产品到期后续费，则新订单的开始时间为续费当天。



# 入门指南

## 了解权限与流程

进入平台时，需要了解各个模块权限，目前一站式数据开发与管理平台存在以下角色：BDP系统管理员，BDP资产管理员，BDP数据开发人员，BDP运维人员，BDP数据架构师

| <div style="width: 25pt">角色类型</div> | <div style="width: 25pt">角色名称</div> | 角色描述                                                     |
| --------------------------------------- | --------------------------------------- | ------------------------------------------------------------ |
| 系统角色                                | BDP平台管理员                           | 管理一站式数据开发与管理平台所有菜单、负责产品的日常运营和运维，拥有数据开发与管理平台最高权限 |
| 系统角色                                | BDP数据架构师                           | 进行数仓规划，设定数仓、集市、主题域和主题等数据架构管理     |
| 系统角色                                | BDP开发人员                             | 负责企业数据开发，拥有基础开发人员的权限                     |
| 系统角色                                | BDP运维人员                             | 负责作业任务的运维管理                                       |
| 系统角色                                | BDP资产管理员                           | 负责数据资产的管理，包括数据标准、数据质量等相关管理工作     |
| 工作流角色                              | 数仓审批人员                            | 库表权限申请审批人                                           |

## 构建数仓/集市/主题域/业务线

​       该分层信息为系统默认提供的数仓设计方案；用户可以直接使用该方案，也可以根据自己的数仓方案做调整；其中各分层信息要求如下：

| <div style="width: 100pt">英文名</div> | <div style="width: 100pt">中文名</div> | <div style="width: 100pt">分层归属</div> | 描述                                                         |
| -------------------------------------- | -------------------------------------- | ---------------------------------------- | ------------------------------------------------------------ |
| stg                                    | 缓冲层                                 | 缓冲层                                   | 业务贴源层信息                                               |
| odm                                    | 贴源层                                 | 贴源层                                   | 用于合并、存储生产系统历史至今数据，按照业务归属组织数据，并进行脱敏及脏数据清洗处理 |
| idm                                    | 明细层                                 | 明细层                                   | 按照业务过程整合明细数据，在保持原子粒度的基础上，完成名称及维度标准化、数据预关联，并以逆范式宽表落地 |
| dim                                    | 维度层                                 | 维度层                                   | 存放公共维度，个性维度由集市自行建设和维护                   |
| sdm                                    | 汇总层                                 | 汇总层                                   | 基于应用集市沉淀的通用类属性、指标而创建面向支持应用系统、数据分析与数据挖掘的公共数据层 |
| tmp                                    | 临时层                                 | 临时层                                   | 用于临时建表存储                                             |
| dev                                    | 开发层                                 | 其它                                     | 用于运营开发建表                                             |

 同时，可以根据数据业务调研结构，创建对应的集市分层

## 定义数据标准及分类分级

在启动数据开发与管理工作前，需要提前规划数据标准及分类分级，通过数据标准规范数据命名，数据类型，是否为空，来保证后续建模与应用过程中数据处理的一致性，从源头上保障数据的标准化生产，节约后续数据应用和处理的成本。

:::tip 应用模块: 

管理平台-数据标准 具体操作可参考数据标准模块

安全中心-分类分级 具体操作可参考分类分级模块

:::

## 构建项目空间

系统管理员可通过“数据规划-项目空间”根据企业自身需求划分项目空间使用详情，同时可以切换管理平台-资源管理，建立队列，为该项目空间单独赋权该独享队列。具体操作可参考项目空间、资源管理模块

## 准备数据源

为方便演示，本示例需准备MySQL数据源,用于模拟外部系统数据源接入数仓的实际业务场景

| <div style="width: 60pt">参数名  </div> | 样例            |
| --------------------------------------- | --------------- |
| 数据源名称                              | 出行集市业务库  |
| 业务归属                                | 选择交通/出租车 |
| 域名                                    | 10.xxx.xx.xx    |
| 端口号                                  | 3306            |
| 库名                                    | XX              |
| 用户名                                  | XX              |
| 密码                                    | XX              |
| 版本                                    | XX              |

## 数据集成

外部数据源配置完成后，需数据开发人员确认接入该数据源下哪张表，方便接入数仓后进行后续数据处理工作，具体包括基本配置和字段配置工作，可参考**数据集成-数据入仓**操作。

## 规范建模

在数据接入数仓后，数仓人员根据接入表进行二次开发形成公共模型，方便其他数据分析师引用使用。规范建模支持数仓人员关联数仓规划、关联企业数据标准、分类分级，通过使用规范建模，您可以将建模设计产出的维度表、事实表物化到计算引擎中并进一步应用。

## 数据开发

在数据开发模块，用户可以进行脚本开发，发布作业等操作，轻松完成整个数据的处理分析流程。您可以在此建立SQL/SHELL/PYTHON脚本，进行数据查询与加工操作，具体操作参考数据开发模块。

## 运维中心

在进行数据处理之后，您可以通过运维调度查看任务及任务实例的运行状态，运行成功后，您可以在管理平台-数据图谱查看该任务目标表的数据预览。具体操作参考运维中心模块。

## 数据质量

数据质量模块是对数据库里的数据质量进行质量管理的工具，您可以从唯一性、有效性、及时性、一致性进行数据质量稽核。同时生成对应质量规则后，可以对业务指标进行质量监控，识别对应数据问题，方便数据开发人员进行后续处理。具体操作参考数据质量模块。

## 数据图谱

当您需要查找某个数据资产,可以在数据普通查看相关数据资产的业务信息及技术信息，进一步对数据资产展开一个全面了解。

对于资产管理员而言，为了对数据入仓的原始数据进行管理和监控，可以在运营后台-数据图谱-元数据采集模块进行元数据采集并监控。主要涉及采集任务的基本信息和采集信息，

当采集任务成功后，可点击“管理平台-数据图谱”，单击所需要的元数据名称，即可查看详情信息。具体操作请参考数据图谱模块

# 操作指南

## 项目空间

### 产品概述

企业内存在多组织、多团队，资源分配不均，团队内部希望实现自我管控，数据隔离，并按角色进行任务划分，企业层面可以统一管控各团队，团队之间可进行数据共享。**项目空间**是一组资源、成员的集合，同一组织下，对于不同的业务建议分别创建不同的项目。例如对于地产和金融两个业务，可分别新建estate、finance两个项目。项目空间作为成员管理、角色和资源分配的基本单元，每个团队都可具有独立的项目空间。项目空间从系统层面为管理者提供对使用BDP的成员、资源配置的管理能力。

### 应用场景

项目空间主要应用于多业务进行数据协同开发，方便企业可以根据组织、业务等维度创建对应项目空间，并且授权对应集群资源，实现成员、资源、角色的基本单元。

### 术语定义

| <div style="width: 25pt">序号</div> | <div style="width: 80pt">**术语**</div> | **全称和说明**                                               |
| ----------------------------------- | --------------------------------------- | ------------------------------------------------------------ |
| 1                                   | 项目空间                                | 项目空间是一组资源、成员的集合，同一组织下，对于不同的业务建议分别创建不同的项目。例如对于地产和金融两个业务，可分别新建estate、finance两个项目 |
| 2                                   | 项目成员角色                            | 项目管理员、项目成员、非项目成员                             |
| 3                                   | 集群                                    | 集群是一组相互独立的、通过高速网络互联的计算机，它们构成了一个组，并以单一系统的模式加以管理。 |
| 4                                   | Yarn队列                                | Apache Hadoop  YARN （Yet Another  Resource Negotiator，另一种资源协调者）是一种新的 Hadoop 资源管理器，它是一个通用资源管理系统，可为上层应用提供统一的资源管理和调度 |

### 功能列表

| <div style="width: 25pt">序号</div> | <div style="width: 120pt">**子功能需求**</div> | **说明**                                                     |
| ----------------------------------- | :--------------------------------------------- | ------------------------------------------------------------ |
| 1                                   | 创建项目空间                                   | 系统管理员可以创建项目空间                                   |
| 2                                   | 配置项目空间                                   | 项目管理员可以配置项目空间资源（集群、队列、数据库）  当项目空间已启用时，已配置的集群、数据库不支持移除。 |
| 3                                   | 空间成员管理                                   | 项目管理员可以进行成员添加                                   |
| 4                                   | 申请加入项目空间                               | 非项目成员可以申请加入项目空间                               |
| 5                                   | 资源队列授权项目空间                           | 为特定业务展开的特殊队列可通过运营后台赋权给项目空间；由项目管理员进行特殊队列配置，用于后续数据开发的独享资源。 |

### 权限列表

| 功能点           | BDP平台管理员 | 项目管理员 | 项目成员 | 非项目成员 |
| ---------------- | ------------- | ---------- | -------- | ---------- |
| 创建项目         | ✔️             |            |          |            |
| 查看项目基本属性 | ✔️             | ✔️          | ✔️        |            |
| 新增项目成员     | ✔️             | ✔️          |          |            |
| 编辑项目成员角色 | ✔️             | ✔️          |          |            |
| 查看项目成员列表 | ✔️             | ✔️          | ✔️        |            |
| 移除项目成员     | ✔️             | ✔️          |          |            |
| 搜索项目成员     | ✔️             | ✔️          |          |            |
| 修改计算引擎配置 | ✔️             | ✔️          |          |            |
| 查看计算引擎配置 | ✔️             | ✔️          | ✔️        |            |
| 修改项目基本属性 | ✔️             | ✔️          |          |            |
| 授权队列资源     | ✔️             |            |          |            |
| 申请加入项目     |               |            |          | ✔️          |

### 准备工作

登录大数据平台门户首页，选择一站式数据开发与管理平台，单击“数据规划-项目空间”

:::tip 约束限制

1. 系统管理员具有创建项目空间的权限并可以添加成员授权为项目管理员，项目成员
2. 项目空间创建成功后，暂不支持删除空间的操作。
3. 只有当其被添加为项目空间成员后，才可以访问该项目空间。
4. 系统管理员拥有资源队列分配权限，特殊资源需求可通过系统管理员进行独享队列授权。

:::

### 用户指南

#### 创建项目空间

1. 单击一站式数据开发与管理平台-数据规划-项目空间，进入项目空间页面。

2. 单击“创建项目空间”，在空间信息页面根据页面提示配置参数，参数说明如表1所示，配置完成后，单击“确定”完成工作空间的创建。

   表1 参数说明

   | <div style="width: 50pt">参数名</div> | **说明**                                                     |
   | ------------------------------------- | ------------------------------------------------------------ |
   | 空间名称                              | 空间名称唯一                                                 |
   | 空间描述                              | 空间的描述信息                                               |
   | 空间模式                              | 目前仅支持简单模式（开发生产一体的环境）                     |
   | 空间作用                              | 选择数据仓库使用，数据库仅可以选择数据仓库页面建立数据库，选择非数据库使用，数据库仅可以选择数据集市页面建立数据库。主要作用为根据仓库和集市的划分有效形成对应项目空间管理，数据仓库一般为数据仓库团队使用，数据集市一般为业务团队使用。 |
   | 集群类型                              | 目前仅支持Hadoop类型                                         |
   | 集群                                  | 显示默认集群                                                 |
   | Yarn队列                              | 当前集群下的队列名称，无特殊需求，默认显示Default            |
   | 数据库                                | 可以选择该项目空间绑定数据库                                 |

### 编辑项目空间

1. 登录一站式数据开发与管理平台，单击数据规划-项目空间
2. 找到自己负责的项目空间，单击配置，进入空间配置页面
3. 单击编辑按钮，您就可以可以编辑空间信息以及管理空间成员，请根据页面提示进行配置
4. 配置完成后，单击保存按钮以成功保存配置

### 申请加入项目空间

1. 登录一站式数据开发与管理平台，单击数据规划-项目空间

2. 找到未加入的项目空间，单击申请加入，进入申请加入空间页面

3. 选择项目管理员、项目成员任一角色，单击确定，前往流程中心可查看申请加入流程，审批通过即可加入项目空间，若驳回，则拒绝加入该项目空间

### 管理项目空间

添加成员和角色

1. 登录一站式数据开发与管理平台，单击数据规划-项目空间
2. 单击相应项目空间卡片后的“配置”，进入空间配置，单击“成员管理”，进入成员空间页面
3. 单击成员管理下的“添加成员”，在弹出的“添加成员”抽屉中选择用户，并设置角色
4. 单击“保存”即可添加成功。

移除空间成员

1. 登录一站式数据开发与管理平台，单击数据规划-项目空间
2. 单击相应项目空间卡片后的怕“配置”，进入空间配置点，单击“成员管理”，进入成员空间页面
3. 在成员列表中勾选所需移除成员，单击“移除”
4. 在“移除”对话框中，如果确认要移除成员，单击“确定”后完成移除

资源队列分配

1. 系统管理员登录一站式数据开发与管理平台，单击**开发平台-运营后台-项目空间-资源队列分配**

2. 选择所需授权队列，单击“授权项目”，选择授权项目，并赋予队列标签，填写授权原因，完成独享资源的分配

## 数据规划

### 产品概述

在进行数据规范建模时，数仓架构师或者模型小组成员可以在数仓规划页面对数据分层、数据集市、业务线和主题域进行设计完成设计后，模型设计师在建模过程中可以依赖数仓规划中的数据分层、业务线、主题域、业务线等对所建模型进行分层化域管理

### 术语定义

**数据分层**：数仓架构师结合业务场景、数据场景综合考虑设计数仓的数据分层

常见分层有如下表所示，您可以根据业务需求创建数据分层，操作参考创建数据分层

| **<div style="width: 25pt">序号</div>** | **<div style="width: 80pt">术语/缩略语</div>** | **功能定位**                                                 |
| --------------------------------------- | ---------------------------------------------- | ------------------------------------------------------------ |
| 1                                       | 缓冲层                                         | 源业务系统的数据增量或快照，保持细节数据，按日存储为主主要用于数据库、日志、消息等基础数据的引入 |
| 2                                       | 贴源层                                         | 用于合并、存储生产系统历史至今数据，按照业务归属组织数据，并进行脱敏及脏数据清洗处理 |
| 3                                       | 明细层                                         | 按照业务过程整合明细数据，在保持原子粒度的基础上，完成名称及维度标准化、数据预关联，并以逆范式宽表落地 |
| 4                                       | 汇总层                                         | 基于应用集市沉淀的通用类属性、指标而创建面向支持应用系统、数据分析与数据挖掘的公共数据层 |
| 5                                       | 维度层                                         | 存放公共维度，个性维度由集市自行建设和维护                   |
| 6                                       | 临时层                                         | 用于数据开发时，中间临时开发的临时表                         |
| 7                                       | 应用层                                         | 面向特定部门或者用户需求，基于仓内指标汇总数据、整合明细数据等数据进行汇总、连接等整合加工，快速响应应用层需求 |
| 8                                       | 其它                                           | 用于存放存量创建的系统默认层级及用户自定义的层级             |

### 功能列表

| <div style="width: 60pt">功能点</div> | 功能说明                                                     |
| ------------------------------------- | ------------------------------------------------------------ |
| 数据仓库                              | 数据仓库主要规范数仓集成、建模时分层的，支持分层增删改查、发布；若该分层一经发布，则无法删除和编辑 |
| 数据集市                              | 数据集市面向特定目的或主要数据主体, 可以将其分发以满足业务需求本模块可以实现集市增、删、改、查管理，并在集市中建立分层若该分层一经发布，则无法删除和编辑 |
| 主题域管理                            | 支持二级主题的增删改查                                       |
| 业务线管理                            | 支持三级业务线的增删改查                                     |

### 权限列表

| <div style="width: 100pt">功能点</div> | BDP平台管理员 | BDP数据架构师 | BDP开发人员 | BDP运维人员 | BDP资产管理员 |
| -------------------------------------- | ------------- | ------------- | ----------- | ----------- | ------------- |
| 新建数仓分层/数据集市/主题域/业务线    | ✔️             | ✔️             |             |             |               |
| 发布数仓分层/数据集市/主题域/业务线    | ✔️             | ✔️             |             |             |               |
| 删除数仓分层/数据集市/主题域/业务线    | ✔️             | ✔️             |             |             |               |
| 编辑数仓分层/数据集市/主题域/业务线    | ✔️             | ✔️             |             |             |               |
| 查看数仓分层/数据集市/主题域/业务线    | ✔️             | ✔️             | ✔️           | ✔️           | ✔️             |

### 准备工作

登录大数据平台门户首页，选择一站式数据开发与管理平台，单击“数据规划”

:::tip 约束限制

1. 数仓架构师根据数据情况进行数仓分层构建
1. 默认初始化分层为stg,odm,idm,dim,sdm,tmp,dev分层

:::

### 数据仓库

#### 规范数仓分层

该分层信息为系统默认提供的数仓设计方案；用户可以直接使用该方案，也可以根据自己的数仓方案做调整；其中各分层信息要求如下：

| <div style="width: 100pt">英文名</div> | <div style="width: 100pt">中文名</div> | <div style="width: 100pt">分层归属</div> | 描述                                                         |
| -------------------------------------- | -------------------------------------- | ---------------------------------------- | ------------------------------------------------------------ |
| stg                                    | 缓冲层                                 | 缓冲层                                   | 源业务系统的数据增量或快照，保持细节数据，按日存储为主主要用于数据库、日志、消息等基础数据的引入 |
| odm                                    | 贴源层                                 | 贴源层                                   | 用于合并、存储生产系统历史至今数据，按照业务归属组织数据，并进行脱敏及脏数据清洗处理 |
| idm                                    | 明细层                                 | 明细层                                   | 按照业务过程整合明细数据，在保持原子粒度的基础上，完成名称及维度标准化、数据预关联，并以逆范式宽表落地 |
| dim                                    | 维度层                                 | 维度层                                   | 存放公共维度，个性维度由集市自行建设和维护                   |
| sdm                                    | 汇总层                                 | 汇总层                                   | 基于应用集市沉淀的通用类属性、指标而创建面向支持应用系统、数据分析与数据挖掘的公共数据层 |
| tmp                                    | 临时层                                 | 临时层                                   | 用于数据开发时，中间临时开发的临时表                         |
| dev                                    | 开发层                                 | 其它                                     | 用于运营开发建表                                             |

#### 默认分层命名规则

- stg（缓冲层）：

数据表名：库名-自定义表名

例子：stg_my9_test_zz

- odm(贴源层)

数据表名：库名-用户自定义-存储策略-更新时间

例子：odm_city_ table_name_i_d

- dim（维度层）

数据表名：库名- 主题域编码-用户自定义-存储策略-更新时间

例子：dim_content_doc_full_d   文章信息天级全量表

- sdm（汇总层）

数据表名：库名-主题域编码-用户自定义-存储策略-更新时间

例子：idm_news_content_operation_bros_detail_i_d：新闻业务，内容主题，内容运营每日增量入池内容头条阅读表

【数据集市默认规则】

- app_xxx(集市应用层) 


数据表名：app_dev-用户自定义-存储策略-更新时间 

例子：app_dev_news_zhizi_second_bid_ad_report_i_d：新闻业务，按天增量统计的智子二期竞价广告侧报

#### 配置分层命名规则

1. 点击**数据规划-数据仓库/数据集市**，在对应分层后点击**配置命名**
2. 支持配置规则包含数仓分层英文名、主题域编码、业务线编码、存储策略、更新时间、固定值、用户自定义

#### 创建及发布数仓分层

系统已默认为您创建了六个分层（stg层、odm层、idm层、dim层、sdm层、tmp层、dev层）可以满足绝大部分的场景和需求

1. 登录一站式数据开发与管理平台，选择数据规划-数据仓库
2. 单击新建分层，在新建数仓分层对话框配置分层的基本信息，具体参考表1 参数说明
3. 单击确认，完成创建
4. 找到所创建的数层分层，点击发布，完成发布
5. 发布后，不允许修改分层英文名；其余可编辑

表1 参数说明

| <div style="width: 80pt">**参数名**  </div> | **说明**                                               |
| ------------------------------------------- | ------------------------------------------------------ |
| 分层英文名                                  | 只能包含英文字母、数字和下划线，不允许超过10个字符     |
| 分层中文名                                  | 只能包含中文字符                                       |
| 分层归属                                    | 只允许创建缓冲层，贴源层各一层，其他标签可创建多层分层 |
| 分层描述                                    | 输入数仓分层作业的描述信息                             |

#### 管理数仓分层

您可以在数据仓库页面，对已创建的数据分层进行如下管理操作

-  查看数据分层

点击分层英文名称，查看该层详细信息，快速了解分层规划

-  编辑数据分层

点击编辑，您可以对所选数据分层描述信息进行修改

- 删除数据分层

未发布的分层支持删除，选择未发布的数据分层，点击删除，确认完成删除

### 数据集市

主要面向的便是应用想要看到的数据有些企业会将DM 单独拎出来作为数据集市存在，这样的话其他应用想要调用任何的数据指标都能够直接从DM 这一层里的某个主题域进行读取

#### 创建及发布集市分层

1. 登录一站式数据开发与管理平台，选择数据规划-数据集市
2. 单击+，在添加集市对话框填写集市的基本信息，具体参考图2及表2 参数说明
3. 单击确认，完成创建
4. 创建完成后，系统自动为您内置形成dev,tmp,add,dim分层，您可以根据实际使用场景，选择数据分层进行发布，发布完成后，不允许删除及再次发布

表2 参数说明

| <div style="width: 80pt">**参数名**  </div> | **说明**                                       |
| ------------------------------------------- | ---------------------------------------------- |
| 集市名称                                    | 集市名称，命名规范无特殊字符，最大字符不超过10 |
| 集市代码                                    | 只能包含英文字母、数字, 不允许超过10个字符     |
| 集市描述                                    | 对该集市信息的描述，最大字符不超过100          |

5.如若集市下，根据实际使用场景需要新增分层，可以点击新建分层，根据表3参数说明进行创建

 表3 参数说明

| <div style="width: 80pt">**参数名**  </div> | **说明**                                                     |
| ------------------------------------------- | ------------------------------------------------------------ |
| 分层英文名                                  | 前缀为集市代码，自定义内容只能包含英文字母、数字，不允许超过10个字符 |
| 分层中文名                                  | 只能包含中文字符                                             |
| 分层归属                                    | 只允许创建缓冲层，明细层各一层，其他标签可创建多层分层       |
| 分层描述                                    | 输入数仓分层作用的描述信息                                   |

#### 管理集市分层

您可以在数据集市页面，对已创建的数据集市及分层进行如下管理操作

- 查看数据集市及分层

点击数据集市图标：编辑，查看集市基本信息

点击分层英文名称，查看分层基本信息

-  编辑数据分层

点击编辑，您可以对所选数据分层描述信息进行修改

-  删除数据分层

未发布的分层支持删除，选择未发布的数据分层，点击删除，确认完成删除

### 主题域管理

**创建主题域及主题**

1. 登录一站式数据开发与管理平台，选择数据规划-主题域管理
2. 单击+，在新建主题域对话框填写基本信息，具体参考表4 参数说明
3. 单击确认，完成创建“主题域"

表4主题域参数说明

| <div style="width: 80pt">**参数名**  </div> | **说明**                                                   |
| ------------------------------------------- | ---------------------------------------------------------- |
| 主题域名称                                  | 最大字符不超过10，不允许有特殊字符，系统判断是否用相同命名 |
| 主题域编码                                  | 只能包含英文字母、数字，不允许超过10个字符                 |
| 主题域描述                                  | 输入主题域作用的描述信息，最大字符不超过100                |

4. 单击“新建主题“，在新建主题对话框填写基本信息，具体参考表5 参数说明

表5 参数说明

| <div style="width: 80pt">**参数名**  </div> | **说明**                                           |
| ------------------------------------------- | -------------------------------------------------- |
| 主题域                                      | 上级所属主题域                                     |
| 主题名称                                    | 只能包含英文字母，中文字符，数字，不允许有特殊字符 |
| 主题编码                                    | 只能包含英文字母、数字，不允许超过10个字符         |
| 主题描述                                    | 输入主题作用的描述信息，最大字符不超过100          |

**管理主题域及主题**

您可以在主题域管理页面，对已创建的主题域及主题进行如下管理操作

-  查看主题域

点击主题域后操作“查看“，完成主题域查看

- 编辑主题域或主题

点击主题域后：编辑，可对主题域名称，主题域描述编辑，单击确认，完成编辑

点击列表操作列编辑，可对主题名称，主题编码，主题描述编辑，单击确认，完成编辑

- 删除主题域或主题

选择所删主题，单击删除，确认后完成删除

若主题域下存在主题，无法进行删除；若主题域下不存在主题，则点击主题域：删除，确认后完成删除

### 业务线管理

**创建业务线**

1. 登录一站式数据开发与管理平台，选择数据规划-业务线管理
2. 单击“新建一级业务线“，在新建一级业务线对话框填写基本信息，具体参考表6参数说明
3. 单击确认，完成创建“一级业务线“                            

表6 参数说明

| <div style="width: 80pt">**参数名**  </div> | **说明**                                           |
| ------------------------------------------- | -------------------------------------------------- |
| 业务线名称                                  | 只能包含英文字母，中文字符，数字，不允许有特殊字符 |
| 业务线编码                                  | 只能包含英文字母、数字，不允许超过10个字符         |
| 业务线描述                                  | 输入业务线作用的描述信息，最大字符不超过100        |

4. 单击一级业务线后：新建，根据新建二级业务线对话框填写基本信息，如表7参数说明
5. 单击确认，完成创建
6. 如需创建三级业务线，重复步骤4-5

表7 参数说明

| **参数名** | **说明**                                                     |
| ---------- | ------------------------------------------------------------ |
| 业务线名称 | 只能包含英文字母，中文字符，数字，不允许有特殊字符           |
| 业务线编码 | 前缀为一级业务线归属编码，只能包含英文字母、数字，不允许超过10个字符 |
| 业务线归属 | 上级业务线归属                                               |
| 业务线描述 | 输入业务线作用的描述信息，最大字符不超过100                  |

**管理业务线**

您可以在业务线页面，对已创建的业务线进行如下管理操作

- 编辑业务线

点击业务线：编辑，您可以对业务线名称，业务线描述进行修改

- 删除数据分层

点击业务线：删除，单击确认后完成删除

## 数据集成

---

### 产品概述

数据集成，又称为数据同步，其主要提供异构数据源之间的数据移动和交换能力，致力于将企业内部各系统的数据实现互联互通，是大数据平台建设的重要环节；数据集成支持4种场景：数据入仓、数据出仓、数据同步、文件上传；覆盖MySQL、Oracle、SQLServer、PostgreSQL、ClickHouse、HANA、HBase 、ElasticSearch、MongoDB、Sybase、SFTP、Dameng、Redis、DB2、Teradata、Gaussdb、HIVE、CDS、R2M、JES等20种类型数据源的数据同步；支持转换规则、敏感数据加解密管理，支持全量/增量的抽取策略，数据仓库支持拉链/增量/全量/快照的存储策略，为用户后续进行数据查询、计算和分析提供数据基础。

### 应用场景

数据集成把数据从数据来源（A数据源）同步到数据目标（B数据源）。应用场景主要有以下几种

| 应用场景     | 场景描述                                             |
| :----------- | ---------------------------------------------------- |
| **数据入仓** | 数据从三方数据源采集数据抽取到大数据平台数据仓库中   |
| **数据出仓** | 数据从大数据平台数据仓库中推送数据到三方数据源中     |
| **数据同步** | 数据从三方数据源同步数据到另一个三方数据源中         |
| **文件上传** | 数据从本地文件上传至大数据平台数据仓库或三方数据源中 |

### 术语定义

| 术语/缩略语   | 全称和说明                                                   |
| ------------- | ------------------------------------------------------------ |
| **业务归属**  | 支持对各业务线数据开发工作、数据归属进行业务线的划分等进行打标及区分 |
| **缓冲层**    | 将业务数据抽取到平台数仓中的此层；如STG层                    |
| **贴源层**    | 将缓冲层的数据基于转换规则加工到此层；如ODS层                |
| **抽取-全量** | 将源表的全量数据抽取作为当天分区的数据                       |
| **抽取-增量** | 根据增量逻辑将源表的增量数据抽取作业当天分区的数据           |
| **存储-全量** | 每天的数据都是全部最新数据，只存储一份数据，表中数据是截止到前一天的全部数据，全量表无分区 |
| **存储-增量** | 每天一个分区，存放那一天产生的增量数据，即只存放增量数据     |
| **存储-快照** | 按天分区，每天一个分区，每一天的数据都是截止到这一分区的全量数据 |
| **存储-拉链** | 记录数据从开始到当前有状态变化的信息，只有一个分区，存储的是当前时间之前的所有历史记录的最后变化量（总量） |

### 功能列表

| **功能大类**   | **功能模块** | **释义**                                                     |
| :------------- | ------------ | ------------------------------------------------------------ |
| **首页**       | 首页         | 数据集成平台概览展示；数据集成场景直接快捷跳转创建对应的数据集成任务；以及展示操作中心、常见问题的快捷入口 |
| **数据源管理** | 数据源搜索   | 支持按照数据源业务系统、域名、库名、数据源类型进行查询搜索，支持各类数据的增删改操作。 |
| **离线同步**   | 数据入仓     | 在数据入仓模块中配置实现三方数据源采集数据到大数据平台数据仓库中，配置相关规则、字段映射等信息；支持查看对应的作业实例运行情况 |
|                | 数据出仓     | 在数据出仓模块配置实现从大数据平台数据仓库中推送数据到三方数据源，配置相关规则、字段映射等信息；支持查看对应的作业实例运行情况 |
|                | 数据同步     | 支持三方数据源之间进行同步数据，配置相关规则、字段映射关系等信息，支持查看对应的作业实例运行情况 |
| **文件上传**   | 文件上传     | 支持从本地文件上传至大数据平台数据仓库或三方数据源，支持Excel、CSV、TXT格式的文件；支持覆盖和追加两种方式；支持对字段进行加密处理 |

### 权限列表

| 功能点                                                       | BDP系统管理员 | BDP开发人员 | BDP资产管理员 | BDP运维人员 |
| ------------------------------------------------------------ | ------------- | ----------- | ------------- | ----------- |
| 首页配置、场景配置                                           | ✔️             |             |               |             |
| 数据源管理（新建、编辑、连通性测试、删除）                   | ✔️             | ✔️           | ✔️             | ✔️           |
| 离线同步（新建、编辑配置、编辑字段、上线/下线、归档、删除、新增字段） | ✔️             | ✔️           | ✔️             | ✔️           |
| 离线同步（数据入仓-高级配置、数据出仓-高级配置）             | ✔️             |             |               |             |
| 文件上传（新建、详情、编辑、删除、数据预览、日志）           | ✔️             | ✔️           | ✔️             | ✔️           |

### 流程说明

| 流程名称         | 审批人              | 备注                                                         |
| ---------------- | ------------------- | ------------------------------------------------------------ |
| 数据集成入仓流程 | 项目管理员          | 数据入仓新建任务时，需选择一个归属的项目空间，任务提交后审批包括两个审批节点，第一步为缓冲层审批，审批人为项目管理员；第二部为贴原层审批，审批人为项目管理员 |
| 数据集成出仓流程 | 项目管理员-表负责人 | 数据出仓新建任务时，需选择一个归属的项目空间，任务提交后审批包括两个审批节点，第一步审批人为项目管理员，第二步审批人为出仓源表的表负责人 |

### 快速入门

#### 概述

数据集成支持接入多种类型的数据源，通过数据集成任务实时源端到目标端的异构数据集成转换。本章节通过完成一个MySQL到数仓的数据集成配置样例，帮助您快速熟悉使用数据集成的过程。

#### 步骤一：准备数据源

在使用数据集成进行接入数据前，您需要准备好需要采集的MySQL数据源，作为本配置样例中的数据源端；

1、在”数据源管理“页面单击右上角的”新建数据源“。

2、在接入数据源的列表中，选择”MySQL“数据源类型，然后单击”下一步“。

3、在页面中填写MySQL数据源的相关配置信息。

4、完成MySQL数据源参数配置后，单击”连通性测试“，进行数据源的连通测试。务必保证连接信息填写正确，并连通性测试通过。故需要有几个必要条件：

数据源网络权限、数据库连接权限必须保证是连通性和可访问性；如果连通测试失败可能是以下原因，确认后再次尝测连通：a.防火墙权限未授权；

b.数据库是否正常启动；c.数据库是否赋权当前用户连接访问；如果连通性测试成功，则点击”保存“，完成MySQL数据源的接入。

#### 步骤二、新建数据集成任务

在完成了MySQL数据源的接入配置后，您可以开始创建数据集成任务。

1、在”离线同步“页面单击右上角的”新建任务-数据入仓“。

a.配置任务基本信息。其中选择归属的”项目空间“ ，前提是用户所在的项目空间，且项目空间中的数据库包含缓冲层（如stg)和明细层(如ods)。

b.配置数据来源和数据目标。选择MySQL和对应的数据源名称后，自动加载数据源下的表清单。选择1张或多张未接入表。

c.配置任务信息，包括“编辑配置”和“编辑字段”。  编辑配置中，主要关注抽取策略、抽取逻辑、存储逻辑、任务类型，其他信息如无特殊可保持默认。编辑字段中，主要关注主键、增量字段、加解密配置。其他信息如无特殊可保持默认。

d.配置完成后，点击“申请接入“。 任务提交后进行审批。审批包括缓冲层审批和明细层审批，审批人员默认由”项目管理员“进行审批，审批通过后，集成入仓任务创建完成；

#### 步骤三、任务执行和查看结果

在完成集成任务配置后，在数据集成的任务列表中，可以查看和管理任务。

1、点击”操作-实例“，跳转到运维中心。

2、在”运维中心“查看对应的任务实例执行情况，可以手动执行任务，进行重跑后查看执行结果，也可以按运行规则进行执行和结果查看。

### 准备工作

1、开通并成功登录系统；

2、确保一站式数据开发与管理平台-数据规划-**业务线管理**，已有对应的业务线；

3、确保一站式数据开发与管理平台-**数据规划**下，至少已加入一个项目空间，才可以进行后续操作；项目空间-资源配置中的数据库，需包括缓冲层(如stg)、缓冲明细层(如ods)；

4、单击一站式数据开发与管理平台，选择进入**数据集成**；



### 用户指南

您可以通过首页概览页面，通过数据集成场景，快速进入不同场景对应的任务页面，进行任务创建；您也可以通过操作指南、常见问题快速查看集成产品的相关内容；

1、首页中可以对各类中的集成场景加为常用和取消常用。

2、单击具体某个场景，直接跳转到对应的集成任务列表页，进行任务创建操作。

3、单机右侧操作指南和常见问题中的条目项，可以查看具体内容。

说明：

1、数据集成场景，需系统管理员进行集成场景的运营维护；具体详见**开发平台-运营后台-数据集成-场景配置**模块。

2、数据集成操作指南和常见问题，需系统管理员进行运营维护；具体详见**开发平台-运营后台-数据集成-首页配置**模块。

#### 数据源管理

数据源管理，主要为数据集成服务；管理维护数据集成的数据来源和数据目标；您可以在数据源管理中，对数据源进行新增、编辑、删除、连通性测试等操作；

1、在**数据源管理**页面，可根据**数据源类型**、**数据源名称/域名/库表**、**业务归属**等条件筛选需要查看的数据源；支持对有权限的数据源进行编辑、删除、连通性测试操作。

#### 数据源类型

点击右侧的**新增数据源**，即加载系统支持的所有数据源类型，可选择一种点击新增相应的数据源；

说明：数据源需要在连通网络、数据库权限开通的前提下进行应用；

数据源支持范围见下表：

| 数据源类型     | 版本      | 数据入仓 | 数据出仓 | 数据同步 | 文件上传 |
| -------------- | --------- | -------- | -------- | -------- | -------- |
| MySQL/分库分表 | 5.7/8.0   | 支持     | 支持     | 支持     | 支持     |
| Oracle         | 9.0/11.0  | 支持     | 支持     | /        | /        |
| SQL Server     | 2005      | 支持     | 支持     | /        | /        |
| MongoDB        | 4.4.4     | 支持     | 支持     | /        | /        |
| HBase          | 2.1.X     | 支持     | 支持     | /        | /        |
| Elasticsearch  | 6.x/7.X   | 支持     | 支持     | /        | /        |
| ClickHouse     | 20.1.2/22 | 支持     | 支持     | /        | /        |
| PostgreSQL     | 9/13.X    | 支持     | 支持     | /        | /        |
| HANA           | 2.0       | 支持     | 支持     | /        | /        |
| SFTP           |           | 支持     | 支持     | /        | /        |
| HIVE           | 3.1       | 支持     | 支持     | /        | 支持     |
| Redis          | 5.0.5     | /        | 支持     | /        | /        |
| DB2            | 11.5      | 支持     | 支持     | /        | /        |
| Teradata       | 14        | 支持     | 支持     | /        | /        |
| GaussDB        | 100/200   | 支持     | 支持     | /        | /        |
| Dameng         | 8.1       | 支持     | 支持     | /        | /        |
| DB2            | 11.5      | 支持     | 支持     | /        | /        |
| CDS            | 3.8.7     | /        | 支持     | /        | /        |
| R2M            |           | /        | 支持     | /        | /        |
| JES            | 5.X/6.X   | 支持     | 支持     | /        | /        |

#### 新建数据源

新增数据源，在数据源列表中选择某个数据源类型，进入新增页面配置相关参数；不同数据源的连接配置参数可能不同。配置参数完成后，进行连通性测试，测试通过后，点击提交完成；

##### 注册MySQL数据源

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **数据源名称**   | 新建数据源的名称                                             |
| **业务归属**     | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统** | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**   | 数据源业务相关的详细描述                                     |
| **存储方式**     | 数据存储方式，包括两种：标准表/分库分表                      |
| **域名**         | JDBC连接的域名信息或IP地址信息                               |
| **端口号**       | JDBC连接的端口号                                             |
| **库名**         | 连接的数据库名称                                             |
| **用户名**       | 数据库对应的用户名                                           |
| **密码**         | 数据库对应的密码                                             |
| **版本**         | 对应数据源的版本信息。支持5.7和8.0版本                       |
| **元数据采集**   | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**     | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册MySQL分库分表

点击”添加“，弹出添加分库页面，填写分库信息后，点击“确定”，将分库信息添加到列表中，支持添加多个分库；同时在分库列表中勾选分库进行连通性测试；所有分库连通性测试通过后，才可以成功提交；分库信息连通性测试不通过，可以删除对应分库重新添加；

| 参数名       | 说明                                                         |
| ------------ | ------------------------------------------------------------ |
| **域名**     | JDBC连接的域名信息或IP地址信息                               |
| **端口号**   | JDBC连接的端口号                                             |
| **用户名**   | 数据库对应的用户名                                           |
| **密码**     | 数据库对应的密码                                             |
| **分库规则** | 支持分库批量添加和多个分库添加两种方式                       |
| **库名**     | 分库批量添加时，为分库名前缀； 多个分库添加时，填写多个分库名，用英文逗号分隔，如分库1,分库2,分库3 |
| **分库序号** | 分库序号（连续序号，从起始序号~结束序号）                    |
| **扩展信息** | 分库名的扩展信息                                             |
| **库名预览** | 预览填写的分库全名                                           |

##### 注册Oracle数据源

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **数据源名称**   | 新建数据源的名称                                             |
| **业务归属**     | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统** | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**   | 数据源业务相关的详细描述                                     |
| **域名**         | JDBC连接的域名信息或IP地址信息                               |
| **端口号**       | JDBC连接的端口号                                             |
| **库名**         | 连接的数据库名称                                             |
| **用户名**       | 数据库对应的用户名                                           |
| **密码**         | 数据库对应的密码                                             |
| **schema**       | 数据库的schema信息                                           |
| **版本**         | 对应数据源的版本信息。支持9.0和11.0版本                      |
| **元数据采集**   | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**     | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册Postgresql数据源

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **数据源名称**   | 新建数据源的名称                                             |
| **业务归属**     | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统** | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**   | 数据源业务相关的详细描述                                     |
| **域名**         | JDBC连接的域名信息或IP地址信息                               |
| **端口号**       | JDBC连接的端口号                                             |
| **库名**         | 连接的数据库名称                                             |
| **用户名**       | 数据库对应的用户名                                           |
| **密码**         | 数据库对应的密码                                             |
| **schema**       | 数据库的schema信息                                           |
| **版本**         | 对应数据源的版本信息。支持9和13.X版本                        |
| **元数据采集**   | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**     | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册Elasticsearch数据源

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **数据源名称**   | 新建数据源的名称                                             |
| **业务归属**     | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统** | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**   | 数据源业务相关的详细描述                                     |
| **域名**         | JDBC连接的域名信息或IP地址信息                               |
| **端口号**       | JDBC连接的端口号                                             |
| **ES集群名称**   | 连接的es数据源的集群名称                                     |
| **版本**         | 对应数据源的版本信息。支持6.X和7.X版本                       |
| **认证方式**     | 数据源是否有安全认证。无或者Xpack认证                        |
| **用户名**       | 当认证方式为”Xpack认证“时，数据库对应的认证用户名            |
| **密码**         | 当认证方式为”Xpack认证“时，数据库对应的认证密码              |
| **元数据采集**   | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**     | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册SQLServer数据源

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **数据源名称**   | 新建数据源的名称                                             |
| **业务归属**     | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统** | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**   | 数据源业务相关的详细描述                                     |
| **域名**         | JDBC连接的域名信息或IP地址信息                               |
| **端口号**       | JDBC连接的端口号                                             |
| **库名**         | 连接的数据库名称                                             |
| **用户名**       | 数据库对应的用户名                                           |
| **密码**         | 数据库对应的密码                                             |
| **版本**         | 对应数据源的版本信息。支持2005版本                           |
| **元数据采集**   | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**     | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册Sybase数据源

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **数据源名称**   | 新建数据源的名称                                             |
| **业务归属**     | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统** | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**   | 数据源业务相关的详细描述                                     |
| **域名**         | JDBC连接的域名信息或IP地址信息                               |
| **端口号**       | JDBC连接的端口号                                             |
| **库名**         | 连接的数据库名称                                             |
| **schema**       | 数据库的schema信息                                           |
| **用户名**       | 数据库对应的用户名                                           |
| **密码**         | 数据库对应的密码                                             |
| **版本**         | 对应数据源的版本信息。支持ASE 15.7、ASA 17.0版本             |
| **元数据采集**   | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**     | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册Hbase数据源

参数说明

| 参数名                     | 说明                                                         |
| -------------------------- | ------------------------------------------------------------ |
| **数据源名称**             | 新建数据源的名称                                             |
| **业务归属**               | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统**           | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**             | 数据源业务相关的详细描述                                     |
| **ZK集群URL(域名)**        | zookeeper的server地址信息                                    |
| **HDFS共享目录(数据库名)** | Hbase在hdfs上的存储位置。默认是"/hbase"                      |
| **MasterServer**           | HMasterServer( Hbase Master Server)的集群信息                |
| **RegionServer**           | HRegionServer( Hbase Region Server)的集群信息                |
| **版本**                   | 对应数据源的版本信息。支持2.1.X版本                          |
| **开启Kerberos**           | 是否开启Kerberos认证                                         |
| **认证密钥路径**           | 当开启了Kerberos认证，填写keytab文件地址                     |
| **认证用户**               | 当开启了Kerberos认证，填写认证用户名                         |
| **hmaster principal**      | 当开启了Kerberos认证，填写kerberos的principal name信息       |
| **regionserver principal** | 当开启了Kerberos认证，填写kerberos的principal name信息       |
| **元数据采集**             | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**               | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册ClickHouse数据源

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **数据源名称**   | 新建数据源的名称                                             |
| **业务归属**     | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统** | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**   | 数据源业务相关的详细描述                                     |
| **域名**         | JDBC连接的域名信息或IP地址信息                               |
| **端口号**       | JDBC连接的端口号                                             |
| **库名**         | 连接的数据库名称                                             |
| **集群名称**     | 连接集群的名称                                               |
| **用户名**       | 数据库对应的用户名                                           |
| **密码**         | 数据库对应的密码                                             |
| **版本**         | 对应数据源的版本信息。支持22.1.2.X、22.X版本                 |
| **元数据采集**   | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**     | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册HANA数据源

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **数据源名称**   | 新建数据源的名称                                             |
| **业务归属**     | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统** | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**   | 数据源业务相关的详细描述                                     |
| **域名**         | JDBC连接的域名信息或IP地址信息                               |
| **端口号**       | JDBC连接的端口号                                             |
| **库名**         | 连接的数据库名称                                             |
| **schema**       | 数据库的schema信息                                           |
| **用户名**       | 数据库对应的用户名                                           |
| **密码**         | 数据库对应的密码                                             |
| **版本**         | 对应数据源的版本信息。支持2.0版本                            |
| **元数据采集**   | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**     | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册Hive数据源

参数说明

| 参数名               | 说明                                                         |
| -------------------- | ------------------------------------------------------------ |
| **数据源名称**       | 新建数据源的名称                                             |
| **业务归属**         | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统**     | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**       | 数据源业务相关的详细描述                                     |
| **Hive2域名**        | Hiveserver2连接的host信息                                    |
| **Hive2端口号**      | Hiveserver2连接的端口号                                      |
| **库名**             | 连接的Hive数据库名称                                         |
| **用户名**           | Hive数据库对应的用户名                                       |
| **密码**             | Hive数据库对应的密码                                         |
| **元数据域名**       | metastore连接的域名信息                                      |
| **元数据端口**       | metastore连接的端口号                                        |
| **元数据库名**       | metastore连接库的库名                                        |
| **元数据用户名**     | metastore连接库的用户名                                      |
| **元数据密码**       | metastore连接库的密码                                        |
| **Activenode地址**   | 配置Active namenode的地址信息                                |
| **Activenode端口号** | 配置Active namenode的端口号信息                              |
| **权限机制**         | 设置权限机制                                                 |
| **版本**             | 对应数据源的版本信息。支持3.1.X版本                          |
| **元数据采集**       | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**         | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册Teradata数据源

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **数据源名称**   | 新建数据源的名称                                             |
| **业务归属**     | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统** | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**   | 数据源业务相关的详细描述                                     |
| **域名**         | JDBC连接的域名信息或IP地址信息                               |
| **端口号**       | JDBC连接的端口号                                             |
| **库名**         | 连接的数据库名称                                             |
| **用户名**       | 数据库对应的用户名                                           |
| **密码**         | 数据库对应的密码                                             |
| **版本**         | 对应数据源的版本信息。支持14.0版本                           |
| **元数据采集**   | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**     | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册SFTP数据源

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **数据源名称**   | 新建数据源的名称                                             |
| **业务归属**     | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统** | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**   | 数据源业务相关的详细描述                                     |
| **域名**         | SFTP服务器域名信息或IP地址信息                               |
| **端口号**       | SFTP服务器的端口号                                           |
| **文件路径**     | 配置文件相对路径的根目录地址，常用是/upload                  |
| **用户名**       | SFTP服务器对应的用户名                                       |
| **密码**         | SFTP服务器的密码。如果服务器需要身份验证，则需要填写         |
| **私钥**         | 私钥认证文件                                                 |
| **元数据采集**   | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**     | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册MongoDB数据源

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **数据源名称**   | 新建数据源的名称                                             |
| **业务归属**     | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统** | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**   | 数据源业务相关的详细描述                                     |
| **域名**         | JDBC连接的域名信息或IP地址信息                               |
| **端口号**       | JDBC连接的端口号                                             |
| **库名**         | 连接的数据库名称                                             |
| **用户名**       | 数据库对应的用户名                                           |
| **密码**         | 数据库对应的密码                                             |
| **版本**         | 对应数据源的版本信息。支持4.4.4版本                          |
| **元数据采集**   | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**     | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册Redis数据源

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **数据源名称**   | 新建数据源的名称                                             |
| **业务归属**     | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统** | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**   | 数据源业务相关的详细描述                                     |
| **域名**         | JDBC连接的域名信息或IP地址信息                               |
| **端口号**       | JDBC连接的端口号                                             |
| **密码**         | 数据库对应的密码                                             |
| **版本**         | 对应数据源的版本信息。支持5.0.5版本                          |
| **元数据采集**   | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**     | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册DB2数据源

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **数据源名称**   | 新建数据源的名称                                             |
| **业务归属**     | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统** | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**   | 数据源业务相关的详细描述                                     |
| **域名**         | JDBC连接的域名信息或IP地址信息                               |
| **端口号**       | JDBC连接的端口号                                             |
| **库名**         | 连接的数据库名称                                             |
| **schema**       | 数据库的schema信息                                           |
| **用户名**       | 数据库对应的用户名                                           |
| **密码**         | 数据库对应的密码                                             |
| **版本**         | 对应数据源的版本信息。支持11.5版本                           |
| **元数据采集**   | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**     | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册Dameng数据源

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **数据源名称**   | 新建数据源的名称                                             |
| **业务归属**     | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统** | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**   | 数据源业务相关的详细描述                                     |
| **域名**         | JDBC连接的域名信息或IP地址信息                               |
| **端口号**       | JDBC连接的端口号                                             |
| **库名**         | 连接的数据库名称                                             |
| **schema**       | 数据库的schema信息                                           |
| **用户名**       | 数据库对应的用户名                                           |
| **密码**         | 数据库对应的密码                                             |
| **版本**         | 对应数据源的版本信息。支持8.1版本                            |
| **元数据采集**   | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**     | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册Gaussdb数据源

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **数据源名称**   | 新建数据源的名称                                             |
| **业务归属**     | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统** | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**   | 数据源业务相关的详细描述                                     |
| **域名**         | JDBC连接的域名信息或IP地址信息                               |
| **端口号**       | JDBC连接的端口号                                             |
| **库名**         | 连接的数据库名称                                             |
| **schema**       | 数据库的schema信息                                           |
| **用户名**       | 数据库对应的用户名                                           |
| **密码**         | 数据库对应的密码                                             |
| **版本**         | 对应数据源的版本信息。支持200版本                            |
| **元数据采集**   | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**     | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册CDS数据源

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **数据源名称**   | 新建数据源的名称                                             |
| **业务归属**     | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统** | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**   | 数据源业务相关的详细描述                                     |
| **域名**         | JDBC连接的域名信息或IP地址信息                               |
| **端口号**       | JDBC连接的端口号                                             |
| **集群名称**     | CDS集群名称                                                  |
| **app**          | CDS数据库测申请的APP应用名                                   |
| **KEY**          | CDS数据库的密码                                              |
| **元数据采集**   | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**     | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册R2M数据源

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **数据源名称**   | 新建数据源的名称                                             |
| **业务归属**     | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统** | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**   | 数据源业务相关的详细描述                                     |
| **3C服务地址**   | JDBC连接的R2M的服务器地址信息                                |
| **r2m集群名称**  | R2M集群名称                                                  |
| **集群认证密码** | R2M集群的密码                                                |
| **Token**        | 连接R2M的token信息                                           |
| **元数据采集**   | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**     | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

##### 注册JES数据源

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **数据源名称**   | 新建数据源的名称                                             |
| **业务归属**     | 数据源对应的业务归属；业务归属来源“数据规划--业务线管理”信息并逐级展示，下拉列表 |
| **所属业务系统** | 数据源所属具体的业务系统或业务应用                           |
| **数据源描述**   | 数据源业务相关的详细描述                                     |
| **域名**         | JES连接的域名信息                                            |
| **ES应用名称**   | 连接JES的应用名称                                            |
| **密钥**         | 连接JES对应的密码                                            |
| **版本**         | 对应数据源的版本信息。支持5.X、6.X版本                       |
| **元数据采集**   | 设置是否开启数据源的元数据采集；默认是开启                   |
| **采集频率**     | 当元数据采集开关开启时，设置采集频率；系统会创建采集任务进行元数据的采集 |

### 离线同步

离线同步包括三种场景，数据入仓、数据出仓、数据同步。

#### 数据入仓

任务创建完成后，支持对任务进行详情查看、上线/下线、新增字段、编辑字段、编辑配置等操作。

1. 点击操作“详情”，跳转至当前任务详情页。
2. 任务上线/下线/归档/删除：对正常任务进行下线操作（仅当任务有依赖的有效下游调度任务时，则无法下线）；对下线任务进行上线操作。任务上线后则变为正常任务运行。对下线任务进行归档操作。一旦任务归档后，相关的任务和对应调度任务均是无效状态，历史数据会到归档表中；支持对归档作业进行删除操作。
3. 编辑任务：支持对任务规则配置、字段映射进行编辑操作。
4. 新增字段：支持数据源变更时，对新增字段进行接入操作。
5. 实例：支持一键跳转至运维中心，查看详细的调度任务详情。
6. 高级配置：支持通道信息配置，来控制任务并发、速率等，对任务执行情况进行调优。

通道信息配置参数说明

| 参数名                   | 说明                                                         |
| ------------------------ | ------------------------------------------------------------ |
| **任务并发数**           | 从数据源中读取或并行写入数据的并发线程数。默认是8            |
| **单Channel Byte 速率**  | 集成任务单Channel每秒同步的字节数                            |
| **单Channel Record速率** | 集成任务单Channel每秒同步的记录数                            |
| **任务JVM配置**          | 任务运行时内存大小配置；格式如-Xms1m -Xmx1m -XX:NewRatio=4 -XX:SurvivorRatio=3 配置；参数间以英文空格分隔 |

##### 新建数据入仓任务

点击右侧新建任务-数据入仓，进入新建任务页面。如果当前用户有上次未完成任务则自动提醒。

第一步：配置任务基本信息，同步方案选择数据来源、数据目标，接入表选择。

1）、支持对数据来源的数据源进行连通性测试，如果测试通过，方可进行配置；否则无法正确配置相关任务；

2）、选择了数据来源的数据源名称后，会自动加载库中未接入数仓的表清单，以及可以提供查看已接入数仓的表。支持进行表名搜索。

参数说明

| 内容分类     | 参数名         | 说明                                    |
| ------------ | -------------- | --------------------------------------- |
| **基础信息** | **任务名称**   | 数据入仓任务名称                        |
|              | **项目空间**   | 任务所属项目空间                        |
|              | **资源选择**   | 所属项目空间对应的资源队列              |
|              | **任务描述**   | 数据源业务相关的详细描述                |
| **同步方案** | **数据来源**   | 选择数据入仓抽取的数据来源类型，如MySQL |
|              | **数据源名称** | 选择对应的数据源名称（来源数据源管理）  |
|              | **数据目标**   | 入仓对应默认的数据仓库                  |
|              | **数据源名称** | 入仓对应默认的数据仓库中的缓冲层，如STG |



第二步：对已选择表进行编辑规则配置和编辑字段映射配置。

点击编辑配置，配置基本信息、抽取规则、预警规则、运行规则、高级配置等相关信息

参数说明

| <div style="width: 50pt">内容分类</div> | <div style="width: 50pt">参数</div> | 说明                                                         |
| --------------------------------------- | ----------------------------------- | ------------------------------------------------------------ |
| **基本配置**                            | **负责人**                          | 数据入仓任务的负责人。具有任务的所有权和管理权               |
| **抽取规则**                            | **抽取频率**                        | 支持频率为分钟、小时、天、周、月。 分钟支持15分钟和30分钟；小时支持配置执行间隔；周设置时，可选择周一至周日的某一天；月设置时，可选择1号至月末的某一天 |
|                                         | **抽取策略**                        | 支持设置2种策略：增量、全量模式                              |
|                                         | **增量逻辑**                        | 增量策略的具体逻辑。逻辑支持：1、大于等于昨天凌晨0点，小于今天凌晨0点；2、大于昨天凌晨0点 ,小于今天凌晨0点；3、大于等于昨天凌晨0点；4、大于昨天凌晨0点。  小时支持间隔小时周期内，分钟支持间隔分钟周期内 |
|                                         | **存储策略**                        | 支持设置4种策略：增量、全量、快照、拉链模式。根据不通的抽取策略，支持不通的存储策略 |
|                                         | **空记录校验**                      | 支持任务抽取到空数据时的3类操作：1、发出警告；2、调度作业失败；3、无操作（忽略） |
| **预警规则**                            | **预警通知人**                      | 任务执行时，对异常情况预警通知相关人员                       |
|                                         | **预警方式**                        | 当调度作业出现异常需要预警时，支持3种预警方式：1、短信  2、邮件  3、电话 |
|                                         | **预警时机**                        | 支持调度作业在3种情况下进行预警：1、最终失败  2、每次失败  3、成功完成 |
|                                         | **延迟启动监控**                    | 在任务启动时间开始后，超过延迟时间还没运行，系统会产生预警   |
|                                         | **延迟结束监控**                    | 在任务运行到该时间点还未结束，系统会产生告警                 |
| **运行规则**                            | **失败后次日执行**                  | 对于失败的任务，下一周期是否继续自动执行；选择是，则下一周期正常继续执行，选择否，则下一周期不会继续执行 |
|                                         | **失败后是否重试**                  | 支持任务失败的重试，选择是，系统自动做三次重跑；如果三次全部失败，则该作业为最终失败 |
|                                         | **运行超时时长**                    | 任务运行时长的上限设置；超过这个时间点，则任务会停止，状态为“超时” |
|                                         | **任务类型**                        | 支持5种类型：1、定时作业 2、一次性作业 3、条件触发  4、手动作业 5、文件触发； 不同方式的任务不同的执行条件和方式 |
| **高级设置**                            | **抽取时间段**                      | 支持设置任务抽取的时间段。在设置这个时间段内执行，在这个时间段外不执行 |
|                                         | **禁止抽取时间段**                  | 设置时间段内，系统会自动避开该时间段对数据进行抽取           |
|                                         | **预估数据量**                      | 填写预估的数据量，便于进行资源分配和控制                     |

点击编辑字段，进行字段映射相关信息配置。

1）字段默认全选，可根据实际情况进行设置；已勾选字段是有效采集字段，未勾选则不进行采集抽取。

2）当抽取策略配置为“增量”时，则增量字段必须选择；增量字段只针对日期类型字段进行配置。

3）当抽取表中有敏感字段时，需要做加密和脱敏，则需要设置分类分级字段；系统会根据是否敏感自动进行加密处理，同时根据配置的脱敏算法进行脱敏。如果数据源的表中字段是已加密，需要解密后，再加密入仓。

4）系统还提供批量字段上传的方式；下载字段上传模版进行填写后，批量上传。

参数说明

| 参数名           | 说明                                                         |
| ---------------- | ------------------------------------------------------------ |
| **字段名**       | 自动加载来源表的字段英文名                                   |
| **中文注释**     | 自动加载来源表的字段中文名。注：中文名是必填项               |
| **字段类型**     | 自动加载来源表的字段类型                                     |
| **业务主键**     | 设置来源表的业务主键，用于后续主键去重、拉链模式的处理       |
| **是否为空**     | 设置对应字段是否为空                                         |
| **增量字段**     | 设置对应的增量字段。需选择时间类型的字段，作为抽取时候增量的判别条件；且当抽取策略为 增量 时，增量字段必须设置 |
| **数据分类分级** | 设置字段对应分类分级。一般对涉及敏感字段进行设置；系统会自动进行加解密和脱敏操作 |
| **是否解密**     | 当业务系统源表中的字段已加密，入仓时需要配置解密，统一数仓算法进行加密，便于后续统一使用和管理 |
| **解密类型**     | 当业务系统源表中的字段已加密，入仓时需要配置解密，支持选择解密类型，如AKS、ACES等 |
| **解密密钥**     | 提供业务系统源表加密字段解密的密钥                           |
| **脱敏算法**     | 显示对应的脱敏算法，对敏感字段进行脱敏处理（对应数据分类中已设置了脱敏算法）；如果未设置脱敏算法则为空不进行脱敏处理 |

配置完成后点击“申请接入”，提交成功，进入流程审批。具体可进入“**流程中心-我的申请**”查看流程进度。由”项目管理员“登录系统中的“**流程中心-我的待办**”中进行审批。审批通过后，数据入仓任务创建成功。同时会生成调度任务，可通过任务列表-操作 中的“实例“跳转至“**开发平台-运维中心**”的任务详情中查看。

##### 新建ETL任务

对于入仓任务，正常会生成两个任务，缓冲层STG任务和缓冲明细层ETL任务。当ETL任务正常时，是不允许新建ETL任务的；当ETL任务为归档状态或者已删除时，可以对缓冲层STG任务新建ETL任务。

点击操作中的”新建ETL任务“，则弹出新建ETL任务页面，配置相关任务的配置信息、ETL规则、字段映射等信息。

参数说明：

| 参数名               | 说明                                                         |
| -------------------- | ------------------------------------------------------------ |
| **目标表英文名**     | 当前ETL任务目标表英文名。系统自动生成                        |
| **目标表中文名**     | 当前ETL任务目标表中文名称。可修改                            |
| **目标表存储策略**   | 当前ETL任务目标表的数据存储策略，支持4种策略：增量、全量、快照、拉链模式 |
| **脚本类型**         | 默认python                                                   |
| **数据去重**         | 当前ETL任务的数据去重规则，如果选择”是“，则需要设置具体去重分组、排序字段等信息 |
| **重跑当前数据清理** | 任务重跑时，当前数据是否需要清理（只针对异常空抽数据的情况） |
| **数据过滤逻辑**     | 设置数据过滤规则；默认where dt = '{tx_date}' 可修改但不为空 （必须有where 关键字） |
| **自定义MR参数**     | 设置MR参数。可为空                                           |
| **数据生命周期**     | 设置当前ETL任务的目标表数据的生命周期。如果选择”是“，则需要设置保留天数、保留规则、清理类型等信息； |

#### 数据出仓

任务创建完成后，支持对任务进行详情查看、上线/下线、编辑字段、编辑配置等操作。

1）点击操作“详情”，跳转至当前任务详情页。

2）任务上线/下线/删除：对正常任务进行下线操作（仅当任务有依赖的有效下游调度任务时，则无法下线）；对下线任务进行上线操作。任务上线后则变为正常任务运行；支持对下线作业进行删除操作。

3）编辑任务：支持对任务规则配置、字段映射进行编辑操作。

4）实例：支持一键跳转至运维中心，查看详细的调度任务详情。

##### 新建数据出仓任务：

第一步：配置任务基本信息，同步方案选择数据来源、数据目标，表选择。

1）点击“测试连通性”，支持对出仓配置的数据源进行连通性测试；如果连通性失败，则需要到数据源管理模块确认数据源的配置信息是否正确。

2）选中数据源名称后，下方自动加载数据仓库中的用户有权限的表清单，供选择。

参数说明

| 内容分类     | 参数名         | 说明                                                 |
| ------------ | -------------- | ---------------------------------------------------- |
| **基础信息** | **任务名称**   | 数据出仓任务名称                                     |
|              | **项目空间**   | 任务所属项目空间                                     |
|              | **资源选择**   | 所属项目空间对应的资源队列                           |
|              | **任务描述**   | 数据源业务相关的详细描述                             |
| **同步方案** | **数据来源**   | 数据出仓的数据来源，数据源类型默认”数据仓库“         |
|              | **数据源名称** | 数据出仓的数据来源，数据源名称是数据仓库中包括的分层 |
|              | **数据目标**   | 数据出仓推送的目标数据库类型                         |
|              | **数据源名称** | 数据出仓推送的目标数据源名称                         |

第二步：对选择表依次进行编辑规则配置和编辑字段映射配置。

点击编辑配置，配置基本信息、推送规则、运行规则等相关信息：

参数说明

| <div style="width: 50pt">内容分类</div> | <div style="width: 50pt">参数</div> | 说明                                                         |
| --------------------------------------- | ----------------------------------- | ------------------------------------------------------------ |
| **基本配置**                            | **负责人**                          | 数据出仓任务的负责人。具有任务的所有权和管理权               |
| **推送规则**                            | **推送频率**                        | 支持频率为分钟、小时、天、周、月。只有依赖任务时，才支持推送频率；推送频率默认取上游依赖任务的频率，保持频率一致 |
|                                         | **预警通知人**                      | 任务执行时，对异常情况预警通知相关人员。可填多个             |
|                                         | **预警方式**                        | 当调度作业出现异常需要预警时，支持3种预警方式：1、短信  2、邮件  3、电话 |
|                                         | **预警时机**                        | 支持调度作业在3种情况下进行预警：1、最终失败  2、每次失败  3、成功完成 |
|                                         | **延迟启动监控**                    | 在任务启动时间开始后，超过延迟时间还没运行，系统会产生预警   |
|                                         | **延迟结束监控**                    | 在任务运行到该时间点还未结束，系统会产生告警                 |
| **运行规则**                            | **失败后次日执行**                  | 对于失败的任务，下一周期是否继续自动执行；选择是，则任务在下一周期正常执行，选择否，则任务在下一周期不会执行 |
|                                         | **失败后是否重试**                  | 支持任务失败的重试，选择是，系统自动做三次重跑；如果三次全部失败，则该作业为最终失败 |
|                                         | **运行超时时长**                    | 任务运行时长的上限设置；超过这个时间点，则任务会停止，状态为“超时” |
|                                         | **任务类型**                        | 支持3种类型：1、一次性任务 2、触发任务  3、手动任务    不同方式的任务不同的执行条件和方式。 一次性任务支持配置开始日期和开始时间、触发任务支持配置多个依赖的上游任务；3、手动任务 无其他配置 |

点击编辑字段，进行字段映射相关信息配置：

1）字段默认全选，可根据实际情况进行设置；已勾选字段是有效出仓的字段，不勾选字段不会进行出仓。

2）目标表名是目标库的表名称，必须保证是目标库中存在的表。如果没有，需要手工在目标库中建好后再进行出仓配置。具体要求见页面提示。

3）字段映射支持目标字段名的修改，前提是目标表中已有字段。

4）如有敏感信息字段，则支持选择解密进行出仓，同时还可以加密后出仓。

5）支持设置各种出仓策略，如源表的分区类型、分区数、数据时间范围，目标表的策略、分区/非分区、分区类型、数据时间范围等。

参数说明

| <div style="width: 50pt">内容分类</div> | <div style="width: 50pt">参数</div> | 说明                                                         |
| --------------------------------------- | :---------------------------------- | ------------------------------------------------------------ |
| **字段配置**                            | **源表名**                          | 显示来源表名称                                               |
|                                         | **目标表名**                        | 填写出仓推送的目标表名；表必须是目标库已存在的表，先确认是否在目标库已创建该表 |
| **源表**                                | **字段名**                          | 自动加载来源表的字段名                                       |
|                                         | **中文注释**                        | 自动加载来源表的字段中文名称。如没有，需手动添加             |
|                                         | **数据分类分级**                    | 自动加载来源表的字段分类分级。如果是敏感字段系统会强制进行加密操作。不可修改 |
|                                         | **分区字段**                        | 自动加载来源表的分区字段。不可修改                           |
|                                         | **是否分区**                        | 自动加载来源表是否区分。不可修改                             |
|                                         | **分区类型**                        | 可设置分区类型，支持分钟、小时、天、周、月、年；根据设置的分区类型和分区数，推送相应分区的数据到目标表； 举例：如果是分区表，按分区类型、推送分区数、数据时间范围 为数据推送选择条件；如果不是分区表，则为源表全量数据<br/>例如：分区类型为天、推送分区数1、数据时间范围T-1，则按推送频率将昨天的分区数据推送到目标表<br/>例如：分区类型为周、推送分区数1、数据时间范围T-1，则按推送频率将周一的分区数据推送到目标表<br/>例如：分区类型为小时、推送分区数1、数据时间范围HH-1，则按推送频率将上1个小时的分区数据推送到目标表<br/>其中：数据时间范围说明：T-1为前一天；T为当天； 推送分区数说明：分区的数量；如分区数为2，则推送前2个分区数据 |
|                                         | **推送分区数**                      | 可设置分区数；根据设置的分区类型和分区数，推送相应分区的数据到目标表 |
|                                         | **数据时间范围**                    | 可设置数据时间范围，如设置T-1，则将源表T-1的数据推送到目标表 |
| **目标表**                              | **策略**                            | 支持三种策略（和目标源有关）：1、增量  2、全量  3、替换；具体策略逻辑见系统中提示 |
|                                         | **是否分区**                        | 按目标库表的实际情况进行设置。只是在增量策略时有效           |
|                                         | **分区类型**                        | 可设置分区类型，支持天、周、月、年；根据设置的分区类型和分区数，推送相应分区的数据到目标表；如果分区表，按分区类型、数据时间范围，将数据推送至目标表对应分区；如分区类型为天，数据时间范围T-1；10月27号推送，推送数据至目标表10月26号分区中（先清空分区再插入）<br/>如果不是分区表，按增量类型和增量字段，将目标表数据先清空再插入；如增量字段为time，增量类型为天，数据时间范围T-1，10月27号推送，则先将目标表time为10月26号的数据删除后，再进行数据插入 |
|                                         | **数据时间范围**                    | 可设置数据时间范围：T、T-1；如设置T-1，则将源表数据推送到目标表的T-1区分 |



配置完成后点击“申请推送”，提交成功，进入流程审批。具体可进入“**流程中心-我的申请**”查看流程进度。审批通过完成后，数据出仓任务创建成功。同时会生成调度任务；可通过任务列表-操作 中的“实例“跳转至“**开发平台-运维中心**”的任务详情中查看。

#### 数据同步

列表页：展示已有的同步任务，支持相关信息的搜索查询。

任务创建完成后，支持对任务进行详情查看、上线/下线、编辑字段、编辑配置等操作。

1）点击操作“详情”，跳转至当前任务详情页。

2）任务上线/下线/删除：对正常任务进行下线操作（仅当任务有依赖的有效下游调度任务时，则无法下线）；对下线任务进行上线操作。任务上线后则变为正常任务运行；支持对下线作业进行删除操作。

3）编辑任务：支持对任务规则配置、字段映射进行编辑操作。

4）实例：支持一键跳转至运维中心，查看详细的调度任务详情。



##### 新建数据同步任务

第一步：选择数据源，配置任务基本信息，同步选择方案选择数据来源、数据目标。

参数说明

| 内容分类         | 参数名         | 说明                                                         |
| ---------------- | -------------- | ------------------------------------------------------------ |
| **同步选择方案** | **数据来源**   | 数据同步的数据来源                                           |
|                  | **数据源名称** | 数据同步的数据来源的数据源名称。如无可跳转“新建数据源”进行新建 |
|                  | **数据目标**   | 数据同步的目标数据库类型                                     |
|                  | **数据源名称** | 数据同步的目标数据源名称                                     |
|                  | **测试连通性** | 支持测试数据源的连通性                                       |
| **基本信息**     | **任务名称**   | 数据同步的任务名称                                           |
|                  | **项目空间**   | 数据同步任务所属项目空间                                     |
|                  | **资源选择**   | 数据同步任务对应的资源队列                                   |
|                  | **任务描述**   | 任务描述                                                     |

第二步：选择库表，从源表数据源中批量选择要同步的表。通过模糊搜索，加载表清单，选择要同步的表进入右侧区域，进行相关信息的配置；

1）左侧数据表选择，进行数据表搜索，支持模糊搜索后展示表清单。然后选择要同步的表，最多可选择20张表进行同步。

2）选中表都展示到右侧区域后，对所有的表的中文描述、同步方式、增量字段进行完善。业务主键名称是自动读取表中设置主键，如果未设置主键，则不支持同步，进行删除；同步方式支持”增量/全量“，当选中”全量“时，则不用设置增量字段；当选中”增量“时，则必须设置增量字段。

第三步：对同步表进行字段映射相关信息配置：

左侧是选择同步的表清单，选择某一张表，右侧加载表字段字段，进行字段映射配置。

1）、支持源表数据进行预览。

2）、目标表名称支持填写命名。（系统支持自动建表，确保目标库不存在此表名；如果存在，需要更换表名）

3）、字段映射自动加载映射关系，支持目标表的字段名、字段类型、业务描述、是否主键的修改设置。

4）、如果有字段不进行同步，则点击当前线进行删除操作。

5）、点击”配置完成“，则完成表字段映射配置；表后面会打对勾，代表完成。 

6）、相关表完成字段映射配置后，点击”下一步“，会判断是否所有表已经完成配置；如果有未完成配置的表会提示，继续配置or直接下一步。



第四步：进行任务同步规则配置。

参数说明

| 内容分类     | 参数名             | 说明                                                         |
| ------------ | ------------------ | ------------------------------------------------------------ |
| **基本信息** | **负责人**         | 设置同步任务的负责人                                         |
| **运行规则** | **运行频率**       | 设置同步任务的运行频率，支持天、周、月。周设置时，可选择周一至周日的某一天；月设置时，可选择1号至月末的某一天 |
|              | **失败后是否重试** | 支持任务失败的重试，选择是，系统自动做三次重跑；如果三次全部失败，则该作业为最终失败；自动加载来源表的分区字段不可修改 |
|              | **失败后是否执行** | 对于失败的任务，下一周期是否继续自动执行；选择是，自动加载来源表的字段分类分级。如果是敏感字段系统会强制进行加密操作。不可修改 |
|              | **运行超时时长**   | 任务运行时长的上限设置；超过这个时间点，则任务会停止，状态为“超时” |
|              | **同步速率**       | 同步速率支持不限流、限流 两种类型；设置限流时，需要填写具体的速率值(MB/S); |
|              | **任务类型**       | 支持3种类型：1、定时作业 2、一次性作业 3、手动作业  不同方式的任务不同的执行条件和方式. |
| **预警规则** | **预警通知人**     | 任务执行时，对异常情况预警通知相关人员                       |
|              | **预警方式**       | 当调度作业出现异常需要预警时，支持3种预警方式：1、短信  2、邮件  3、电话 |
|              | **预警时机**       | 支持调度作业在3种情况下进行预警：1、最终失败  2、每次失败  3、成功完成 |
|              | **延迟启动监控**   | 在任务启动时间开始后，超过延迟时间还没运行，系统会产生预警   |
|              | **延迟结束监控**   | 在任务运行到该时间点还未结束，系统会产生告警。自动加载来源表的字段中文名称。如没有，需手动添加 |

配置完成后点击提交，任务配置完成；如果提交失败，则继续检查任务配置项进行修改后再次提交。任务完成后同时会生成调度任务；可通过任务列表-操作 中的“实例“跳转至“**开发平台-运维中心**”的任务详情中查看。

### 文件上传

文件上传支持本地文件上传至数据库中，支持四种格式的文本文件上传：Excel、CSV、TXT、DAT。

列表页：展示已有的文件上传任务，支持相关信息的搜索查询。

支持任务的详情查看、数据预览和查看日志；

点击详情，查看任务的详细信息，包括任务基本信息、文件上传的导入文件信息、目标数据库信息、数据处理方式、字段映射信息；

数据预览，可对执行成功的任务，查看预览目标库的数据是否正常，给用户个参考。

查看日志，可对导入任务的详细日志进行查看，快速获取导入过程中的异常、导入的具体情况。



#### 新建文件上传任务

文件上传任务新建，填写基础信息后，上传文件并设置sheet、分隔符、编码格式、起始行等信息，选择要导入的目标库表信息和数据处理策略（覆盖、追加），下一步进行文件中的数据和字段映射后，提交进入导入。

参数说明：

| 内容分类     | 参数名             | 说明                                                         |
| ------------ | :----------------- | ------------------------------------------------------------ |
| **基本信息** | **任务名称**       | 文件上传的任务名称                                           |
|              | **项目空间**       | 文件上传任务的所属项目空间                                   |
|              | **资源队列**       | 任务对应的资源队列                                           |
| **文件上传** | **选择文件**       | 可选择本地文件进行上传，支持Excel、csv、txt、dat格式的文件；文件大小不超过200M |
|              | **列分隔符**       | 当上传文件格式为csv/txt/dat时，可设置文件中的数据分隔符，支持Tab、空格、英文逗号、英文竖线、\|+\|。上传格式为Excel时无 |
|              | **编码格式**       | 当上传文件格式为csv/txt/dat时，支持上传文件的编码格式：GBK或UTF-8。上传格式为Excel时无 |
|              | **起始行选择**     | 文件中对应sheet中有效数据的起始行，默认1                     |
|              | **数据表选择**     | 当上传文件格式为Excel时，需选择上传表中对应的sheet页；默认为sheet1。上传格式为CSV/TXT时无 |
|              | **目标数据源类型** | 导入目标数据源类型，支持数据仓库、MySQL两种                  |
|              | **目标数据源名称** | 导入目标数据源名称                                           |
|              | **目标数据表**     | 导入目标表；支持模糊搜索。如果数据表是分区表，则需设置分区日期和分区字段；如果不是分区表，则不需要设置 |
|              | **处理方式**       | 支持两种数据处理方式，对目标表数据进行覆盖和追加处理；（覆盖：上传数据覆盖目标表之前数据；追加：上传数据增量追加到目标表中，如果有主键重复，则作丢弃处理） |
| **字段映射** | **文件内容**       | 根据上传的文件解析的列，列默认显示为columnX                  |
|              | **目标字段名称**   | 文件内容对应的目标表中的映射字段，目标表中字段可调整映射。注：不能配合重复字段 |
|              | **是否加密**       | 根据业务需求选择当前数据内容是否加密。系统默认支持ACES加密；如需加密则需要填写加密类型和加密秘钥，如不需要加密则不用设置解密算法和加密密钥 |
|              | **加密算法**       | 选择加密算法。选填                                           |
|              | **加密密钥**       | 填写加密密钥。选填                                           |

任务信息填写完成后，点击“确定”按钮，任务则新建成功，且任务状态是“执行中”。 系统会对文件内容进行内容校验，校验不通过则返回失败，并可以对失败任务进行编辑后继续导入；校验通过则进行数据导入。可以查看详细日志。



### 数据入仓实践场景：

#### 场景一、MySQL分库分表入仓

数据入仓选择MySQL数据源类型，选择一个分库数据源后，手动添加分表。

第一步，点击”添加“按钮，支持批量添加不同表。

第二步，手工填写源表名称前缀（需准确填写分表的表名前缀，用于读取分表清单以及作为入仓后的表名）。

第三步，点击”添加分表“，加载出所有分库详情；针对每个分库进行分表添加；勾选添加后显示分表数量；

所有分库分表添加完成后，点击”下一步“，正常执行入仓后续步骤。

#### 场景二、SFTP数据入仓

一、用户放置到SFTP的文件格式需满足文件格式规范和要求。具体格式要求：

1、SFTP文件目录下，按天创建日期文件夹，文件夹下面存放上传的文件； 文件包括两个文件，一个是数据文件；一个是md5文件； 上传文件样例： 

/upload/20221115/t_eterm_fd_dtl_ 20221115_1668584726.zip 

/upload/20221115/t_eterm_fd_dtl_ 20221115_1668584726.md5

2、文件格式要求：

数据文件：为UTF8无BOM格式纯文本文件，首行直接为数据，不包括字段名。列分隔符使用常用分隔符(\t、逗号、竖线等）；行换行符使用UNIX换行符(\n)。由于是 纯文本文件数据，数据文件会一行一行处理，所以字段中不能包含换行符；

MD5文件：用于采集数据前的校验。Md5文件名： t_eterm_fd_dtl_ 20221115_1668584726.md5

生成方式命令参考：md5sum t_eterm_fd_dtl_ 20221115_1668584726.zip > t_eterm_fd_dtl_ 20221115_1668584726.md5

3、准备文件工作完成后，下面正常进行入仓任务配置。

二、入仓任务配置：

1、数据入仓选择SFTP数据源类型，选择一个SFTP数据源后，手动添加文件名如t_eterm_fd_dtl，并进行相关配置；

2、编辑字段时，输入数据文件的列分隔符，选择对应的压缩类型，并手工上传表结构后，提交入仓任务的创建；



### 附录

#### 调度参数使用说明

示例：当前时间为2022-12-27 06:34

#### 系统参数

| 序号 | **参数名**           | **参数使用**           | 参数说明                                | 参数取值示例     |
| ---- | -------------------- | ---------------------- | --------------------------------------- | ---------------- |
| 1    | CURRENT_DATE         | {CURRENT_DATE}         | 获取当前执⾏时间，格式 yyyy-MM-dd HH:mm | 2022-12-27       |
| 2    | CURRENT_HOUR         | {CURRENT_HOUR}         | 获取当前执⾏时间中的⼩时数，格式 HH     | 6                |
| 3    | CURRENT_MINUTE       | {CURRENT_MINUTE}       | 获取当前执⾏时间中的分钟数，格式 mm     | 34               |
| 4    | CURRENT_EXE_TIME     | {CURRENT_EXE_TIME}     | 当前执行时间                            | 2022-12-27 06:34 |
| 5    | TXDATE               | {TXDATE}               | 昨日日期                                | 20221226         |
| 6    | TX_DATE              | {TX_DATE}              | 昨日日期                                | 2022-12-26       |
| 7    | TXPREDATE            | {TXPREDATE}            | 前日日期                                | 20221225         |
| 8    | TX_PREDATE           | {TX_PREDATE}           | 前日日期                                | 2022-12-25       |
| 9    | TX_PRE_1_DATE        | {TX_PRE_1_DATE}        | 前日日期                                | 2022-12-25       |
| 10   | TX_PRE_2_DATE        | {TX_PRE_2_DATE}        | 三天前日期                              | 2022-12-24       |
| 11   | TX_PRE_3_DATE        | {TX_PRE_3_DATE}        | 四天前日期                              | 2022-12-23       |
| 12   | TX_PRE_4_DATE        | {TX_PRE_4_DATE}        | 五天前日期                              | 2022-12-22       |
| 13   | TX_PRE_5_DATE        | {TX_PRE_5_DATE}        | 六天前日期                              | 2022-12-21       |
| 14   | TX_PRE_6_DATE        | {TX_PRE_6_DATE}        | 七天前日期                              | 2022-12-20       |
| 15   | TXPRE6DATE           | {TXPRE6DATE}           | 七天前日期                              | 20221220         |
| 16   | TXNEXTDATE           | {TXNEXTDATE}           | 当日日期                                | 20221227         |
| 17   | TX_NEXTDATE          | {TX_NEXTDATE}          | 当日日期                                | 2022-12-27       |
| 18   | TX_NEXT_1_DATE       | {TX_NEXT_1_DATE}       | 当日日期                                | 2022-12-27       |
| 19   | TX_NEXT_2_DATE       | {TX_NEXT_2_DATE}       | 一天后日期                              | 2022-12-28       |
| 20   | TX_NEXT_3_DATE       | {TX_NEXT_3_DATE}       | 两天后日期                              | 2022-12-29       |
| 21   | TX_NEXT_4_DATE       | {TX_NEXT_4_DATE}       | 三天后日期                              | 2022-12-30       |
| 22   | TX_NEXT_5_DATE       | {TX_NEXT_5_DATE}       | 四天后日期                              | 2022-12-31       |
| 23   | TX_NEXT_6_DATE       | {TX_NEXT_6_DATE}       | 五天后日期                              | 2023-01-01       |
| 24   | TXNEXT6DATE          | {TXNEXT6DATE}          | 五天后日期                              | 20230101         |
| 25   | TXMONTH              | {TXMONTH}              | 当前年月                                | 202212           |
| 26   | TXMONTHFIRSTDATE     | {TXMONTHFIRSTDATE}     | 当月第一天                              | 20221201         |
| 27   | TXMONTHLASTDATE      | {TXMONTHLASTDATE}      | 当月最后一天                            | 20221231         |
| 28   | TXPREMONTH           | {TXPREMONTH}           | 上个月的年月                            | 202211           |
| 29   | TXPREMONTHFIRSTDATE  | {TXPREMONTHFIRSTDATE}  | 上个月的第一天                          | 20221101         |
| 30   | TXPREMONTHLASTDATE   | {TXPREMONTHLASTDATE}   | 上个月的最后一天                        | 20221130         |
| 31   | TXYEAR               | {TXYEAR}               | 今年                                    | 2022             |
| 32   | TXPREYEAR            | {TXPREYEAR}            | 去年                                    | 2021             |
| 33   | TXYEARFIRSTDATE      | {TXYEARFIRSTDATE}      | 今年第一天                              | 20220101         |
| 34   | TXYEARLASTDATE       | {TXYEARLASTDATE}       | 今年最后一天                            | 20221231         |
| 35   | TX_YEARFIRSTDATE     | {TX_YEARFIRSTDATE}     | 今年第一天                              | 2022-01-01       |
| 36   | TX_YEARLASTDATE      | {TX_YEARLASTDATE}      | 今年最后一天                            | 2022-12-31       |
| 37   | TXYEARWEEKNUM        | {TXYEARWEEKNUM}        | 当前日期在一年中的第几个周              | 53               |
| 38   | TX_MONTH             | {TX_MONTH}             | 当前年月                                | 2022-12          |
| 39   | TX_MONTHFIRSTDATE    | {TX_MONTHFIRSTDATE}    | 当月第一天                              | 2022-12-01       |
| 40   | TX_MONTHLASTDATE     | {TX_MONTHLASTDATE}     | 当月最后一天                            | 2022-12-31       |
| 41   | TX_PREMONTH          | {TX_PREMONTH}          | 上个月的年月                            | 2022-11          |
| 42   | TX_PREMONTHFIRSTDATE | {TX_PREMONTHFIRSTDATE} | 上个月的第一天                          | 2022-11-01       |
| 43   | TX_PREMONTHLASTDATE  | {TX_PREMONTHLASTDATE}  | 上个月的最后一天                        | 2022-11-30       |

 

#### 时间偏移函数

**函数名称**：CURRENT_EXE_TIME

函数使用：<img src="/Users/wangyuxian10/All/helpdoc/di-help-documentation/docs/mdfiles/bdp/img/dataintegration/hanshushuoming.png" alt="hanshushuoming" style="zoom:50%;" />

**参数说明**：

operator: 操作符，可选 + 或 -

offset: 偏移量，仅⽀持数字

unit: 单位，可选y年M⽉d⽇H时m分

format: 格式，可选yyyy-MM-dd HH:mm、yyyy-MM-dd、yyyyMMdd、yyyy、MM、dd、HH:mm、HHmm、HHmm、HH、mm



#### 系统变量替换原理

识别脚本中所有的{时间变量}，并进行替换。比如：识别脚本中的{TX_DATE}，替换为

2022-12-26。

#### 使用示例

【示例一】

```sql
delete from idm_yuan_yanshou_1120_i_d where dt>='{CURRENT_EXE_TIME-2H,yyyy-MM-dd HH:mm}' and dt<'{CURRENT_EXE_TIME}'
```

【示例二】

```sql
select count(1) from idm.idm_c02_inn_helh_store_table_s where dt='{TX_DATE}' and instr(table_path,db_path)>0
```

## 规范建模

规范建模以维度建模理论支撑，实现规范化，标准化的数据模型开发，定位于数据开发流程中指导数据开发人员规范化实践建模方法论。

### 产品概述

维度模型建立在星型模式或雪花模式之上，维度围绕事实表，主要从四步确认建立维度模型。首先，选择业务流程，在描述了业务流程之后，设计的下一步就是声明模型的粒度，模型的粒度是维度模型应该关注内容的准确描述，例如：零售店客户单上的单行数据。设计的第三步就是定义模型的维度，维度是事实表的基础，通常维度是诸如日期、商店、库存等名词。定义维度后，下一步就是创建事实表，此步骤是确认每个事实表行的数字事实，大多事实表行都是带有业务含义的具体数值，例如单位成本、数量等。

### 应用场景

随着业务的快速发展，企业数据成几何倍增长，数据量庞大、复杂、各类数据间标准不一致，往往会出现数据难以管理的现象。规范建模支持关联数仓规划、关联企业数据标准、维度建模、数据指标定义，通过使用规范建模，您可以将建模设计产出的维度表、事实表和汇总表物化到计算引擎中并进一步应用。

### 术语定义

| **<div style="width: 25pt">序号</div>** | **<div style="width: 80pt">术语/缩略语</div>** | **全称和说明**                                               |
| --------------------------------------- | :--------------------------------------------- | ------------------------------------------------------------ |
| 1                                       | 维度                                           | 维度是用于观察和分析业务数据的视角，支撑对数据汇聚、钻取、切片分析，用于SQL中的GROUP BY条件，例如时间维度、地区维度、产品维度等。创建维度，即从顶层规范业务中实体（或称主数据）的存在性及唯一性 |
| 2                                       | 维度类型                                       | - 普通维度：不具有枚举和层级的维度  <br />- 枚举维度：基于码表创建的维度，字段信息、数据与码表保持一致，具备可枚举属性的维度，例如性别存在男，女<br />- 层级维度：具有层级结构的维度，例如地区-省-市 |
| 3                                       | 事实表                                         | 归属于某个业务过程的事实逻辑表，可以丰富具体业务过程所对应事务的详细信息。例如下订单这一业务过程中，您可以创建下订单这一明细表，用于记录下单过程可能产生实际数据字段，例如订单ID、订单创建时间、商品ID、数量、金额等。后续您可将这些明细表部署到数仓中，通过ETL将真实的数据按照明细表的定义方式进行汇总存储，便于业务分析时取用 |

### 功能列表

| **<div style="width: 25pt">序号</div>** | **<div style="width: 80pt">子功能需求</div>** | **说明**                                                     |
| --------------------------------------- | --------------------------------------------- | ------------------------------------------------------------ |
| 1                                       | 维度管理                                      | 数据开发人员可以新增，编辑，发布，下线维度。当维度发布后，系统会自动创建与维度对应的维度表 |
| 2                                       | 多类型维度                                    | 支持新增普通维度，枚举维度，层级维度                         |
| 3                                       | 管理事实表                                    | 数据开发人员可以新增，编辑，发布，下线，删除事实表           |
| 4                                       | 预览/复制SQL                                  | 对于事实表、维度表均可预览建表SQL并进行复制                  |
| 5                                       | 查看发布历史                                  | 查看事实表/维度表发布历史，版本对比信息                      |
| 6                                       | 关联数据标准                                  | 支持数据标准规范化字段                                       |
| 7                                       | 关联维度                                      | 支持事实表关联维度                                           |
| 8                                       | 智能命名推荐                                  | 根据中文名智能推荐英文名                                     |
| 9                                       | 应用表管理                                    | 支持应用表的新增，编辑，发布，下线，删除                     |
| 10                                      | 表批量导入导出                                | 支持维度表/事实表/应用表的导入导出                           |

### 权限列表

| 功能点                                         | BDP系统管理员 | 项目管理员 | 表负责人 |
| ---------------------------------------------- | ------------- | ---------- | -------- |
| 维度表个人维度管理（创建/编辑/删除/下线/发布） | ✔️             | ✔️          | ✔️        |
| 事实表个人维度管理（创建/编辑/删除/下线/发布） | ✔️             | ✔️          | ✔️        |
| 应用表个人维度管理（创建/编辑/删除/下线/发布） | ✔️             | ✔️          | ✔️        |
| 维度表项目维度管理（创建/编辑/删除/下线/发布） | ✔️             | ✔️          |          |
| 事实表项目维度管理（创建/编辑/删除/下线/发布） | ✔️             | ✔️          |          |
| 应用表项目维度管理（创建/编辑/删除/下线/发布） | ✔️             | ✔️          |          |
| 维度表全局维度管理（创建/编辑/删除/下线/发布） | ✔️             |            |          |
| 事实表全局维度管理（创建/编辑/删除/下线/发布） | ✔️             |            |          |
| 应用表全局维度管理（创建/编辑/删除/下线/发布） | ✔️             |            |          |
| 审批维度表、事实表、应用表发布/下线            | ✔️             | ✔️          | ✔️        |
| 历史版本比对                                   | ✔️             | ✔️          | ✔️        |
| 查看历史版本                                   | ✔️             | ✔️          | ✔️        |
| 预览SQL                                        | ✔️             | ✔️          | ✔️        |

### 流程列表

![image-20221228113626131](/Users/wangyuxian10/All/helpdoc/di-help-documentation/docs/mdfiles/bdp/img/image-20221228113626131.png)

### 准备工作

执行如下操作，进入规范建模模块：

1. 单击一站式数据开发与管理平台，选择进入规范建模
2. 进入维度管理页面

表1 编号说明

| **编号** | **说明**                                                     |
| -------- | ------------------------------------------------------------ |
| 1        | 规范建模前，需要加入一个项目空间，才可以进行后续操作         |
| 2        | 主题视角/业务视角可以进行切换                                |
| 3        | 在顶部导航标签，选择维度管理可以快速创建维度/维度表，选择维度管理，可以快速创建维度 |
| 4        | 选择维度管理下+图标，新建维度，选择刷新图标，刷新主题域下维度/事实表 |
| 5        | 选择对应指标，可以查看全局维度/维度表/事实表列表             |
| 6        | 在建模流程中，可以根据提示，快速进入对应模块                 |
| 7        | 按照编辑时间，可以快速编辑自己为负责人的表                   |
| 8        | 快速进入规范建模帮助文档                                     |
| 9        | 查看维度(表)/事实表/应用表列表                               |

:::tip 约束限制
规范建模前，需要数据架构人员构建完成数据仓库、数据集市、主题域与业务线，详情见*数据规划*
规范建模前，需要数据开发人员加入项目空间，详情见*申请加入项目空间*
规范建模前，需要数据架构人员构建完成数据标准，详情见*数据标准*
:::

### 用户指南

新建维度并发布

1. 单击一站式数据开发与管理平台-规范建模，进入规范建模页面。
2. 在规范建模页面，进入**新建维度**页面。
3. 单击+，在“新建维度”页面，根据页面提示配置参数，基本配置参数说明如表1所示

表1 参数说明

| **<div style="width: 80pt">参数</div>** | **说明**                                                     |
| --------------------------------------- | ------------------------------------------------------------ |
| 数仓分层                                | 下拉框选择所属的数仓分层                                     |
| 更新时间                                | 日/周/月/季度/年/一次性                                      |
| 存储策略                                | 按您的接入需求选择即可，即全量、增量、快照和拉链  1）全量：每天的数据都是全部最新数据，只存储一份数据，表中数据是截止到前一天的全部数据，全量表无分区  2）增量：每天一个分区，存放那一天产生的增量数据，即只存放增量数据  3）快照：按天分区，每天一个分区，每一天的数据都是截止到这一分区的全量数据  4）拉链：记录数据从开始到当前有状态变化的信息，只有一个分区，存储的是当前时间之前的所有历史记录的最后变化量（总量） |
| 存储类型                                | ORC/TXT                                                      |
| 所属主题                                | 下拉框中选择相应的主题                                       |
| 所属业务                                | 下拉框中选择相应的业务线                                     |
| 维度中文名                              | 至少包含一个中文字符                                         |
| 维度英文名                              | 只能包含英文字母、数字和下划线；根据数仓分层表命名规则生成表英文名 |
| 生命周期                                | 默认365天，支持30/60/90/120/180/270/365天/永久               |
| 负责人                                  | 默认是创建者（若创建者不在该项目空间，则无法选中），在下拉列表中可以选择维度所属的负责人，也可以输入用户账号或直接选择已有用户 |
| 描述                                    | 描述信息，支持的长度为0-600字符                              |

在“维表设计”中，分为基本字段和分区字段，可以手动/EXCEL上传/DDL导入三种方式添加多个字段

表2维表设计

| **<div style="width: 80pt">参数</div>** | **说明**                                                     |
| --------------------------------------- | ------------------------------------------------------------ |
| 字段中文名                              | 字段中文名称                                                 |
| 字段英文名                              | 只能包含英文字母、数字和下划线；根据字段中文名，可以智能推荐数据标准和命名，选择推荐数据标准，则该行字段中文名，字段英文名，数据类型，是否为空被规范化，选择推荐词根，则按照推荐选择英文名 |
| 数据标准                                | 单击”+“可以选择一个数据标准，规范所在行的字段中文名，字段英文名，数据类型，是否为空 |
| 数据类型                                | 根据原始数据定义数据类型                                     |
| 主键                                    | 请根据业务需求选择合适的字段作为主键                         |
| 不为空                                  | 是否限制该字段不为空                                         |
| 分类分级                                | 标识该字段的分类分级                                         |
| 描述                                    | 输入字段作用的描述信息                                       |

4.	配置完成后，单击“发布”
5.	在弹出的对话框中，选择审核人，输入发布原因，完成发布
6.	可以参照步骤1-5，完成其他类型维度的创建和发布
   选择枚举维度，选择关联码表，属性配置参数如下

选择枚举维度，层级设计参数如下，可以根据层级进行树形展示

7. 待审核人员审核通过后，系统会自动创建于维度相对应的维度表。在“维度建模”标签页，选择“维度表”页签，可以查看建好的维度表。

编辑维度

1. 单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2. 方式1：选择维度建模页签，选择“查看维度表列表”进入维度列表页面，在事实表列表中找到需要编辑的维度表，单击“编辑”，进入编辑维度表页面
   方式2：模糊搜索表英文名，双击左侧导航树表名，查看表详情，单击“编辑”，进入编辑页面
3. 根据实际需要编辑维度表的相关信息，参数配置参考新建维度表配置参数
4. 单击“保存”，保存所做的修改。或者，单击“发布”，发布修改后维度表

发布维度

单个维度发布：

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择维度管理页签，选择“查看维度（表）列表”进入维度列表页面，在维度表列表中找到需要发布的维度表，单击“发布”，在弹出对话框中，输入发布原因，选择审核人，单击“确认”，完成发布

批量维度发布：

1. 单击一站式数据开发与管理平台-规范建模，进入规范建模页面

2. 选择“查看维度（表）列表”进入事实表列表页面，勾选需要发布的事实表，点击“批量发布”

3. 在弹出对话框中，选择审批人和发布原因，单击“确定”，完成发布

下线维度

对于已发布的单个维度，可以执行以下步骤，完成下线：

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看维度（表）列表”进入维度列表页面，在维度列表中找到需要下线的已发布维度，单击“下线”，在弹出对话框中，输入下线原因，选择审核人，单击“确认”，完成下线，待审核人通过审核，下线成功。

批量维度下线

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看维度（表）列表”进入维度列表页面，勾选需要下线的维度，点击“批量下线”
3.	在弹出对话框中，选择审批人和发布原因，单击“确定”，完成下线，待审核通过后，下线成功。

删除维度

对于草稿/已下线状态的维度，可以执行以下步骤完成删除

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看维度（表）列表”进入维度列表页面，在维度列表中找到需要删除的草稿状态维度，单击“删除”，在弹出对话框中，单击“确认”，完成删除。

查看发布历史

对于已发布的维度，可以执行以下步骤查看发布历史

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看维度（表）列表”进入维度列表页面，在维度列表中找到需要查看发布历史的维度，单击“更多-发布历史”，显示发布历史页面
3.	在发布历史页面，可以查看维度（表）的发布历史，版本对比信息

查看预览SQL

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看维度（表）列表”进入维度列表页面，在维度列表中找到需要预览SQL的维度，单击“更多-预览SQL”，显示SQL对话弹框
3.	在“预览SQL”中，您可以查看SQL语句，也可以复制SQL

导入表

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看维度（表）列表”进入维度列表页面，选择导入，下载维度表导入EXCEL模版，填写完成后，进行上传
3.	确认上传后，可以查看导入情况(若表名已在大数据平台存在，则导入失败)

导出表

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看维度（表）列表”进入维度列表页面，选择需要导出的维度表，点击导出，完成下载

 新建事实表并发布

1. 单击一站式数据开发与管理平台-规范建模，进入规范建模页面

2. 在规范建模页面，按照下图操作指引，进入新建事实表页面

3. 单击+，在“新建事实表”页面，根据页面提示配置参数，基本配置参数说明如表3所示

表3 参数说明

| **<div style="width: 80pt">参数</div>** | **说明**                                                     |
| --------------------------------------- | ------------------------------------------------------------ |
| 数仓分层                                | 下拉框选择所属的数仓分层                                     |
| 更新时间                                | 日/周/月/季度/年/一次性                                      |
| 存储类型                                | ORC/TXT                                                      |
| 存储策略                                | 按您的接入需求选择即可，即全量、增量、快照和拉链  1）全量：每天的数据都是全部最新数据，只存储一份数据，表中数据是截止到前一天的全部数据，全量表无分区  2）增量：每天一个分区，存放那一天产生的增量数据，即只存放增量数据  3）快照：按天分区，每天一个分区，每一天的数据都是截止到这一分区的全量数据  4）拉链：记录数据从开始到当前有状态变化的信息，只有一个分区，存储的是当前时间之前的所有历史记录的最后变化量（总量） |
| 所属主题                                | 下拉框中选择相应的主题                                       |
| 所属业务                                | 下拉框中选择相应的业务线                                     |
| 表中文名                                | 只能包含中文字符                                             |
| 表英文名                                | 只能包含英文字母、数字和下划线；根据数仓分层的命名规则生成表英文名 |
| 生命周期                                | 默认365天，支持30/60/90/120/180/270/365天/永久               |
| 负责人                                  | 默认是创建者，在下拉列表中可以选择维度所属的负责人，也可以输入用户账号或直接选择已有用户 |
| 描述                                    | 描述信息，支持的长度为0-600字符                              |

在“建表配置”中，分为基本字段和分区字段，可以手动/EXCEL上传/DDL导入三种方式添加多个字段

表4参数说明

| **<div style="width: 80pt">参数</div>** | **说明**                                                     |
| --------------------------------------- | ------------------------------------------------------------ |
| 字段中文名                              | 字段中文名称                                                 |
| 字段英文名                              | 只能包含英文字母、数字和下划线；根据字段中文名，可以智能推荐数据标准和命名，选择红色标记即为推荐数据标准，则该行字段中文名，字段英文名，数据类型，是否为空被规范化，选择蓝色标记即为推荐词根，则按照推荐选择英文名 |
| 数据标准                                | 单击”+“可以选择一个数据标准，规范所在行的字段中文名，字段英文名，数据类型，是否为空 |
| 关联维度                                | 当该字段具有维度属性，可以关联该维度，显示关联维度名称       |
| 数据类型                                | 根据原始数据定义数据类型                                     |
| 主键                                    | 请根据业务需求选择合适的字段作为主键                         |
| 不为空                                  | 是否限制该字段不为空                                         |
| 分类分级                                | 是否标识该字段的具体分类分级                                 |
| 描述                                    | 输入字段作用的描述信息                                       |

8.	配置完成后，单击“发布”
9.	在弹出的对话框中，选择审核人，输入发布原因，完成发布；审核通过后，事实表就会在数据库自动创建

编辑事实表

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	方式1：选择维度建模页签，选择“查看事实表列表”进入维度列表页面，在事实表列表中找到需要编辑的事实表，单击“编辑”，进入编辑事实表页面
   方式2：模糊搜索表英文名，双击左侧导航树表名，查看表详情，单击“编辑”，进入编辑页面
3.	根据实际需要编辑事实表的相关信息，参数配置参考新建事实表配置参数
4.	单击“保存”，保存所做的修改。或者，单击“发布”，发布修改后事实表

发布事实表

单个事实表发布：

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择维度建模页签，选择“查看事实表列表”进入事实表列表页面，在事实表列表中找到需要发布的事实表，单击“发布”，在弹出对话框中，输入发布原因，选择审核人，单击“确认”，完成发布

批量事实表发布：

1. 单击一站式数据开发与管理平台-规范建模，进入规范建模页面

2. 选择“查看事实表列表”进入事实表列表页面，勾选需要发布的事实表，点击“批量发布”

3. 在弹出对话框中，选择审批人和发布原因，单击“确定”，完成发布

下线事实表

对于已发布的单个事实表，可以执行以下步骤，完成下线：

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看事实表列表”进入事实表列表页面，在事实表列表中找到需要下线的已发布事实表，单击“下线”，在弹出对话框中，输入下线原因，选择审核人，单击“确认”，完成下线，待审核人通过审核，下线成功

批量事实表下线

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看事实表列表”进入事实表列表页面，勾选需要下线的事实表，点击“批量下线”
3.	在弹出对话框中，选择审批人和发布原因，单击“确定”，完成下线，待审核通过后，下线成功

删除事实表

对于草稿/已下线状态的事实表，可以执行以下步骤完成删除

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看事实表列表”进入事实表列表页面，在事实表列表中找到需要删除的草稿状态事实表，单击“删除”，在弹出对话框中，单击“确认”，完成删除

查看发布历史

对于已发布的事实表，可以执行以下步骤查看发布历史

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看事实表列表”进入事实表列表页面，在事实表列表中找到需要查看发布历史的事实表，单击“更多-发布历史”，显示发布历史页面
3.	在发布历史页面，可以查看事实表的发布历史，版本对比信息

查看预览SQL

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看事实表列表”进入维度列表页面，在事实表列表中找到需要预览SQL的事实表，单击“更多-预览SQL”，显示SQL对话弹框
3.	在“预览SQL”中，您可以查看SQL语句，也可以复制SQL

导入表

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看事实表列表”进入事实表列表页面，选择导入，下载事实表导入EXCEL模版，填写完成后，进行上传
3.	确认上传后，可以查看导入情况(若表名已在大数据平台存在，则导入失败)

导出表

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看事实表列表”进入维度列表页面，选择需要导出的事实表，点击导出，完成下载

 新建应用表并发布

::: tip 约束限制

​        建立应用表必须加入非数仓类型的项目空间
:::

1. 单击一站式数据开发与管理平台-规范建模，进入规范建模页面

2. 在规范建模页面，进入新建应用表页面

3. 单击+，在“新建应用表”页面，根据页面提示配置参数，基本配置参数说明如表所示

表3 参数说明

| **<div style="width: 80pt">参数</div>** | **说明**                                                     |
| --------------------------------------- | ------------------------------------------------------------ |
| 集市分层                                | 下拉框选择所属的集市分层                                     |
| 更新时间                                | 日/周/月/季度/年/一次性                                      |
| 存储类型                                | ORC/TXT                                                      |
| 存储策略                                | 按您的接入需求选择即可，即全量、增量、快照和拉链  1）全量：每天的数据都是全部最新数据，只存储一份数据，表中数据是截止到前一天的全部数据，全量表无分区  2）增量：每天一个分区，存放那一天产生的增量数据，即只存放增量数据  3）快照：按天分区，每天一个分区，每一天的数据都是截止到这一分区的全量数据  4）拉链：记录数据从开始到当前有状态变化的信息，只有一个分区，存储的是当前时间之前的所有历史记录的最后变化量（总量） |
| 表中文名                                | 只能包含中文字符                                             |
| 表英文名                                | 只能包含英文字母、数字和下划线；根据数仓分层的命名规则生成表英文名 |
| 生命周期                                | 默认365天，支持30/60/90/120/180/270/365天/永久               |
| 负责人                                  | 默认是创建者，在下拉列表中可以选择维度所属的负责人，也可以输入用户账号或直接选择已有用户 |
| 分区表                                  | 标识是否为分区表                                             |
| 描述                                    | 描述信息，支持的长度为0-600字符                              |

在“建表配置”中，分为基本字段和分区字段，可以手动/EXCEL上传/DDL导入三种方式添加多个字段

表4参数说明

| **<div style="width: 80pt">参数</div>** | **说明**                                                     |
| --------------------------------------- | ------------------------------------------------------------ |
| 字段中文名                              | 字段中文名称                                                 |
| 字段英文名                              | 只能包含英文字母、数字和下划线；根据字段中文名，可以智能推荐数据标准和命名，选择红色标记即为推荐数据标准，则该行字段中文名，字段英文名，数据类型，是否为空被规范化，选择蓝色标记即为推荐词根，则按照推荐选择英文名 |
| 数据标准                                | 单击”+“可以选择一个数据标准，规范所在行的字段中文名，字段英文名，数据类型，是否为空 |
| 关联维度                                | 当该字段具有维度属性，可以关联该维度，显示关联维度名称       |
| 数据类型                                | 根据原始数据定义数据类型                                     |
| 主键                                    | 请根据业务需求选择合适的字段作为主键                         |
| 不为空                                  | 是否限制该字段不为空                                         |
| 分类分级                                | 是否标识该字段的具体分类分级                                 |
| 描述                                    | 输入字段作用的描述信息                                       |

8.	配置完成后，单击“发布”
9.	在弹出的对话框中，选择审核人，输入发布原因，完成发布；审核通过后，应用表就会在数据库自动创建

编辑应用表

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	方式1：选择维度建模页签，选择“查看应用表列表”进入维度列表页面，在应用表列表中找到需要编辑的事实表，单击“编辑”，进入编辑应用表页面
   方式2：模糊搜索表英文名，双击左侧导航树表名，查看表详情，单击“编辑”，进入编辑页面
3.	根据实际需要编辑应用表的相关信息，参数配置参考新建应用表配置参数
4.	单击“保存”，保存所做的修改。或者，单击“发布”，发布修改后应用表

发布应用表

单个应用表发布：

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择维度建模页签，选择“查看应用表列表”进入应用表列表页面，在应用表列表中找到需要发布的应用表，单击“发布”，在弹出对话框中，输入发布原因，选择审核人，单击“确认”，完成发布

批量应用表发布：

1. 单击一站式数据开发与管理平台-规范建模，进入规范建模页面

2. 选择“查看应用表列表”进入应用表列表页面，勾选需要发布的应用表，点击“批量发布”

3. 在弹出对话框中，选择审批人和发布原因，单击“确定”，完成发布

下线应用表

对于已发布的单个应用表，可以执行以下步骤，完成下线：

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看应用表列表”进入应用表列表页面，在应用表列表中找到需要下线的已发布应用表，单击“下线”，在弹出对话框中，输入下线原因，选择审核人，单击“确认”，完成下线，待审核人通过审核，下线成功

批量应用表下线

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看应用表列表”进入应用表列表页面，勾选需要下线的应用表，点击“批量下线”
3.	在弹出对话框中，选择审批人和发布原因，单击“确定”，完成下线，待审核通过后，下线成功

删除应用表

对于草稿/已下线状态的应用表，可以执行以下步骤完成删除

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看应用表列表”进入应用表列表页面，在应用表列表中找到需要删除的草稿状态应用表，单击“删除”，在弹出对话框中，单击“确认”，完成删除

查看发布历史

对于已发布的应用表，可以执行以下步骤查看发布历史

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看应用表列表”进入应用表列表页面，在应用表列表中找到需要查看发布历史的应用表，单击“更多-发布历史”，显示发布历史页面
3.	在发布历史页面，可以查看应用表的发布历史，版本对比信息

查看预览SQL

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看应用表列表”进入维度列表页面，在应用表列表中找到需要预览SQL的应用表，单击“更多-预览SQL”，显示SQL对话弹框
3.	在“预览SQL”中，您可以查看SQL语句，也可以复制SQL

导入表

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看应用表列表”进入应用表列表页面，选择导入，下载应用表导入EXCEL模版，填写完成后，进行上传
3.	确认上传后，可以查看导入情况(若表名已在大数据平台存在，则导入失败)

导出表

1.	单击一站式数据开发与管理平台-规范建模，进入规范建模页面
2.	选择“查看应用表列表”进入维度列表页面，选择需要导出的应用表，点击导出，完成下载

## 数据开发

###  产品概述

数据开发（IDE）主张简化线上数据开发、调试难度，具有灵活多元的开发环境、方便快捷的生产部署，丰富直观的数据展示，安全稳定的运行环境等优势。主要功能包括，可支持多人协同开发、多脚本开发（Shell、Python、HiveSQL、Perl、R，其中Shell、Python、HiveSQL支持发布到运维中心）、支持MR，Tez、Presto多种SQL执行引擎、在线调试、查询数据结果可视化、代码版本管理、数据函数管理、一键发布、脚本上传、数据导入、终端访问等。

 应用场景

使用对象：数据分析人员、数仓工程师、建模人员。

支持场景：

1. 在线SQL数据查询、分析；

1. 在线编写数据清洗、加工脚本、调试；

1. 一键发布生产调度；

###  术语定义

| **术语**   | **全称和说明**                                               |
| ---------- | ------------------------------------------------------------ |
| IDE        | 集成开发环境（IDE，Integrated Development Environment ）是用于提供程序开发环境的应用程序，一般包括代码编辑器、编译器、调试器和图形用户界面等工具 |
| Docker容器 | 可理解为虚拟linux系统环境，运行和隔离应用。镜像可以在容器里安装，构成一个虚拟的开发环境 |
| 镜像       | 可理解为虚拟机的镜像，可以理解成ISO等压缩安装文件，可以在虚拟环境上安装你所需要的程序 |
| MR         | 即MapReduce，一种开源并行计算框架                            |
| Presto     | 完全基于内存并行计算，分布式SQL交互查询引擎，查询速度比Hive快5-10倍 |
| Tez        | Tez是Apache构建在Hadoop之上的支持分布式DAG（Directed Acyclic Graph）的计算框架，支持通过复杂的DAG描述并处理大数据任务 |



###  功能列表

| **功能点**    | **功能说明**                                                 |
| :------------ | ------------------------------------------------------------ |
| 项目管理      | 项目的创建、查看。支持在项目中创建目录、脚本                 |
| 脚本开发      | 线上编写脚本代码，支持Shell、Python、HiveSQL、Perl、R脚本的开发 |
| 执行/执行停止 | 脚本开发完成后，本地调试、停止调试                           |
| 脚本管理      | 支持脚本的删除、查看、编辑                                   |
| 发布          | 支持发布HiveSQL、Python、Shell脚本到运维中心，并且可以在运维中心进行查看 |
| 终端          | 支持创建终端方式登录                                         |
| 结果展示      | 支持对调试执行的结果以列表或者图形的方式进行展示             |
| 发布记录      | 支持对发布的任务进行查看                                     |
| 重新发布      | 支持旧的任务版本重新发布，实现线上任务回滚的功能             |
| 对比          | 支持脚本代码的对比                                           |
| 运行记录      | 支持查看运行记录、历史运行结果                               |
| 参数设置      | 支持定义在脚本中使用的参数                                   |
| 表结构        | 支持查询用户有权限的表，通过筛选库、表和字段，支持查看表结构 |
| 转换          | 支持快速生成标准格式的查询和建表语句                         |
| 系统函数      | 支持对Hive系统函数进行查看                                   |
| 自定义函数    | 支持对Hive自定义函数进行管理                                 |
| 文件目录      | 支持文件目录的创建和删除                                     |
| 文件上传      | 支持本地文件上传到指定目录                                   |



###  权限列表

有数据开发模块的使用权限即可，个人管理个人的脚本。

| 功能点             | BDP平台管理员 | BDP开发人员 | BDP运维人员 | BDP资产管理员 |
| ------------------ | ------------- | ----------- | ----------- | ------------- |
| 脚本开发           | ✔️             | ✔️           | ✔️           | ✔️             |
| 创建/删除项目      | ✔️             | ✔️           | ✔️           | ✔️             |
| 表查询             | ✔️             | ✔️           | ✔️           | ✔️             |
| 增删改查自定义函数 | ✔️             | ✔️           | ✔️           | ✔️             |
| 文件上传           | ✔️             | ✔️           | ✔️           | ✔️             |
| 环境配置           | ✔️             | ✔️           | ✔️           | ✔️             |
| 新建脚本           | ✔️             | ✔️           | ✔️           | ✔️             |
| 脚本执行           | ✔️             | ✔️           | ✔️           | ✔️             |
| 脚本发布           | ✔️             | ✔️           | ✔️           | ✔️             |



###  准备工作

 使用权限

需要登录账户有BDP平台管理员、BDP开发人员、BDP运维人员、BDP资产管理员权限。

 资源准备

 数据准备

离线开发任务使用到的Hive数据源表需要先到流程中心中申请库表查询权限，库表权限审批通过后可以在数据开发的表查询中查看库表详情。

 输出表准备

离线开发任务包含HiveSQL分析任务，对于需要将HiveSQL运行结果写入输出表并且发布到调度运行的场景，需要到规范建模中创建输出表。



 流程说明

![](/Users/wangyuxian10/All/helpdoc/di-help-documentation/docs/mdfiles/bdp/img/dadev/main.png)                   

用户需要到流程中心中申请需要用到的库表权限，申请审批通过后可以在离线开发表查询中查看申请的表结构信息。如果是计算任务HiveSQL需要写数据到输出表中，还需要到规范建模中创建输出表。

进入到离线开发页面后，首先需要配置当前的开发环境，之后用户需要创建项目。在指定项目下，用户可以编写脚本、调试脚本、发布脚本、上线脚本。编写脚本的时候可以将需要使用的配置文件上传到文件管理中，方便脚本代码读取，也可以使用自定义的HiveSQL函数支持脚本运算。最后将任务发布到运维中心，并且可以在运维中心对离线开发任务进行管理与运维。

###  快速入门

 配置环境

 前提条件

角色：离线开发用户

前提条件：在流程中心申请过库表的权限，且审批通过。可以在表查询中查看申请通过的库表。

 配置环境

点击环境配置，并且在下拉框中选择环境。

 创建项目

1、创建本地项目

第一步：点击左侧工具栏【工作区】按钮，点击项目管理图标，选择创建项目。

第二步：填写项目名称与项目描述。

2、克隆Git项目

第一步：输入Git路径

第二步：填写项目名称

第三步：填写项目描述


 脚本编写与调试

 编写脚本

第一步：选择项目

第二步：选择脚本，并单击对应的脚本类型

第三步：进入脚本编写页面，编写脚本

 

 调试脚本

第一步：点击右侧工具栏【参数配置】按钮，填写参数，填写完成后点击保存。

 :::warning 注意

SQL任务参数配置不生效。

:::

第二步：点击执行，调试脚本。并可以通过日志、结果来查看脚本执行的过程与结果。

 

 保存脚本

第一步：点击保存，可以将脚本保存起来，方便下次使用。 

第二步：填写保存信息

 

 脚本发布与上线

 前提条件

角色：离线开发用户 

前提条件：输出表已经在数据建模中创建，并且审批通过

 脚本发布

第一步：点击右侧工具栏【调度配置】按钮，并填写调度配置信息。

 :::warning 注意

当前版本只支持Python类型、HiveSql类型、Shell类型的脚本发布到运维中心。Perl、R脚本暂时不开放发布到运维中心功能。

:::



第二步：点击【发布】 按钮，将脚本任务发布到运维中心。

第三步：在弹出的发布框中，填写发布描述，如果是更新任务，需要阅读操作风险，并勾选“我已了解操作风险”，点击确定发布

 发布记录

发布完成后，可以点击发布记录，查看当前脚本的发布相关信息。也可以到运维中心，查看任务的运行情况。



 用户指南

数据开发平台首页分为工作区和新建脚本。                        

 

 工作区

 新建项目

 概述

离线开发所有脚本以项目为单位进行管理

 功能介绍

点击【工作区】的  按钮，选择创建项目。

在创建项目中，选择本地项目后，填写项目名和项目描述，即可完成创建，适用个人本地代码的管理与维护。 

 新建脚本

在工作区左侧的  处下拉选择新建的项目后，在右侧直接点击相应的脚本类型，或者点击  选择脚本类型，打开脚本编辑器窗口后，进行脚本编写和调试。

 脚本保存

点击代码编辑区上部工具栏处的  按钮，填写脚本的文件名称和文件类型，选择相应目录后保存。

 脚本执行和停止

脚本写好后，可以点击【执行】，或者选中脚本片段后，点击【执行选中】。

执行过程中，可以点击【停止】按钮终止运行。

脚本执行后，在日志和结果区，可以查看脚本执行的日志，及运行的查询结果。

点击运行记录，可以查看脚本历史执行记录。

对于hiveSQL脚本类型的执行，可以切换MR、Tez、Presto执行引擎。

 SQL查询结果展示

HiveSQL的查询结果会在日志区弹出“结果”页签，可以选择以列表或者图形方式展示。

查询结果限制为1000条，可以选择展示的列。

图表：目前支持图表的类型有柱状图、折线图、饼状图三种。前端显示条数同列表。

 发布

数据开发平台与运维中心打通，将写好的数据开发脚本发布到运维中心。目前有Python类型脚本、Shell脚本、HiveSql脚本支持发布到运维中心。

点击调度配置，调度配置主要功能是填写发布的相关信息，包括基本信息、运行逻辑及定义、运行规则。

1、 基本信息

发布类型：新建任务和更新任务，默认给出。如果当前脚本在运维中心有对应的任务，则为更新任务，否则属于新建任务

项目空间：选择输出表名中对应的项目空间

输出表名：选择输出表，输出表目前只支持选择一个。表的来源是规范建模，且当前账号必须在规范建模中对输出表有使用权限。

负责人：默认创建脚本的用户为任务负责人

任务名称：填写任务名称。如果是更新任务，任务名称不支持变更；如果是新建任务，任务名称支持自动生成与手动填写。

任务描述：对任务进行描述

2、 运行逻辑及定义

脚本类型：选择对应的脚本类型，只有Python类型需要选择，HiveSql与Shell脚本类型会默认提供。

运行引擎：如果脚本是类型是HiveSQL的时候，支持选择运行引擎。运行引擎包括Tez和MR，默认选择Tez。当运行引擎选择Tez时，首先会使用Tez运行，如果运行失败的话，会默认切换到MR。

校验：校验按钮，需要发布的脚本必须校验。

依赖任务：当前任务需要依赖的父任务。输入任务关键字，在下拉列表中选择依赖的任务。对于依赖的父任务，提供强依赖、弱依赖、是否并行选项来配置与父任务的依赖关系。默认强依赖，非并行。

 :::warning 注意

依赖父任务可以选择不是自己负责的任务。

:::



3、 运行规则

1） 任务类型：支持触发、定时、一次任务、手动任务类型。触发任务：上游任务结束触发方式，配置运行频率，父任务执行完成后，触发当前任务执行；定时任务：周期运行，配置运行频率与开始时间，按照配置的频率与时间周期运行；一次任务：只运行一次，配置开始日期与开始时间，按照配置的日期与时间；手动任务：手动触发

2） 预警方式：支持短信、邮件、电话预警

3） 失败后是否重试：“是”表示失败后会重试，默认重试次数是3次。重试次数配置可以在【运维中心】->【高级配置】中修改

4） 预警时机：

最终失败：任务最终执行失败发送预警

每次失败：任务每次执行失败发送预警

成功完成：任务成功完成发送预警

启动延迟监控：需要配置时间，任务如果在配置的时间前没有启动，则发送预警

结束延迟监控：需要配置时间，任务如果在配置的时间没有运行结束，则发送预警

 :::warning 注意

定时触发和依赖触发支持小时分钟级调度。且小时分钟级调度要求整条链路的任务有相同的运行规则。

:::



 发布记录

点击发布记录，可以看到看看发布的任务。

 重新发布

对在运维中心发布过的旧版本可以进行重新发布。重新发布相当于生产环境部署包回滚的功能。如果运维中心中有对应的任务，会对运维中心的任务进行覆盖；如果没有，会重新发布一个版本。

 查看

点击查看，可以查看发布版本对应的发布信息与脚本。

 对比

点击对比，提供脚本代码对比功能。右侧固定为当前版本，左侧代码版本可选。支持不同步版本的对比、或者本地代码与不同版本的代码对比。

 终端

点击  ，弹出终端访问页面。列表显示有权限的访问的集群，双击可以打开终端访问。每个集群目前只支持最多开两个窗口。

注：如果之前使用终端没有关闭，长时间不用，token失效再次登录，有可能第一次打开窗口会报错，只要重新打开一个新的就可以。

 表查询

 表查询

可以查询用户有查询select权限的表，通过选择集群、选择库、表，支持到字段的查询。点击复制可以复制表名。如果没有权限可以到资源管理给相应的库表赋权。

 转换

可以支持快速生成标准格式的查询和建表语句。通过【表查询】得到的字段列表，勾选，转化生成所需要的查询或建表语句。



 函数管理

 系统函数

Hive自带的系统函数，可以双击函数展示函数信息

 自定义函数

  点击新建自定义函数  图标，填写自定义函数基本信息，并上传函数jar包

 文件管理

 文件目录

点击创建按钮  ，创建文件管理目录，默认根目录是在/soft/data下，不同集群的文件目录不互通。

 文件上传

点击  ，选择本地文件上传，目前没有文件类型限制，可以支持多文件上传，单个文件的大小500M以内。上传列表最小化后，可以在右下角找到

 环境配置

系统默认提供基础镜像文件，可以供用户选择。

**用户第一次使用平台执行脚本时，需要设置环境配置，之后便保留之前应用的环境配置**。

## 运维中心

### 产品概述

运维中心是平台的所有离线任务管理和调度中心。平台所有任务包括集成任务、计算任务、质量任务都会在这里展示，各种任务通过调度引擎生成相应数据处理任务的调度服务。任务支持依赖触发式、手动运行、一次性及定时触发方式，可根据业务需求配置不同运行频率及其他规则。调度系统有智能的监控预警系统，可为任务不同级别、类型任务的不同场景设置电话、短信和邮件等不同形式的报警，实现运维报警的自动化，运维及业务相关人员可实时监控到任务异常。全部任务对所有用户开放，随时可查看每个任务的运行情况，实时了解数据流转进度。

### 应用场景

1. 业务数据化

   可以提升对业务数据的分析能力并进行有效监控，更好地业务赋能。

2. 快速响应业务需求。

   可以根据新业务的数据分析需求，快速灵活地进行响应与满足。

### 术语定义

| **术语** | **全称和说明**             |
| -------- | -------------------------- |
| 任务     | 任务也称为任务             |
| 实例     | 任务每运行一次生成一个实例 |

### 功能列表

| **功能点**       | **说明**                                                     |
| :--------------- | ------------------------------------------------------------ |
| **任务查询**     | 可按照任务名称、任务类型、负责人、所属项目、所属集群、任务状态、数据日期、任务创建时间、任务修改时间、任务执行时间、运行状态进行搜索查询 |
| **上下线**       | 批量或单独选择任务，操作上下线，任务上线填写依赖任务和上线原因；任务下线填写下线原因。目前只有数据来源为：数据开发平台的任务才能上下线 |
| **终止**         | 运行中的任务终止                                             |
| **记录**         | 单个任务对应的运行记录跳转查看                               |
| **编辑**         | 任务基本信息、运行逻辑定义、运行规则编辑                     |
| **重跑**         | 批量或单独选择任务，选择重跑日期，提交重跑                   |
| **重置**         | 批量或单独选择任务，选择重置日期，提交重置                   |
| **仓库重建**     | 按照基本信息、处理逻辑、字段映射进行仓库重建                 |
| **批量补数**     | 批量补数包含链路补数或批量补数，链路补数选择节点任务、补数开始日期、补数结束日期；批量补数选择多项任务、补数开始日期、补数结束日期，提交补数 |
| **补数**         | 选择单个任务，选择补数开始日期、补数结束日期，提交补数       |
| **新增字段**     | 通过新增字段进行结构变更                                     |
| **基本信息**     | 任务名称、负责人、任务描述                                   |
| **任务属性**     | 任务基本信息、运行规则、监控信息展示，可点击修改             |
| **运行信息**     | 运行信息查看，可查看单个运行信息的日志                       |
| **任务关系**     | 展示其父任务、子任务及任务依赖图                             |
| **操作日志**     | 展示操作人、操作类型、操作日期、备注                         |
| **高级编辑**     | 任务优先级、任务超时时间、重试次数、间隔/秒、是否可以再跑、是否可以跨周期跑、是否可以上下游并、是否级联触发、命名空间、服务器资源消耗值、需要的运行环境、指定服务器、失效时间的编辑设定 |
| **运行记录查看** | 任务每运行一次会生成一条运行记录                             |
| **日志**         | 查看单个任务某一天的日志                                     |
| **重跑**         | 对单个任务的某一天进行重跑                                   |
| **终止**         | 终止在某一天的单个任务                                       |
| **重置**         | 重置在某一天的单个任务                                       |
| **补数任务查询** | 可以按照任务名称、任务类型、所属项目、所属集群、任务状态、补录状态、补录时间、创建时间、负责人搜索查询 |
| **查看记录**     | 查看部署记录，包含任务名称、数据时间、任务状态、执行开始时间、执行结束时间 |
| **停止补数**     | 停止补数                                                     |

### 权限列表

| 功能点       | BDP平台管理员 | BDP运维人员 | BDP开发人员 | BDP资产管理员 |
| ------------ | ------------- | ----------- | ----------- | ------------- |
| 终止         | ✔️             | ✔️           | ✔️           | ✔️             |
| 重置         | ✔️             | ✔️           | ✔️           | ✔️             |
| 编辑         | ✔️             | ✔️           | ✔️           | ✔️             |
| 补数         | ✔️             | ✔️           | ✔️           | ✔️             |
| 导出/导入    | ✔️             | ✔️           | ✔️           | ✔️             |
| 高级编辑     | ✔️             | ✔️           |             |               |
| 删除         | ✔️             | ✔️           |             |               |
| 重跑         | ✔️             | ✔️           | ✔️           | ✔️             |
| 任务详情查看 | ✔️             | ✔️           | ✔️           | ✔️             |

:::tip 备注

1. 编辑、导出/导入、删除功能目前只有开发任务可以在运维中心进行操作，其他任务类型需要到源端进行操作
2. BDP开发人员、BDP资产管理员只对自己负责的任务有终止、重置、编辑、补数、导出/导入、重跑功能的操作权限

:::

### 流程说明

![img](file:///Users/wangyuxian10/All/helpdoc/di-help-documentation/docs/mdfiles/bdp/img/operationcenter/1.png?lastModify=1678785296)

### 快速入门

1. 用户需要在各自平台上创建调度任务。比如：创建计算任务，用户先到IDE平台创建并发布任务。目前运维中心支持的调度任务类型有：数据计算任务、数据集成任务、数据质量任务。
2. 平台支持对任务进行手动运维。提供部署、重跑、重置、上下线等功能，方便用户对任务进行操作。
3. 任务发布并且上线到运维中心后，调度会根据设置的运行规则来周期调度任务，同时提供日志、运行状态展示、上下游任务依赖展示、预警等功能实现对任务多维度的监控。



### 用户指南

#### 任务列表

功能介绍

功能说明**：**在任务列表中可以查看到任务的各项基本信息，任务属性、运行信息、任务关系、操作日志等

#### 操作步骤

(1)任务查询

•   依次点击【任务管理】→【任务中心】菜单，展示任务查询列表页面

•   用户可输入查询条件执行查询筛选，如下图;

(2) 任务基本信息查看

•   点击任务名称，进入任务基本信息页， 

(3)任务属性查看

•   点击【任务属性】，展示关于任务的基本信息、运行规则、监控信息等， 

(4)运行信息查看

•   点击【运行信息】，跳转到运行信息页面，

(5)任务关系查看

点击任务节点，右侧展示任务节点相关信息，并且对于有权限的任务提供重跑、重置、详情按钮。

•   点击【任务关系列表】，展示其父任务、子任务及任务依赖   

(6)操作日志查看

•   点击【操作日志】，展示操作人、操作类型、操作日期、备注等信息， 

(7)任务下线

•   点击【任务中心】→【任务列表】，选择需要下线的任务，点击【下线】按钮，

•   填写下线原因，点击【提交】，系统提示下线成功。

下线状态的任务不会再运行，可以再点击上线使任务正常运行。

注意：只有数据来源为数据开发的任务才能上下线。

(8)任务重跑

•   选择需要下线的任务，点击【重跑】按钮，选择重跑日期，勾选【已了解操作风险】，点击提交，

​    重跑会让任务重新运行一遍。

(9)任务重置

•   选择需要重置的任务，点击【重置】按钮， 选择重置日期，勾选【已了解操作风险】，点击提交，

重置只会改变任务的运行状态，不会重新运行任务。

(10)终止

•   点击【更多】->【终止】按钮，

终止会停止正在运行的任务。

(11)编辑

•   点击【更多】->【编辑】按钮，

注意：目前只有数据来源为数据开发的任务，才能编辑。任务来源为数据集成的任务可以在源端进行编辑。

编辑内容主要分为三部分：

1、基本信息

依赖触发：父依赖触发方式，父依赖任务运行完成后，自动触发当前任务运行。

定时触发：按照设定的时间周期调度运行。

条件触发：数据触发方式，当需要的数据到达后，触发调度任务。

一次任务：只运行一次，按照配置的时间只运行一次。

手动任务：手动触发执行。

2、运行逻辑定义

3、运行规则

最终失败：重试多次，全部失败，发预警

每次失败：重试多次，每次失败，都发预警

成功监控：运行成功，发预警

延迟启动监控：设置时间内未启动，发预警

延迟结束监控：设置时间内运行未结束，发预警

 

(12)高级编辑

•   点击【更多】->【高级编辑】按钮，

注意：只有系统管理员和运维人员有任务的高级编辑权限。

高级配置项相关说明：

**级联**：建立在 任务在当前日期已经成功运行过一次的情况下

- 单分支随机级联：当前任务只要有一个父任务执行成功，当前任务对应的数据日期的实例就会被触发执行
- 多分支同态级联：当前任务上游所有的父任务必须都执行成功，且上游成功次数项目，当前任务对应的数据日期实例才会被触发执行。

**是否可以上下游并行**：开启此项配置后，如果上游运行中，当前任务仍然可以运行。

**是否可以跨周期跑**：任务是否可以跨越运行周期执行。例如1号运行成功，2/3号pending，4号的任务是否可以执行。若可以执行，2/3号任务状态为clean

**服务器资源消耗值**：任务占用的服务器资源大小，默认10。例如：单个服务器资源为100，即一个服务器最多可同时分配10个任务。建议使用默认值，不推荐修改。

**指定服务器**：选择任务执行的worker节点，建议使用默认值，不推荐修改。



(13) 补数

•   点击【更多】->【补数】按钮，弹出批量补数对话框

  导出

•   点击【更多】->【导出】按钮，弹出批量补数对话框

注意：只有数据开发任务才有导出功能。

（14）删除

注意：目前只有运维人员与系统管理员有删除任务的权限，开发任务无删除权限，开发人员看不到删除按钮。

（14）导入任务                             

导入任务：支持数据开发IDE平台创建的任务的导入，只支持单个任务的导入。一般适用于平台间的任务迁移。

导入格式：zip包格式，zip包中包含 jobFile 和 scriptFile。



#### 运行记录

功能介绍

功能说明**：**运行记录记录了任务的运行状态、耗时、任务开始结束时间和任务上下线状态等；任务每运行一次生成一个任务实例。

操作步骤

(1)运行记录查看

•   依次点击【任务中心】→【运行记录】，输入任务名称，点击【搜索】，展示任务的运行信息，

•   或者在任务列表页面，选择任务，点击右侧的【记录】按钮，跳转至运行记录页面

(2) 任务运行状态

•   点击运行状态下拉选框，选择要接入该业务系统的运行状态

准备中：任务满足运行条件，等待提交集群处（计算任务）或者调度客户端（抽取、推送、同步任务）运行。满足条件包括上下游条件，任务前一周期条件等。

运行中：任务满足条件开始运行，计算任务为已提交至集群处运行，抽取、推送、同步任务为提交至调度客户端运行。

完成：任务运行完成，且成功。

失败 : 任务运行完成，但运行失败。

(3) 日志查看

•   选择要查看的任务，点击右侧的【日志】按钮。 



#### 补数跟踪

功能介绍

功能说明**：**补数跟踪主要对每个任务的补数情况做记录和跟踪，可查看补数运行日志，对于每条补数跟踪记录可进行停止操作。

操作步骤

(1) 补数查询

•   依次点击【任务中心】→【补数跟踪】菜单，

•   用户可输入查询条件执行查询筛选，如下图; 

(2) 记录查看

•   选择查看的任务，点击右侧的【查看记录】按钮，弹出补数记录对话框，

(3) 停止补数

•   选择要停止的任务，点击右侧的【停止】按钮，弹出确认对话框，

•   点击【提交】按钮，系统提示停止成功 

#### 运维大屏

点击运维总览，展示运维大屏，点击实例总数、成功实例、失败实例等可以直接跳转到对应任务。

### 附录

实例生命周期

:::tip 说明

凌晨创建实例并初始化 → Pending → Ready → Running → Done(Failed)。

:::

Pending：任务运行前原始状态。（每天凌晨后台进程会实例化所有的非手工触发的调度任务）

Ready：任务满足运行条件，等待提交集群处（计算作业）或者调度客户端（抽取、推送、同步任务）运行。满足条件包括上下游条件，任务前一周期条件等。

Running：任务满足条件开始运行，计算任务为已提交至集群处运行，抽取、推送、同步任务为提交至调度客户端运行。

Done：任务运行完成，且成功。

Failed：任务运行完成，但运行失败。

Clean：清除状态，任务开始计划要执行，后因特殊情况不执行了。

实例运行周期

分钟任务：按照配置的开始时间、结束时间、时间间隔（分钟）进行任务调度，目前支持的时间间隔（分钟）有15分钟、30分钟。

小时任务：按照配置的开始时间、结束时间、时间间隔（小时）进行任务调度

日任务：每天需要运行。

周任务：一周运行一次，支持指定周几，报表作业使用较多。

月任务：一个月运行一次，常见如月末、月初或指定日期。

一次性任务：创建之后只会运行一次，运行完成之后当天晚上就会被系统自动下线。

手动任务：创建完成后需要手动触发任务。

## 数据图谱

### 产品概述

由传统“元数据管理系统”的基础上，进化为全域场景下的**数据知识共享与协作平台**，全面提升知识服务能力，促进数据资产的开放和高效使用，充分发挥数据资产价值。

### 术语定义

| **序号** | **术语** | **全称和说明**                                               |
| -------- | -------- | ------------------------------------------------------------ |
| 1        | 链路追溯 | 展示表所关联任务的链路，方便用户快速了解表与任务的关联关系。 |
| 2        | 血缘关系 | 展示表与表之间的关系、表间字段与字段的关系。                 |
| 3        | 数据流向 | 展示表间的数据流转以及数据流转的方向，数据流向在本产品中表示通过数据集成入仓动作业务系统表采集到数仓的数据表关系以及数据流转方向。 |

### 功能列表

| **功能菜单**   | **功能点**       | **功能说明**                                                 |
| -------------- | ---------------- | ------------------------------------------------------------ |
| 搜索           | 搜索模式         | 分词检索、模糊匹配                                           |
|                | 高级过滤器       | 支持按照支持排序、相关度热度、分类、层次、标签、集群负责人多维度进行信息过滤 |
|                |                  | 支持按照模型名称、字段、数据源表进行检索                     |
| 元数据采集任务 | 任务多条件检索   | 支持通过数据源类型、采集渠道、运行状态、提交人、时间、采集方式、采集任务名称等信息检索 |
|                | 采集列表页       | 采集任务管理，支持采集任务运行状态等基本信息查看             |
|                | 新建采集任务     | 支持离线元数据采集，数据源类型MYSQL                          |
|                |                  | 支持按照小时频率进行定期调度                                 |
|                |                  | 支持手工excel手工导入元数据                                  |
|                |                  | 支持任务失败重试策略                                         |
|                |                  | 支持任务提交、取消                                           |
|                | 删除采集任务     | 支持运行状态为成功和失败状态下的任务删除操作                 |
|                | 编辑采集任务     | 支持运行状态为成功和失败状态下的任务编辑操作                 |
|                | 手动运行         | 支持任务的手动运行操作，运行中不允许立即运行                 |
|                | 监控             | 支持监控记录管理                                             |
|                | 日志             | 支持日志查看                                                 |
|                | 采集统计         | 支持按照表、字段等维度进行新增、删除、修改字段的统计         |
|                | 快速创建采集任务 | 通过数据源管理页面进行同步元数据采集                         |
| 血缘导入任务   | 任务多条件检索   | 支持通过任务名称、运行状态、提交人等信息进行检索             |
|                | 导入任务列表     | 导入任务管理，支持导入任务运行状态等基本信息查看             |
|                | 导入血缘         | 支持跨库的血缘导入操作                                       |
|                | 日志             | 日志                                                         |
|                | 下载             | 下载                                                         |
| 元模型管理     | 元模型检索       | 支持按照数据源类型、上线状态、属性名称进行检索               |
|                | 元模型列表       | 模型列表管理                                                 |
|                | 新建属性         | 支持属性名称、交互样式、是否显示等信息新建                   |
|                | 删除属性         | 支持下线和草稿属性进行删除操作                               |
|                | 上线             | 支持对属性进行上线操作，上线后可同步到数据图谱展现中         |
|                | 下线             | 支持已上线属性进行下线操作，下线后该属性将不再数据图谱中进行采集 |
|                | 编辑             | 支持草稿和下线的属性进行编辑操作                             |
| 元数据检索     | 数据模型         | 支持业务元数据、管理元数据、技术元数据的查看。               |
|                |                  | 链路追溯，支持表级别链路分析，且支持入仓、出仓、指标接口数据的链路碰撞的展示。 |
|                |                  | 血缘关系，支持字段级别血缘分析                               |
|                |                  | 数据权限，支持数据权限信息查看/导出                          |
|                |                  | 数据预览，支持数据预览/导出                                  |
|                | 应用系统         | 支持MySQL、Oracle、SqlSever、MongoDB、Hbase元数据采集和查看  |
|                | 数据百科         | 数据百科查看                                                 |
|                |                  | 词根配置                                                     |
|                | 指标             | 支持指标管理平台指标信息的展示                               |
|                | 接口             | 支持数据服务平台接口信息的展示                               |



### 权限列表

平台所有用户拥有元数据检索权限，后台管理功能系统初始化会支持资产管理员进行管理，同时支持用户通过角色授权进行后台操作权限的控制。

| **模块**       | **权限点**                                      | **BDP平台管理员** | **BDP资产管理员** | BDP开发人员 | BDP运维人员 |
| -------------- | ----------------------------------------------- | ----------------- | ----------------- | ----------- | ----------- |
| 元数据检索     | 元数据检索                                      | ✔️                 | ✔️                 | ✔️           |             |
|                | 元数据编辑                                      | ✔️                 | ✔️                 |             |             |
| 元数据采集任务 | 查看采集任务（监控+查看）                       | ✔️                 | ✔️                 |             |             |
|                | 操作按钮（新建、编辑、删除、上线/下线、手动运行 | ✔️                 | ✔️                 |             |             |
| 血缘导入任务   | 血缘任务查看                                    | ✔️                 | ✔️                 |             |             |
|                | 操作按钮（导入血缘、下载、取消）                | ✔️                 | ✔️                 |             |             |
| 元模型管理     | 元模型查看                                      | ✔️                 | ✔️                 |             |             |
|                | 操作按钮（新建属性、上线、下线、删除、编辑）    | ✔️                 | ✔️                 |             |             |
| 数据百科       | 数据百科查看                                    | ✔️                 | ✔️                 |             |             |
|                | 操作按钮（创建、编辑、删除）                    | ✔️                 | ✔️                 |             |             |


### 用户指南

**数据图谱检索**

平台提供元数据采集、存储、查询及元数据应用等多种元数据管理工具，支持数据模型、模型字段、应用系统、数据百科、指标、接口类型的元数据检索，元数据支持多维度检索，包括标签、表名、字段名、业务分类、所属层次、负责人等多种方式，检索内容包括数据模型、数据源。

整体页面分为两大大部分：筛选区、列表区。

筛选区用于提供元数据的业务分类、所属层次、高级标签、所在集群、检索模式、检索范围、负责人检索能力。

**数据模型查询**

点击【数据图谱】菜单，显示检索首页，如下图：
用户可通过数据需要检索的关键词信息进行元数据检索，同时可根据检索数据类型进行数据的分类检索，支持的分类类型包括数据模型、应用系统、数据百科、指标、接口。
点击【搜索】，显示搜索结果列表，如下图：




**数据模型：**

点击【数据模型】，选择业务分类进行筛选，缩小查找范围，列表展示查询结果
输入表的中文名、英文名和业务描述进行模糊匹配搜索
元数据基本信息查看：
详情页面，包括Hive元数据字段信息、分区信息、链路追溯、血缘关系、数据权限、数据预览、基本信息、业务信息、物理信息。
字段信息页面，可查看Hive类型表字段信息,包括字段名称、中文描述、字段类型、枚举值、备注。
点击【查看DDL语句】，弹窗DDL语句页面，同时支持点击【复制】进行语句复制。
点击【select语句】，弹窗select语句页面，同时支持点击【复制】进行语句复制。
点击【分区信息】切页，展示该表分区信息。
点击【链路追溯】切页，支持表和任务关系的链路展示，且通过应用系统、入仓、出仓、仓内数据进行数据碰撞后，展示全域链路。
点击【血缘关系】切页，显示表的上游、下游快速查看表的依赖关系。包括表级和字段级
点击【数据权限】切页，展示该表下所有用户权限信息。
点击【数据预览】切页，展示该表的预览数据。
点击【申请权限】,弹窗展示表权限申请页，用户可进行表权限申请操作。
BDP平台管理员、BDP资产管理员、表负责人支持对表信息进行编辑，点击【编辑】，弹窗展示编辑页面。

**应用系统**

点击【应用系统】，可通过业务线、数据源类型、标签等筛选条件进行元数据信息的定位。如下图为通过筛选条件定位到的元数据列表。
点击“表名称”，跳转到选中表详情页面，页面详情包括：字段信息、血缘关系、数据流向、基本信息、业务信息、物理信息。
点击【字段信息】，展示该表的字段信息
点击【血缘关系】，展示该表的表级血缘和字段血缘，应用系统内表的血缘关系需通过手动导入方式维护。目前支持应用系统中MYSQL、sqlsever、oracle类型血缘关系的展示。
点击【数据流向】，展示该表与仓内表的数据流向，目前数据流向仅展示应用系统、缓冲层、明细层、汇总层三层的数据流向关系。

**指标**

点击【指标】，可通过业务分类、计算类型、指标属性等筛选条件进行指标信息的定位。如下图为通过筛选条件定位到的指标列表。
点击“指标名称”，跳转到指标详情页，指标详情信息包括指标信息、衍生信息、链路追溯，点击【指标信息】。
点击【衍生信息】。
点击【链路追溯】，展示该指标与仓内表的链路关系。


**接口**

点击【接口】，可通过接口分类、标签等筛选条件进行接口信息的定位。如下图为通过筛选条件定位到的接口列表。
点击“接口名称”，跳转到接口详情，接口详情包括基本信息、接口参数、血缘关系、链路追溯，点击【基本信息】，展示信息如下图：
点击【接口参数】，展示接口的入参和出参信息。
点击【血缘关系】，展示接口和表的关系，左击表名称或者接口名称，可展示表和接口详情信息。
点击【申请权限】，若该用户有【数据服务平台-API市场】访问权限，可跳转到【API市场】，并定位到当前权限申请的API，用户可【API市场】进行申请使用的操作。

**运营后台-数据图谱配置**

数据图谱配置后台用于管理数据图谱采集任务、元模型、数据百科的配置工作。

**元数据采集任务**

用户通过元数据采集任务模块，可完成MySQL、Oracle、SqlSever、MongoDB、Hbase离线数据的元数据周期性采集工作，支持手工EXCEL导入和周期性调度采集。同时可采集任务进行监控以及采集结果的统计工作。

注：mysql采集是需要开放以下表权限

 点击【开发平台】-【运营后台】-【数据图谱配置】-【元数据采集任务】，可查看元数据采集任务列表。
目前元数据采集可通过数据源管理中自动创建，也可以通过元数据采集任务进行手动创建。

**自动创建**

点击【新建数据源】，进行数据源创建，在高级设置中可进行元数据采集自动配置。元数据采集自动生成采集任务。当数据源管理删除时，元数据采集任务也会一并删除。

**手动创建**

点击【新建采集任务】，可对元数据采集任务进行配置工作。

包括基本信息：

1、 任务名称，采集任务名称，需用户自定义。

2、 任务描述，用于描述任务基本信息，方便任务的记录。

3、 负责人，该任务的负责人，默认创建任务的用户为负责人，可根据实际业务需求进行更换，可对任务进行管理。

元数据采集信息：

1、 所属业务线，通过业务线进行数据源筛选。

2、 数据源类型，选择需要采集的数据源类型。

3、 数据源，支持选择【数据集成】-【数据源管理】中数据源。若当前缺少需要采集得数据源，可通过点击【数据源创建】进行快速创建。

4、 采集方式，采集方式支持自动采集、手工导入，默认为自动采集，当选择为自动采集时，需用户配置离线采集频率等信息。若选择为手工导入，用户需按照模板格式要求进行元数据采集数据进行导入。目前采集策略为全量采集。

5、 采集频率，支持1小时、3小时、6小时、9小时、12小时、15小时、18小时、21小时、24小时。

6、 是否进行重试，当任务采集失败后若进行重试，需选择重试次数。

点击【保存】，创建完成元数据采集任务，可在任务列表中查看。

点击操作中的【上线】。采集任务将按照采集策略定期采集，当点击【下线】，采集任务将停止周期性运行。当点击【删除】时，可将该采集任务从列表中删除。

点击【手动运行】，可对列表中的采集任务进行手动立即运行操作。

点击【监控】，可查看运行实例，以及实例运行状态等信息的展现，同时可查看实例的运行日志以及采集统计信息。

**血缘导入任务**

支持应用系统中MYSQL、sqlsever、oracle类型血缘关系的导入。

点击【开发平台】-【运营后台】-【数据图谱配置】-【血缘导入任务】，可查看血缘导入任务列表以及进行血缘导入相关操作。
点击【导入血缘】，弹出血缘导入框，用户可通过点击【下载模板】进行模板下载，需按照模板格式进行数据填写。
血缘数据导入为更新追加模式。 
点击【日志】可查看运行具体情况。 

点击【下载】，可将上传模板进行下载。

**元模型管理**

元模型管理根据不同数据库类型进行元模型维护，以满足不同数据库类型存储的差异性问题。目前支持自定义的数据源类型包括MYsql、Oracle、sqlserver、Hbase、MongoDB。

点击【新建属性】，弹窗划出新建属性页面，用户可选择需要增加属性的数据源类型，其次对属性展示的样式进行规范。
点击【保存】后，属性新增成功，可对属性进行编辑、删除、上线操作。
点击【上线】，新增属性会在前台检索页面进行展示。

**数据百科配置**

旨在解决找模型难，理解模型难的问题，通过描述数据架构及模型定义的百科文档，帮助用户快速定位，找到符合业务需求和使用视角的统一数据模型，实现公司内部数据模型的开放共享和高效使用，充分发挥数据资产价值。

**词条管理**

词条管理用于管理百科词条中的内容。
点击【词条管理】，可看到词条管理列表，用户管理词条的启用状态、新建、编辑、删除等操作。
点击【新建】后，弹窗展示新建词条详情页面，用户可对百科详情和模型图谱进行配置。
百科详情支持词条介绍富文本操作，以及支持上传附件。
模型图谱配置，用户可在明细层、汇总层、维度层进行模型的增加，支持节点的操作以及模型的挂载，模型可选择数据模型中的实体进行挂载。

**标签管理**

 标签管理用户支撑词条管理中对模型的打标。
点击【新建】，弹窗展示新建标签页面，用户填写标签名称、标签描述，点击【确认】，完成标签新建操作。



## 数据标准

---

### 产品概述

建立统一的数据标准体系，结合数据标准提供对数据进行仓库建设、数据检查、数据处理能力。 

### 术语定义

| **序号** | **术语** | **全称和说明**                                           |
| -------- | -------- | -------------------------------------------------------- |
| 1        | 数据标准 | 指保障数据的内外部使用和交换的一致性和准确性的规范性约束 |
| 2        | 标准词根 | 行业术语或者专有名词，用于表和字段等标准化命名。         |
| 3        | 数据元   | 定义为用一组属性描述定义、标识、表示和允许值的数据单元   |

### 功能列表

| 功能菜单       | 功能点        | 功能说明                                                     |
| -------------- | ------------- | ------------------------------------------------------------ |
| 标准词根       | 词根检索      | 支持编码/英文名/英文缩写/近义词/创建人等关键词进行检索。     |
|                | 分类管理      | 支持分类的增删改查                                           |
|                | 词根列表      | 列表详情包括词根编码、英文名称、中文名称、英文简称、词根分类、近义词、词根描述、创建人、创建时间、更新人、更新时间。 |
|                | 详情查看      | 支持词根信息只读查看；支持操作记录查看，包括操作记录的多条件检索、操作类型、操作内容、操作人、操作时间、申请原因的记录。 |
|                | 词根编辑      | 支持除编码外其他信息的编辑操作。                             |
|                | 移动          | 支持词根分类间移动。                                         |
|                | 删除          | 支持词根的删除。                                             |
|                | 新建          | 支持词根新建，包括词根编码、中文名称、英文名称、词根分类、英文缩写、近义词、词根描述。 |
|                | 导入/导出     | 支持导入模板下载，支持数据更新/不更新策略，支持导入时数据的预览 |
|                | 发布/批量发布 | 支持标准词根发布操作。                                       |
|                | 发布/批量下线 | 支持标准词根下线操作。                                       |
| 业务术语       | 业务术语检索  | 支持编码/英文名/英文缩写/创建人等关键词进行检索。            |
|                | 分类管理      | 支持分类的增删改查                                           |
|                | 业务术语列表  | 列表详情包括编码、英文名称、中文名称、英文简称、业务分类、业务描述、创建人、创建时间、更新人、更新时间。 |
|                | 详情查看      | 支持信息只读查看；支持操作记录查看，包括操作记录的多条件检索、操作类型、操作内容、操作人、操作时间、申请原因的记录。 |
|                | 编辑          | 支持除编码外其他信息的编辑操作。                             |
|                | 移动          | 支持分类间移动。                                             |
|                | 删除          | 支持标准的删除。                                             |
|                | 新建          | 新建内容包括编码、中文名称、英文名称、业务分类、英文缩写、业务描述。 |
|                | 导入/导出     | 支持导入模板下载，支持数据更新/不更新策略，支持导入时数据的预览 |
| 标准码值       | 码值检索      | 支持编码/名称/内容/创建人等关键词进行检索。                  |
|                | 分类管理      | 支持分类的增删改查                                           |
|                | 码值列表      | 列表详情包括编码、标准名称、码值内容、码值分类、创建人、创建时间、更新人、更新时间。 |
|                | 详情查看      | 支持信息只读查看；支持操作记录查看，包括操作记录的多条件检索、操作类型、操作内容、操作人、操作时间、申请原因的记录。 |
|                | 编辑          | 支持除编码外其他信息的编辑操作。                             |
|                | 移动          | 支持分类间移动。                                             |
|                | 删除          | 支持标准的删除。                                             |
|                | 新建          | 新建内容包括编码、标准名称、标准分类、标准码值。             |
|                | 导入/导出     | 支持导入模板下载，支持数据更新/不更新策略，支持导入时数据的预览 |
|                | 发布/批量发布 | 支持标准码值发布操作。                                       |
|                | 发布/批量下线 | 支持标准码值下线操作。                                       |
| 数据元标准     | 数据元检索    | 支持多条件检索。                                             |
|                | 分类管理      | 支持分类的增删改查                                           |
|                | 数据元列表    | 列表详情包括编码、流程状态、标准状态、英文名称、中文名称、英文简称、近义词、创建人、创建时间、更新人、更新时间。 |
|                | 详情查看      | 支持信息只读查看；支持操作记录查看，包括操作记录的多条件检索、操作类型、操作内容、操作人、操作时间、申请原因的记录。 |
|                | 更新          | 支持除编码外其他信息的编辑操作。                             |
|                | 移动          | 支持分类间移动。                                             |
|                | 删除          | 支持标准的删除。                                             |
|                | 新建          | 新建内容包括基本信息、标准存储、标准限定等信息。             |
|                | 导入/导出     | 支持导入模板下载，支持数据更新/不更新策略，支持导入时数据的预览 |
|                | 发布/批量发布 | 支持数据元标准发布操作。                                     |
|                | 发布/批量下线 | 支持数据元标准下线操作。                                     |
| 标准文档管理   | 文档检索      | 支持文档名称/描述关键词进行检索。                            |
|                | 分类管理      | 支持分类的增删改查                                           |
|                | 文档列表      | 列表详情包括文档名称、文档描述、文档分类、创建人、创建时间、更新人、更新时间。 |
|                | 详情查看      | 支持信息只读查看。                                           |
|                | 编辑          | 支持信息的编辑操作。                                         |
|                | 移动          | 支持分类间移动。                                             |
|                | 删除          | 支持标准的删除。                                             |
| 数据元属性管理 | 分类管理      | 支持分类的增删改查                                           |
|                | 列表          | 列表详情包括属性编码、属性名称、属性类型、字段类型、字段长度、是否允许为空、交互形式、提示信息、下拉选择方式、枚举信息。 |
|                | 编辑          | 支持信息的编辑操作。                                         |
|                | 删除          | 支持标准的删除。                                             |

### 权限列表

| **<div style="width: 80pt">模块</div>** | 功能说明                                                     | BDP平台管理员 | BDP数据架构师 | BDP开发人员 | BDP运维人员 | BDP资产管理员 |
| --------------------------------------- | ------------------------------------------------------------ | ------------- | ------------- | ----------- | ----------- | ------------- |
| 词根管理                                | 对系统中使用到的词根进行管理（新建/编辑/导入/导出/发布/下线/删除） | ✔️             | ✔️             |             |             | ✔️             |
|                                         | 对系统中使用的词根进行查看                                   |               |               | ✔️           | ✔️           |               |
| 业务术语                                | 对系统中需要达成业务一致的术语进行统一管理（新建/编辑/导入/导出/发布/下线/删除） | ✔️             | ✔️             |             |             | ✔️             |
|                                         | 对系统中使用的业务术语进行查看                               |               |               | ✔️           | ✔️           |               |
| 数据元标准                              | 对系统中需统一遵循的标准进行管理（新建/编辑/导入/导出/发布/下线/删除） | ✔️             | ✔️             |             |             | ✔️             |
|                                         | 对系统中使用的数据标准进行查看                               |               |               | ✔️           | ✔️           |               |
| 标准文档管理                            | 对系统中标准的来源文档进行管理（新建/删除/查询/编辑）        | ✔️             | ✔️             |             |             | ✔️             |
|                                         | 对标准文档进行查看                                           |               |               | ✔️           | ✔️           |               |
| 数据元属性管理                          | 对数据元标准所需遵循的标准属性进行自定义                     | ✔️             | ✔️             |             |             | ✔             |

### 标准定义

#### 标准词根

**功能说明**

标准词根管理主要用于管理词根术语规范，规范数据仓库高频词及业务词根写法，提高数据模型命名的规范性、可读性。

**操作步骤**

界面整体分为左右结构，左侧为词根分类树，用户可对分类进行管理维护。

右侧为词根标准维护主体内容，包括词根的搜索，词根的操作，词根列表维护。

点击【数据标准】-【标准词根】-【新建词根分类】后，弹出新建词根分类弹窗。

点击【数据标准】-【标准词根】-【新建】后，弹出新建-标准词根弹窗。       

**新建标准表单中各属性填写要求**：

- 词根编码：文本输入框，必填。
- 中文名称：文本输入，中文名称不允许特殊字符输入，必填。
- 词根分类：单选，下拉级联选择框，枚举值通过词根分类进行分类树获取，必填项。
- 英文名称：文本输入，仅允许英文字母输入，必填项。
- 英文缩写：文本输入，仅允许英文字母输入，必填项。
- 近义词：文本输入，必填项。
- 词根描述：文本域，必填项。

平台支持通过excel表格进行词根标准进行批量导入，导入过程中支持用户进行数据预览。

导入数据需按照新建标准词根要求进行导入。

批量发布/批量下线，点击【批量发布】，弹窗标准发布。

填写发布原因，点击【发布】后，超级管理员可在流程中心进行审批，审批通过后标准发布上线。

点击【批量下线】，弹窗标准下线。

填写发布原因，点击【下线】后，超级管理员可在流程中心进行审批，审批通过后标准下线。

#### 业务术语

**功能说明**

业务术语管理主要用于业务术语规范，规范数据仓库高频词写法，提高数据模型命名的规范性、可读性。

**操作步骤**

界面整体分为左右结构，左侧为业务术语分类树，用户可对分类进行管理维护。

右侧为业务标准维护主体内容，包括业务信息的搜索，术语的操作，术语列表维护。

点击【数据标准】-【业务术语】-【新建分类】后，弹出新建词根分类弹窗。

点击【数据标准】-【业务术语】-【新建】后，弹出新建-业务术语弹窗。

**新建标准表单中各属性填写要求**：

- 业务编码：文本输入框，必填。
- 中文名称：文本输入，中文名称不允许特殊字符输入，必填。
- 业务分类：单选，下拉级联选择框，枚举值通过词根分类进行分类树获取，必填项。
- 英文名称：文本输入，仅允许英文字母输入，必填项。
- 英文缩写：文本输入，仅允许英文字母输入，必填项。
- 业务描述：文本域，必填项。

平台支持通过excel表格进行业务术语进行批量导入，导入过程中支持用户进行数据预览。

导入数据需按照新建业务术语要求进行导入。

#### 标准码值

**功能说明**

标准码值管理主要用于码值规范，规范数据仓库字段码值写法，提高数据模型规范性、可读性。

**操作步骤**

界面整体分为左右结构，左侧为标准码值分类树，用户可对分类进行管理维护。

右侧为标准码值维护主体内容，包括码值的搜索，码值的操作，码值列表维护。

点击【数据标准】-【标准码值】-【新建分类】后，弹出标准码值分类弹窗。

点击【数据标准】-【标准码值】-【新建】后，弹出新建-标准码值弹窗。

新建标准表单中各属性填写要求：

- 标准编码：文本输入框，必填。
- 标准名称：文本输入，中文名称不允许特殊字符输入，必填。
- 标准分类：单选，下拉级联选择框，枚举值通过词根分类进行分类树获取，必填项。

标准码值

- 码值：文本输入，必填项。
- 码值名称：文本输入，必填项。
- 码值说明：文本输入，必填项。

平台支持通过excel表格进行标准码值进行批量导入，导入过程中支持用户进行数据预览。

导入数据需按照新建标准码值要求进行导入。

批量发布/批量下线，点击【批量发布】，弹窗标准发布。

填写发布原因，点击【发布】后，资产管理员可在流程中心进行审批，审批通过后标准发布上线。

点击【批量下线】，弹窗标准下线。

填写发布原因，点击【下线】后，资产管理员可在流程中心进行审批，审批通过后标准下线。

#### 数据元标准

**功能说明**

数据元标准对数据元进行统一标准化管理维护，帮助用户进行数据元标准沉淀，指导用户进行字段创建。

**操作步骤**

界面整体分为左右结构，左侧为标准码值分类树，用户可对分类进行管理维护。

右侧为数据元标准维护主体内容，包括数据元的搜索，数据元的操作，数据元列表维护。

点击【数据标准】-【数据元标准】-【新建分类】后，弹出数据元标准分类弹窗。

点击【数据标准】-【数据元标准】-【新建】后，弹出新建-数据元标准弹窗。

**新建标准表单中各属性填写要求：**

- 数据元编码：文本输入框，必填。
- 中文名称：文本输入，中文名称不允许特殊字符输入，必填。
- 数据元分类：单选，下拉级联选择框，枚举值通过词根分类进行分类树获取，必填项。
- 英文名称：文本输入，仅允许英文字母输入，必填项。
- 英文简称：文本输入，仅允许英文字母输入，必填项。
- 近义词：文本输入，必填项。
- 标准描述：文本域，必填项。
- 保存：按钮，点击保存后，对必填项进行校验。
- 提交发布：按钮，点击提交发布，对必填项进行校验。
- 取消：按钮，点击取消，关闭表单。

平台支持通过excel表格进行数据元标准批量导入，导入过程中支持用户进行数据预览。

导入数据需按照新建数据元标准要求进行导入。

批量发布/批量下线，点击【批量发布】，弹窗数据元标准发布。

填写发布原因，点击【发布】后，超级管理员可在流程中心进行审批，审批通过后标准发布上线。   

点击【批量下线】，弹窗数据元标准下线。

填写发布原因，点击【下线】后，超级管理员可在流程中心进行审批，审批通过后标准下线。

#### 标准文档管理

**功能说明**

标准文档管理主要用于标准规范沉淀的文档管理，方便相关文档的查阅和存根。

**操作步骤**

界面整体分为左右结构，左侧为文档分类树，用户可对分类进行管理维护。

右侧为文档标准维护主体内容，包括文档名称的搜索，文档的操作，文档列表维护。   

点击【数据标准】-【业务术语】-【新建分类】后，弹出新文档分类弹窗。

点击【数据标准】-【标准文档】-【新建】后，弹出新建-标准文档弹窗。     

**新建标准表单中各属性填写要求**：

- 文档名称：文本输入，中文名称不允许特殊字符输入，必填。
- 文档分类：单选，下拉级联选择框，枚举值通过词根分类进行分类树获取，必填项。
- 文档描述：文本域，必填项。
- 文档上传：仅支持PDF上传。

### 系统管理

#### 数据元属性管理

**功能说明**

数据元属性管理作为数据元标准的后台管理功能，支持用户通过属性管理自定义扩展数据元。当用在数据元属性管理中新增数据元属性后数据元标准中新增数据元标准表单同步更新。

**操作步骤**

界面整体分为左右结构，左侧为标准码值分类树，用户可对分类进行管理维护。

右侧为标准码值维护主体内容，包括属性的操作，属性列表维护。

点击【数据标准】-【系统管理】-【数据元属性管理】-【新建分类】后，弹出分类弹窗。

点击【数据标准】-【系统管理】-【数据元属性管理】-【新建】后，弹出新建-数据元属性弹窗。

**新建标准表单中各属性填写要求**：

- 属性编码：文本输入框，必填。
- 属性名称：文本输入，必填。
- 属性类型：单选，下拉级联选择框，枚举值通过词根分类进行分类树获取，必填项。
- 是否允许为空：单选，枚举值为是、否，必填项。
- 字段长度：文本输入，字符为正整数校验，若为否，则进行校验结果提示，必填项。
- 字段类型：单选，枚举值为文本、整数、布尔，必填项。
- 交互形式：单选，枚举值为文本框、下拉框，若选择文本框，则需要填写提示信息；若选择下拉框，则需要进行下拉选择方式和枚举信息填写。必填项。
- 下拉选择方式：单选，枚举值为单选、多选，选填项。
- 枚举信息：文本框，枚举值间需进行英文,分割,选填项。
- 确定：按钮，点击确定，进行表单保存。
- 取消：按钮，点击取消，进行表单操作关闭。平台支持通过excel表格进行标准码值

## 数据质量

### 产品概述

数据质量是一个可视化的数据稽核模块，允许用户自行定义稽核，建立监控任务，查看任务的执行状态，以解决业务系统运行、数据仓库建设及治理过程中的质量问题。目前，数据稽核包括单张表的表级、字段级稽核，以及同个集群下的2张表表级和字段级的稽核。

同时系统支持可视化等简易操作手段，将质量检核、质量监控、质量整改与质量报告等工作环节进行流程整合，形成完整的数据质量管理闭环。

![img](file:///Users/wangyuxian10/All/helpdoc/di-help-documentation/docs/mdfiles/bdp/img/dq/1.png?lastModify=1678847827)



### 术语定义

| **序号** | **术语** | **全称和说明**                                               |
| -------- | -------- | ------------------------------------------------------------ |
| 1        | 有效性   | 有效性，描述数据遵循预定的语法规则的程度，是否符合其定义，比如数据的类型、格式、取值范围等 |
| 2        | 波动性   | 波动性描述的是一段时间内的相对波动幅度                       |
| 3        | 唯一性   | 数据表中数据重复情况                                         |
| 4        | 完整性   | 完整性是指数据信息是否存在缺失的情况                         |



### 功能列表

| 功能菜单 | **子功能需求** | **说明**                       |
| -------- | :------------- | ------------------------------ |
| 质量报告 | 全局概览       | 全局角度展示数据质量情况       |
|          | 个人概览       | 个人角度展示数据质量情况       |
| 数据质量 | 监控任务       | 所有质量任务的展示与管理       |
|          | 问题管理       | 展示和管理质量任务稽核到的问题 |
|          | 规则模板配置   | 创建和管理质量规则模板         |



### 权限列表

| 功能点       | BDP平台管理员 | BDP开发人员              | BDP资产管理员 | BDP运维人员              |
| ------------ | ------------- | ------------------------ | ------------- | ------------------------ |
| 监控任务创建 | ✔️             | ✔️                        | ✔️             | ✔️                        |
| 监控任务修改 | ✔️             | 只对自己负责的任务有权限 | ✔️             | 只对自己负责的任务有权限 |
| 监控任务查看 | ✔️             | ✔️                        | ✔️             | ✔️                        |
| 问题管理     | ✔️             | ✔️                        | ✔️             | ✔️                        |
| 规则模板管理 | ✔️             | ✔️                        | ✔️             | ✔️                        |

### 质量报告

通过可视化图标形式进行质量情况统计。

#### 全局概览

支持用户通过时间选择以及层级进行报告数据的展示。

支持用户下载质量报告。

#### 个人概览

支持用户通过时间选择以及层级进行报告数据的展示。

支持用户下载质量报告。

### 监控任务

#### 功能说明

在监控任务管理中，您可以查看您所有的监控任务及其状态，同时可以根据需要新增新的监控任务。

#### 操作步骤

监控任务页面分为三部分，包括左侧二级菜单可进行监控任务/问题管理/规则模板配置功能切换，上方支持监控任务多条件检索，主体部分支持监控任务列表展现。

用户可以选择或输入，搜索选择想找的监控任务，查看其相关信息。

任务查看

点击任务右侧的【查看】按钮，展示监控任务的详细信息

任务编辑

点击任务右侧的【编辑】按钮，进行监控任务的编辑

任务新增

点击任务左侧的【新增】按钮，展示监控任务的详细信息

选择自定义之后，需要手动填写自定义表达式：

自定义表达式规则：

**1.** **计划执⾏时间 '{CURRENT_EXE_TIME}'**

获取计划执⾏时间，格式 yyyy-MM-dd HH:mm

**2.** **当前执⾏⼩时 '{CURRENT_HOUR}'**

获取当前执⾏时间中的⼩时数，格式 HH

**3.** **当前执⾏分钟 '{CURRENT_MINUTE}'**

获取当前执⾏时间中的分钟数，格式 mm

**4.** **时间偏移函数'{CURRENT_EXE_TIME,}'**

operator: 操作符，可选 + 或 -

offset: 偏移量，仅⽀持数字

unit: 单位，可选y年M⽉d⽇H时m分

format: 格式，可选yyyy-MM-dd HH:mm、yyyy-MM-dd、yyyyMMdd、yyyy、MM、dd、HH:mm、HH-mm、HHmm、HH、mm

 

【例如】

计划执行时间：CURRENT_EXEC_TIME=2022-09-30 10:32

{CURRENT_EXEC_TIME-12H, yyyy-MM-dd HH:mm} = 2022-09-29 22:32

{CURRENT_EXEC_TIME-12H, yyyy-MM-dd} = 2022-09-29

{CURRENT_EXEC_TIME-12H, HH:mm} = 22:32

{CURRENT_EXEC_TIME-12m,mm} = 20

{CURRENT_EXEC_TIME-7d, yyyy-MM-dd } = 2022-09-23



稽核项、稽核内容、稽核分类和稽核指标不可编辑，如需编辑可以新建一条新的DQI规则。

输入内容之后，点击【添加DQI规则】按钮，系统提示添加成功。

基于质量任务的调度运行，进行任务运行情况以及数据质量情况进行监控预警。

### 问题管理

#### 功能说明

问题管理针对问题数据任务进行统一管理，支持问题任务的原因查看以及问题处理操作，系统可通过问题处理进行任务处理状态跟踪，有效管控质量处理流程闭环。

#### 操作步骤

问题管理界面中，支持问题任务基本信息查看以及处理状态的查看，同时支持问题原因查看、问题过程查看以及问题处理操作。

页面通过切页进行问题任务的分类，目前平台支持全部问题查看、待我处理、我的跟踪以及分配给我四个切页进行问题任务筛选，同时支持在相应切页下的多条件筛选。

点击【高级搜索】用户可输入查询条件执行查询筛选

点击【待我处理】，展示需要登录用户处理的任务

点击【我的跟踪】，展示用户将问题指派给其他人需要用户跟踪的问题，可以查看问题的原因和过程

点击【分配给我】，展示别人分配给我的问题，也可以查看原因、问题处理、过程查看。

原因查看

点击问题右侧的【查看原因】，弹出查看原因对话框。

过程查看

点击问题右侧的【过程查看】，弹出过程查看对话框。

问题处理

点击【待我处理】，然后点击问题右侧的【问题处理】，弹出问题处理对话框。

填写内容之后，选择处理动作。

点击【确定】按钮，系统提示问题处理成功

导出

条件筛选出需要导出的任务，点击【导出】，选择存储地址，即可导出Excel表格。

### 规则模板配置

#### 功能说明

规则模板可帮助用户将自定义创建SQL的检查规则沉淀成模板，方便通业务检查质量规则的复用。

#### 操作步骤

规则模板管理界面，支持关键字搜索规则模板，同时主页面支持规则模板基本信息的查看以及规则模板的操作。

在搜索框里输入模板名称，显示查询模板。

**规则模板新增**

点击【新增】按钮，弹出新增规则模板对话框。

根据需求完善信息，点击【下一步】，定义参数名称。

点击【确定】，系统提示添加成功。

**规则模板修改**

点击模板右侧的【修改】按钮，弹出编辑规则模板对话框。

点击【确认】按钮，提示修改成功成功。

**规则模板删除**

点击模板右侧的【删除】按钮，弹出确认删除提示框。

点击【确认】按钮，提示任务删除成功，列表刷新无已删除模板。

### 附录

•    稽核校验规则说明：

| 稽核类型 | 稽核项     | 稽核内容         | 稽核分类   | 规则指标                          | 操作                                                         | SQL                                                          |
| -------- | ---------- | ---------------- | ---------- | --------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 单表     | 表级别     | **记录行数**     | **波动性** | DQI1006一致波动性-波动性校验      | 启用同比：   1.   同日比  2.   近七日  3.   近15日  4.   近30日同比  5.   周同比  6.   近3周同比  7.   近七周同比  8.   月同比  9.   近3月同比  10.  近6月同比     对比关系：  1.   大于  2.   小于  3.   等于  4.   大于或等于  5.   小于或等于  6.   介于 | 1.   总数sql：  SELECT   count(1) resultVal from ${dbName}.${tableName} where dt = '2019-10-29'   2.   稽核sql：  select   (table1.col1*100/table2.col2) resVal   from ( select count(1) col1   from ${dbName}.${tableName}  where dt = '2019-10-29' ) table1 join   (select count(1)/7 col2   from   ${dbName}.${tableName} where dt  <= '2019-10-28' and dt > '2019-10-21') table2; |
| 单表     | 表级别     | **记录行数**     | 有效性     | DQI1007有效性-有效性取值范围      | 取值：  大于、小于、等于、大于或等于、小于或等于     介于：  （最小值）–（最大值） | 1.   总数sql：SELECT count(1) resultVal from ${dbName}.${tableName} where dt =  '2019-10-29'     2.   稽核sql：SELECT  tb.resultVal FROM ( SELECT count(1)  resultVal from ${dbName}.${tableName} where dt =  '2019-10-29' ) as tb where tb.resultVal   <= 10 |
| 单表     | 字段级别   | 选择具体稽核字段 | 有效性     | DQI1003有效性-格式有效性     总数 | 约束规则：   1.   整数  2.   浮点  3.   数值  4.   英文大写  5.   英文小写  6.   日期（YYYY-MM-DD）  7.   自定义（自定义规则中支持Hive正则表达式）  过滤条件：用户自定义  注：监控字段数据不满足规定格式，发出预警 | 1.   总数sql：SELECT count(1) resultVal from   ${dbName}.${tableName} where dt = '2019-10-29'    2.   稽核sql：SELECT count(1) resultVal from   ${dbName}.${tableName} where dt = '2019-10-29' and   (name not rlike  '^-?[1-9]\\\\\\\\d*[Ee]?' );  3.   样例sql：SELECT  name from ${dbName}.${tableName} where  dt = '2019-10-29' and (name   not rlike '^-?[1-9]\\\\\\\\d*[Ee]?' )   limit 100 ; |
| 单表     | 字段级别   | 选择具体稽核字段 | 有效性     | DQI1004有效性-有效取值范围        | 1.   取值：大于、小于、等于、大于或等于、小于或等于  2.   介于：（最小值）--（最大值）  3.   包含：-- | 1.   总数sql：SELECT count(1) resultVal from   ${dbName}.${tableName} where dt  = '2019-10-29'    2.   稽核sql：SELECT count(1) resultVal from   ${dbName}.${tableName} where dt  = '2019-10-29' and name <= 10;  3.   样例sql：SELECT  name from ${dbName}.${tableName} where  dt = '2019-10-29' and name <= 10  limit 100; |
| 单表     | 字段级别   | 选择具体稽核字段 | 波动性     | DQI1001-一致性波动-波动性校验     | 启用同比：   1.   同日比  2.   近七日  3.   近15日  4.   近30日同比  5.   周同比  6.   近3周同比  7.   近七周同比  8.   月同比  9.   近3月同比  10.  近6月同比  对比值类型：   1.   平局值（avg）  2.   最大值   (max)  3.   最小值（min）  4.   求和（sum）  5.   记录数（count）  对比关系   1.   大于  2.   小于  3.   等于  4.   大于或等于  5.   小于或等于  6.   介于 | 1.   总数sql：SELECT count(1) resultVal from   ${dbName}.${tableName} where dt = '2019-10-29'      2.   稽核sql：select (table1.col1*100/table2.col2) resVal from ( select avg(name) col1 from ${dbName}.${tableName} where dt =  '2019-10-29' ) table1 join (select  avg(name) col2 from  ${dbName}.${tableName} where dt <= '2019-10-28' and dt > '2019-10-21')  table2; |
| 单表     | 字段级别   | 选择具体稽核字段 | 唯一性     | DQI1002-唯一性_数据重复性校       | 1.   过滤条件：--                                            | 1.   总数sql：SELECT count(1) resultVal from   ${dbName}.${tableName}  where  dt = '2019-10-29'     2.   稽核sql：select  count(1) resVal from ( SELECT   name, count(1) resultVal from ${dbName}.${tableName} where dt =  '2019-10-29' group by name having  resultVal > 1 ) distResult;     3.   样例sql：SELECT name,   count(1) resultVal from ${dbName}.${tableName} where dt =  '2019-10-29' group by name having  resultVal > 1 limit 100 ; |
| 单表     | 字段级别   | 选择具体稽核字段 | 完整性     | DQI1005-完整性-控值约束           | 约束规则：   1.   非null且非空字符串  2.   非Null  3.   非空字符串 | 1.   总数sql：SELECT count(1) resultVal from ${dbName}.${tableName} where dt =  '2019-10-29'      2.   稽核sql：SELECT count(1) resultVal from   ${dbName}.${tableName} where dt = '2019-10-29' and   (name is null );     3.   样例sql：SELECT  name from ${dbName}.${tableName} where  dt = '2019-10-29' and (name   is null ) limit 100; |
| 多表     | 表级规则   |                  | 完整性     | DQI1008-完整性-数据条数稽核       |                                                              | 1.   总数sql：SELECT count(1) resultVal from   ${dbName}.${tableName} where dt = '2019-10-29'      2.   稽核sql：select  tb1.value-tb2.value as count from   (select count(1) as value from   ${dbName}.${tableName} where dt='2019-10-29') as tb1 join (select count(1) as value from ${dbName}.${tableName} where  dt='2019-10-29') as tb2; |
| 多表     | 字段级规则 |                  | 完整性     | DQI1009-完整性-数据内容稽核       |                                                              | 1.   总数sql：SELECT count(1) resultVal from   ${dbName}.${tableName} where dt = '2019-10-29'     2.   稽核sql：select  count(1) as num from ( select cart_no,mail from ${dbName}.${tableName} where  dt = '2019-10-29' ) as st full outer join ( select id,name from  ${dbName}.${tableName} where dt = '2019-10-29' ) as tt on   st.cart_no= tt.id where   nvl(st.cart_no,'null') != nvl(tt.id,'null') or   nvl(st.mail,'null') != nvl(tt.name,'null');     3.   样例sql：select  st.cart_no,st.mail,tt.id,tt.name from   ( select cart_no,mail from  dmz_app.dmz_my91_fin_new_incrs_01_i_d where dt = '2019-10-29' ) as st   full outer join   ( select id,name from  dmz_app.dmz_my91_fin_xblc_bxlcqt_tab_i_d where dt = '2019-10-29' ) as tt  on st.cart_no= tt.id   where   nvl(st.cart_no,'null') != nvl(tt.id,'null') or   nvl(st.mail,'null') != nvl(tt.name,'null'); |

 

## 分类分级

### 产品概述

分类分级是基于多年大数据实践经验，自主研发的数据自动、手自动分级分类的产品，帮助数据拥有者了解自己的资产，明确数据重要性和敏感度，为后续的资产保护提供依据。

### 功能列表

| 功能菜单     | 功能点            | 功能说明                                                     |
| ------------ | ----------------- | ------------------------------------------------------------ |
| 分类分级概览 | 概览              | 展示分类分级的进展，并对分类结果进行统计                     |
| 分类分级配置 | 手动分类分级      | 通过从树状结构中选择字段的方式为数据进行分类分级打标。       |
|              | 自动分类分级-规则 | 为自动分类分级功能提供数据筛选与打标配置的功能，提供了规则的创建、启用/禁用、编辑与查看操作。 |
|              | 自动分类分级-任务 | 任务管理为自动分类分级功能确定了数据筛选范围和任务的执行周期，页面提供了任务的创建、启用/禁用、编辑与查看操作。 |
|              | 类别与级别配置    | 提供分类和分级标签，在手动分类分级、自动分类分级时进行使用。页面提供修改分类与分级的功能。 |
| 分类分级确认 | 分类分级审核      | 业务方在该页面对分类分级进行审核确认后，更新数据库数据分类分级标签。提供审批、查看日志操作 |
|              | 审核结果查询      | 查看分类分级审核的结果。提供查看日志操作                     |
| 分类分级结果 | 分类分级结果      | 查看已分类分级的字段结果，提供查看日志操作。                 |

### 权限列表

| 功能菜单     | 功能点            | BDP系统管理员 | BDP资产管理员 | BDP开发人员 | BDP运维人员 |
| ------------ | ----------------- | ------------- | ------------- | ----------- | ----------- |
| 分类分级概览 | 概览              | ✔️             | ✔️             |             |             |
| 分类分级配置 | 手动分类分级      | ✔️             | ✔️             |             |             |
|              | 自动分类分级-规则 | ✔️             | ✔️             |             |             |
|              | 自动分类分级-任务 | ✔️             | ✔️             |             |             |
|              | 类别与级别配置    | ✔️             | ✔️             |             |             |
| 分类分级确认 | 分类分级审核      | ✔️             | ✔️             |             |             |
|              | 审核结果查询      | ✔️             | ✔️             |             |             |
| 分类分级结果 | 分类分级结果      | ✔️             | ✔️             |             |             |
| 系统审计     | 系统审计          | ✔️             | ✔️             |             |             |


### 流程说明



![](../../All/helpdoc/di-help-documentation/docs/mdfiles/bdp/img/classify/1.png)



### 用户指南

#### 分类分级概览

针对已知数据库，展示分类分级的整体工作进展以及敏感程度。

#### 分类分级配置

##### 手动分类分级

用户在手动分类分级页面提供的树状结构中选择数据字段，并对字段进行分类分级打标。

1. 点击手动分类分级页面。

2. 点击左侧的树状结构，选择表层数据，页面将展示字段层的详细信息。

3. 勾选一个或多个字段，点击“分类分级”按钮。

4. 系统将弹窗展示分类分级打标页面，用户勾选一个分类点击“确认”就可实现数据的分类操作，分类对应的级别将显示在分类框外。


##### 自动分类分级

自动分类分级模块通过筛选字段特征信息的方式实现对数据的批量自动分类分级操作，该模块分为两部分，分别为规则管理和任务管理。规则管理为自动分类分级模块提供数据筛选与打标配置的功能；任务管理为自动分类分级功能确定了数据筛选范围和任务的执行周期。

**规则管理**

**1、规则创建**

1. 点击自动分类分级-规则管理模块进入规则管理页面。

2. 点击蓝色“创建规则”按钮，跳转至创建规则页面。

3. 用户填写基础信息

4. 点击“增加”按钮弹窗展示条件添加页面

5. 用户填写匹配条件，点击确认。

6. 点击确认完成规则创建。


字段验证要求

| 序号 | 名称     | 是否必填 | 输入类型 | 备注                       |
| ---- | -------- | -------- | -------- | -------------------------- |
| 1    | 规则名称 | 是       | 输入     | 验重                       |
| 2    | 分类     | 是       | 选择     | 下拉列表，基于模版         |
| 3    | 规则描述 | 是       | 输入     |                            |
| 4    | 匹配类型 | 是       | 选择     | 由“增加”按钮触发，下拉列表 |
| 5    | 匹配方式 | 是       | 选择     | 由“增加”按钮触发，下拉列表 |
| 6    | 匹配内容 | 是       | 输入     | 由“增加”按钮触发，手动填入 |
| 7    | 规则关系 | 是       | 选择     | 下拉列表，二选一           |

 

**2、**  **规则启用/禁用**

点击自动分类分级-规则管理模块进入规则管理页面。

点击“启用”、“禁用”按钮实现对规则的启用禁用，规则启用后才可被后续的任务模块使用。 

**3、**  **查看**

点击自动分类分级-规则管理模块进入规则管理页面。

点击“查看”按钮，页面将跳转至查看规则页面。 

**4、**  **编辑**

点击自动分类分级-规则管理模块进入规则管理页面。

点击“编辑”按钮，页面跳转至编辑页面，用户可修改信息。

点击“保存规则”完成规则修改。 

**任务管理**

**1、**  **任务创建**

点击自动分类分级-任务管理模块进入任务管理页面。

点击蓝色“创建任务”，进入创建任务页面。

填写基础信息、数据范围、调度方式信息。

填写cron表达式时如不会填写，点击“生成器输入”页面弹窗cron表达式

用户点击在cron表达式配置页配置周期。 

点击确认完成cron表达式配置，结果将自动同步至创建任务页面。

点击确认完成任务创建。

字段验证要求

| 序号 | 名称       | 是否必填 | 输入类型  | 备注                                               |
| ---- | ---------- | -------- | --------- | -------------------------------------------------- |
| 1    | 任务名称   | 是       | 输入      | 验重                                               |
| 2    | 规则名称   | 是       | 选择      | 下拉列表，基于规则管理                             |
| 3    | 任务描述   | 是       | 输入      |                                                    |
| 4    | 范围分类   | 是       | 选择      | 下拉列表，基于数据目录                             |
| 5    | Cron表达式 | 是       | 可填/选择 | 可手动填写，也可点击右侧生成器，自动生成正则表达式 |
| 6    | 运行次数   | 是       | 输入      | 总执行次数                                         |

**2、**  **任务启用禁用**

点击自动分类分级-任务管理模块进入任务管理页面。

勾选任务，点击“启动”、“禁用”按钮，实现对任务状态管理，任务启动后，任务会根据周期进行执行。

**3、**  **任务编辑**

点击自动分类分级-任务管理模块进入任务管理页面。

点击“编辑”按钮，页面跳转至编辑任务页面。

用户修改完信息后，点击“保存任务”即可实现对任务的修改。


**4、**  **任务查看**

点击自动分类分级-任务管理模块进入任务管理页面。

点击“查看”按钮，页面跳转至查看任务页面。 

#### 类别与级别设置

输出分类分级模版，建立分类与分级之间的对应关系。给手动分类分级和自动分类分级提供标签。

注：系统内置分类分级模版，模版内容无法修改与删除，只可在原有模版上添加。

##### 功能介绍

一、数据安全级别配置

**1、**  **级别查看**

点击分类分级配置-类别与级别设置-数据安全级别配置，进入数据安全级别查看页。

二、数据安全类别配置

**1、**  **创建分类**

点击分类分级配置-类别与级别设置-数据安全类别配置，进入数据安全类别配置页。

点击“添加”按钮，弹窗展示添加子节点页面。

填写完成后，点击“确认”即可完成分类创建。

| 序号 | 名称     | 是否必填 | 输入类型 | 备注               |
| ---- | -------- | -------- | -------- | ------------------ |
| 1    | 分类名称 | 是       | 输入     | 验重               |
| 2    | 级别     | 是       | 选择     | 下拉，基于分级模版 |

**2、**  **编辑分类**

点击分类分级配置-类别与级别设置-数据安全类别配置，进入数据安全类别配置页。

点击“编辑”按钮，弹窗展示编辑页面。

修改完成后点击确认，完成分类编辑。

**3、** **删除分类**

1. 点击分类分级配置-类别与级别设置-数据安全类别配置，进入数据安全类别配置页。

2. 点击“删除”按钮，分类将被删除。（被使用的分类无法删除）




#### 分类分级确认

##### 分类分级审核

业务负责人对手动或自动分类分级打标的结果进行审核，审核通过后分类分级将打标完成（如果存在分类分级结果，则覆盖之前的结果。）

**1、**  **审批操作**

点击分类分级确认-分类分级审核按钮，进入分类分级审核页面。

勾选字段后，点击“批量通过”或“批量不通过”按钮对字段进行打标操作。 

##### 审核结果查询

查看分类分级审核的结果，包括通过与不通过的审核结果都会进行展示，用户可通过筛选框进行筛选。

**1、**  **审批结果查询**

点击分类分级确认-分类分级结果查询按钮，进入审核结果查询页面。

通过基础信息搜索和分类分级信息搜索筛选条件对分类分级审核结果进行查询。

筛选条件如下：

| 序号 | 名称         | 分类             | 输入类型 | 备注                  |
| ---- | ------------ | ---------------- | -------- | --------------------- |
| 1    | 部门名称     | 基础信息搜索     | 输入     |                       |
| 2    | 库名         | 基础信息搜索     | 输入     |                       |
| 3    | Owner        | 基础信息搜索     | 输入     |                       |
| 4    | 表名         | 基础信息搜索     | 输入     |                       |
| 5    | 字段         | 基础信息搜索     | 输入     |                       |
| 6    | 分类方式     | 分类分级信息搜索 | 选择     | 下拉，手动/自动二选一 |
| 7    | 数据安全类别 | 分类分级信息搜索 | 选择     | 下拉，基于分类模版    |
| 8    | 数据安全级别 | 分类分级信息搜索 | 选择     | 下拉，基于分级模版    |
| 9    | 提交人       | 分类分级信息搜索 | 输入     |                       |
| 10   | 审核人       | 分类分级信息搜索 | 输入     |                       |
| 11   | 审核时间     | 分类分级信息搜索 | 选择     | 3天/5天/1周           |

 

#### 分类分级结果

1. 业务方审核确认后将更新数据库数据分类分级标签，更新结果可在此页面进行查看。

2. 点击分类分级结果按钮，进入分类分级结果页面。

3. 用户通过点击左侧的目录树结果或快捷搜索框寻找表或字段。



## 数据脱敏

### 产品概述

企业数字化发展对数据脱敏技术的动态适配性、资源效用等提出更高的要求。产品具备高灵活性、高易用性、高管理融合性的脱敏产品。

业务系统的数据需求千变万化，脱敏系统能提供高灵活性的自定义脱敏配置，确保全部业务数据都能够正常处理敏感信息，用户可根据需求对敏感数据进行不同的脱敏处理。在丰富脱敏算法和多样脱敏策略的背景下，用户可对已分类分级的敏感数据与脱敏算法进行匹配，进而可实现高度契合业务的脱敏处理。

### 应用场景

支持高度契合业务的、类型丰富的明文数据脱敏能力，遏止企业数据泄露带来的商业风险、品牌风险及监管合规风险。

### 功能列表

| 功能菜单     | 功能点       | 功能说明                                                     |
| ------------ | ------------ | ------------------------------------------------------------ |
| 数据脱敏配置 | 脱敏配置创建 | 创建数据脱敏配置，选择数据分类，配置该类别下数据的脱敏算法（脱敏方式、脱敏参数等）。 |
|              | 脱敏配置管理 | 对已创建脱敏配置进行管理，操作（编辑、删除）等。             |
| 脱敏算法     | 脱敏算法创建 | 创建脱敏算法名称，选择名称对应的脱敏方式；对创建的脱敏算法进行测试。 |
|              | 脱敏算法管理 | 对已创建脱敏算法进行管理，操作（编辑、删除）等。             |

### 权限列表

| 功能点       | BDP系统管理员 | BDP资产管理员 | BDP开发人员 | BDP运维人员 |
| ------------ | ------------- | ------------- | ----------- | ----------- |
| 数据脱敏配置 | ✔️             | ✔️             |             |             |
| 脱敏算法     | ✔️             | ✔️             |             |             |

### 流程说明



<img src="../../All/helpdoc/di-help-documentation/docs/mdfiles/bdp/img/dm/1.png" style="zoom:50%;" />

数据资产管理员在脱敏系统内创建脱敏算法，并传递给SDK执行。研发人员直接使用调用代码添加脱敏服务。

### 用户指南

#### 数据脱敏配置


- 点击系统左侧数据脱敏栏目，进入数据脱敏配置页面。

**数据脱敏配置查询**

- 输入关键字或选择数据分类或输入算法名称，点击“查询”按钮，查阅脱敏配置列表。

场景1：选择数据分类查询

场景2：选择数据分类并填写算法名称精准查询

场景3：关键词模糊查询

- 脱敏配置列表字段：数据分类、脱敏算法、脱敏方式、脱敏方案、脱敏参数、配置来源、创建人、更新时间（支持排序，默认倒序展示）、操作（编辑、删除）。

**数据脱敏配置添加** 

1. 点击系统左侧数据脱敏栏目，进入数据脱敏配置页面。
2. 点击右上角“添加配置”按钮弹出脱敏配置创建页，“*“标为必填内容。
3. 点击确定或取消，返回到数据脱敏配置列表。确定添加后新配置显示在列表首行。
4. 点击编辑，会弹出提示。
5. 点击确定弹出数据脱敏配置编辑页。
6. 点击确定或取消，返回到数据脱敏配置列表。确定编辑后显示保存成功提示。点击删除，弹出提示
7. 点击确定或取消跳转至数据脱敏配置列表，确定删除后有显示删除成功提示。

**数据脱敏算法创建**

点击系统左侧安全中心-数据脱敏栏目，进入脱敏算法页面。

#### 脱敏算法

输入脱敏算法名称或选择数据分类或选择算法来源，点击“查询”按钮，查阅脱敏配置列表。该查询功能支持多条件精准查询及关键字模糊查询。

算法来源分为系统预置和自定义两种情况。

1. 点击右上角“添加算法”按钮弹出脱敏算法创建页。“*“标为必填内容。
2. 已有算法名称不能重复添加，重复情况弹出“自定义脱敏算法名称重复”提示。
3. 脱敏算法创建环节可对自定义的脱敏算法进行效果测试。
4. 点击确定或取消，返回脱敏算法列表。确定添加后提示“保存成功”，新配置显示在列表首行。
5. 点击脱敏算法列表右侧“测试”功能键，弹出算法测试页面，可对当前脱敏算法效果进行验证。点击页面“关闭“功能键返回脱敏算法列表。
6. 点击脱敏算法列表右侧“编辑”功能键，弹出算法编辑页面，可对当前脱敏算法配置进行编辑。点击页面“确定“或”取消“功能键返回脱敏算法列表。

 ## 水印管理

### 产品概述

水印管理是具有高警戒性、高易用性、高管理融合性的水印产品，该产品提供Web水印和文本水印两类水印。通过将标识信息嵌入水印中的方式对网页、图片、字体进行保护，并在数据泄漏后进行溯源。

### 应用场景

**版权声明**

Web端网页提供明文水印对版权进行声明，对不法分子起到震慑作用。

**数据泄漏溯源**

基于图片内明、暗水印和文本水印快速进行定位和溯源。

### 术语定义

| **序号** | **术语** | **全称和说明**                                               |
| -------- | -------- | ------------------------------------------------------------ |
| 1        | Web水印  | 一种在Web页面最上层浮现的水印，可有效应对截图拍照等数据泄漏方式。 |
| 2        | 文本水印 | 一种将标识信息潜入文本内容中的水印，在数据泄漏后，可实现数据溯源。 |
| 3        | 明水印   | 一种水印的常见展示方式，将标识信息显性的展示在载体中，使用户可肉眼查看标识信息。 |
| 4        | 暗水印   | 一种水印的常见展现方式，将标识信息隐藏在展示的载体中，肉眼无法识别，需要进行处理提取信息。 |

### 功能列表

| 功能菜单 | 功能点   | 功能说明                                                     |
| -------- | -------- | ------------------------------------------------------------ |
| 水印管理 | 水印注册 | 注册水印服务，选择水印类型，配置水印的格式（包括展示文案、水印字号、字体、密度、透明度等）。 |
|          | 水印管理 | 对已注册的水印进行管理，包括使用监控，开关控制、修改、查看代码和错误日志等。 |

### 权限列表

| 功能点   | BDP系统管理员 | BDP资产管理员 | BDP开发人员 | BDP运维人员 |
| -------- | ------------- | ------------- | ----------- | ----------- |
| 水印注册 | ✔️             | ✔️             |             |             |
| 水印管理 | ✔️             | ✔️             |             |             |



### 流程说明

![](/Users/wangyuxian10/All/helpdoc/di-help-documentation/docs/mdfiles/bdp/img/wm/1.png)

BDP资产管理员在水印系统内注册水印应用，并生成调用token或JS代码。研发人员直接使用调用代码在Web页面或文本中添加水印服务。

### 用户指南

水印管理页面用于管理已注册的水印应用，并为注册水印提供入口。用户可以在页面查看水印的基础信息、错误日志以及接入代码；同时提供水印开关、注册水印、修改水印等功能供用户使用。

**1、**  **水印应用检索**

- 点击水印管理菜单进入水印管理页面。
- 搜索框输入搜索内容即可显示相关项目。

**2、**  **注册新应用**

- 点击水印管理菜单进入水印管理页面。
- 点击“注册新应用”按钮弹窗水印注册页面。

- 输入应用名和应用编码。
- 选择水印类型，如果勾选网页水印，则需要再选择网页水印类型。
- （只适用于网页水印）根据网页水印的类型用户需要配置不同的水印的参数。

![](/Users/wangyuxian10/All/helpdoc/di-help-documentation/docs/mdfiles/bdp/img/wm/4.png)![](/Users/wangyuxian10/All/helpdoc/di-help-documentation/docs/mdfiles/bdp/img/wm/5.png)

- 配置完水印后，用户可以点击预览功能，查看水印效果。
- 效果满意，用户点击“提交”按钮，即可完成水印注册。 

**3、**  **水印开启/关闭**

点击左侧水印管理模块，进入水印管理页面。

选择应用水印后，点击页面右上方“开启”/“关闭”按钮，即可控制水印的开关。 

**4、**  **修改水印**

- 点击左侧水印管理模块，进入水印管理页面。
- 点击水印右侧的编辑按钮即可进入水印编辑页面。

- 水印编辑页面内容与水印注册页面一致，此处不做赘述。

**5、**  **查看接入代码**

- 点击左侧水印管理模块，进入水印管理页面。
- 点击接入代码按钮，可弹窗查看接入水印的代码，同时提供代码复制功能。 

**6、**  **查看错误日志**

- 点击左侧水印管理模块，进入水印管理页面。
- 点击“错误日志”按钮，可弹窗查看错误日志信息，展示信息包括：水印类型、错误详情、发生时间。

  

# FAQ

### 数据集成

**1.离线同步支持的数据库类型都有哪些？**

离线支持目前支持三种场景，数据入仓、数据出仓、数据同步。

•   数据入仓支持：MySQL、MongoDB、Oracle、SQL Server、HBase、SFTP、HANA、Sybase、PostgreSQL、ClickHouse、Elasticsearch

•   数据推送出仓：MySQL、MongoDB、Oracle、SQL Server、HBase、SFTP、HANA、Sybase、PostgreSQL、ClickHouse

•   数据同步支持：MySQL至MySQL (后续还会继续扩充)

**2.数据源接入时应注意哪些要点？**

首先，数据源在接入配置时，根据不同的数据源类型，配置相应的连接信息；务必保证连接信息填写正确，并连通性测试通过。故需要有几个必要条件：

1、数据源网络权限、数据库连接权限必须保证是连通性和可访问性；

2、连通测试失败可能是以下原因，确认后再次尝测连通，

防火墙权限未授权；

数据库是否正常启动；

数据库是否赋权当前用户连接访问；

3、只有连通性测试通过才可以成功提交数据源。

**3.数据入仓存储策略怎么选？**

数据入仓时，需要配置数仓中数据的存储策略；不同存储策略在数仓中的数据是不同的；存储策略分全量、增量、快照和拉链四种； 

• 全量：表中数据存储最新全部数据，当运行周期是天时，表中数据为T+1天的全量最新数据，全量表无分区； 

• 增量：当运行周期是天时，数仓表中按每天存储一个分区，存放一天产生的增量或全量数据（看抽取策略）；

• 快照：当运行周期是天时，数仓表中按每天存储一个分区，每一天数据为T+1天的全量最新数据；

• 拉链：抽取策略为增量，记录数据从开始到当前有状态变化的信息，只有一个分区，存储的是当前时间 之前的所有历史记录的最后变化量（总量）。

**4.数据入仓如何避开业务系统跑批时间？**

在数据入仓的规则配置中-高级设置中设置抽取时间段和禁止抽取时间段；

**抽取时间段**：在每个时间段都可以进行抽取，也可以自定义时间段进行抽取。如果生产库只在某一段时间可以执行数据抽取操作，请在这里设置可抽取的时间段

以免影响生产库的正常业务；

**禁止抽取时间段**：若业务系统凌晨跑批则需要自设跑批时间段，系统会自动避开该时间段对数据进行抽取；

**5.数据出仓中源表策略“数据时间范围”具体逻辑是什么？**

数据出仓-字段配置中，数据时间范围：T+1：推送前一个分区的数据；T+0：推送当前分区的数据

举例：

分区类型：天，推送分区数近3个，数据时间范围：T+1

任务运行时，当前日期2022-08-06，执行任务默认跑2022-08-05；从源表取3个分区数据dt=2022-08-05、dt=2022-08-04、dt=2022-08-03，进行推送；

分期类型：天，推送分区数近3个，数据时间范围：T+0

任务运行时，当前日期2022-08-06，执行任务默认跑2022-08-06(T+0当前分区数据）从源表取3个分区数据：dt=2022-08-06、dt=2022-08-05、dt=2022-08-04，进行推送；

**6.数据出仓至HBase时Rowkey 如何填写？** 

数据出仓当目标库为Hbase时，字段配置中会有rowKey的填写；

Hbase 库的 rowkey 定义：列簇。可以理解为“主键”或“表”的概念，唯一标识一行记录。Hbase表中每个字段都需要关联一个列簇。例如:要把e: test 列设置为唯一

标识，则在rowkey处填写[e: test] 即可；rowkey由多列拼接而成时， 按照下划线连接 如[e: test1]_[e: test2]；

rowkey填写内容需求清楚目标库的具体情况，可向目标库相关负责人咨询；

### 数据图谱

**1.如何展示入仓和出仓的链路关系？**

-    第一步，展示入仓和出仓的链路前提条件需要在元数据采集任务中进行采集任务的配置
-    第二步，需要在数据集成中对入仓、出仓进行任务配置并进行发布到运维中心
-    第三步，可到数据图谱-数据模型中查到入仓或者出仓所关联的仓内表，查看链路追溯可进行查看

**2.为什么已经配置了入仓和出仓任务且运行成功，但是在数据图谱链路追溯中无法追溯到应用系统表？**

需要确定该应用系统表是否在已经采集到应用系统中，若没有，需通过元数据采集任务进行元数据采集。

### 资源管理

**1.集群是否支持添加多个？**

系统目前支持一个集群，不支持多集群。

**2.文件目录权限策略管理中，描述有来自hive元数据，有其他的，具体什么含义？**

文件目录的权限策略，大多数是自动同步hive元数据信息的，也存在少量其他场景：1、资源管理界面自定义添加的；2、用户user1 对hdfs目录/user/user1 这种是创建分发用户keytab的时候创建的权限。

**3.队列用户和队列管理用户的含义和区别是什么？**

队列用户是指定哪些用户可以发布任务到这个队列中；队列管理用户是可以修改队列相关配置，以及添加管理子队列。

### 运维中心

**1.修改运行规则任务首次无法自动触发运行问题**

【现象描述】修改任务运行规则（任务运行规则包括运行频率、开始时间、结束时间、时间间隔），按照新的运行规则生成实例判断，如果没有上一个实例执行完成，最新生成的实例会提示前一个周期的状态不为done。

【解决方法】手动将修改运行规则后生成的第一个实例重置为成功，之后的实例会正常执行。

**2.任务状态长期处于等待中的问题**

【解决方法】

出现此问题原因如下：

- 前一周期实例不为Done

- 上游父任务对应周期实例不为Done

- 未到达调度时间

- 上/下游有任务正在运行中

- 下游子任务存在熔断

根据上述原因进行相应处理即可。

### 数据开发

**1.任务执行日志报：Permissiom denied:user=hive,access=READ_EXECUTE,inode="hbase"**

 【问题原因】没有目录权限

【解决方法】

到资源管理产品中对提示的目录进行赋权

**2.任务执行报错：ERROR:java.lang.RuntimeException：No Kerberos info "UserGroupInformation" class found for xxx**

【问题原因】Keytab没有下发成功

【解决方法】

到运营后台产品，Keytab分发管理模块进行用户Keytab下发

**3.系统提示获取文件目录树失败**

【问题原因】

用户环境没有启动K8S容器

【解决方法】

先执行python、shell脚本或者使用终端,启动容器时候才会初始化数据目录。

